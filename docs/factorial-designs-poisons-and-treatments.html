<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.3 Factorial designs: poisons and treatments | Statistical Modelling</title>
  <meta name="description" content="A conceptual, visual and practical introduction to statistical modelling" />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="2.3 Factorial designs: poisons and treatments | Statistical Modelling" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A conceptual, visual and practical introduction to statistical modelling" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.3 Factorial designs: poisons and treatments | Statistical Modelling" />
  
  <meta name="twitter:description" content="A conceptual, visual and practical introduction to statistical modelling" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="randomised-blocks-the-parable-of-the-sower.html"/>
<link rel="next" href="power.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/rglWebGL-binding-1.3.17/rglWebGL.js"></script>
<link href="libs/rglwidgetClass-1.3.17/rgl.css" rel="stylesheet" />
<script src="libs/rglwidgetClass-1.3.17/rglClass.min.js"></script>
<script src="libs/CanvasMatrix4-1.3.17/CanvasMatrix.min.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A visual and conceptual introduction to statistical modelling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface: what’s the problem?</a></li>
<li class="chapter" data-level="1" data-path="linear-models.html"><a href="linear-models.html"><i class="fa fa-check"></i><b>1</b> Linear models</a>
<ul>
<li class="chapter" data-level="1.1" data-path="simple-regression-rodents-revisited.html"><a href="simple-regression-rodents-revisited.html"><i class="fa fa-check"></i><b>1.1</b> Simple regression: rodents revisited</a></li>
<li class="chapter" data-level="1.2" data-path="linear-models-with-multiple-covariates.html"><a href="linear-models-with-multiple-covariates.html"><i class="fa fa-check"></i><b>1.2</b> Linear models with multiple covariates</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="linear-models-with-multiple-covariates.html"><a href="linear-models-with-multiple-covariates.html#model-formulation"><i class="fa fa-check"></i><b>1.2.1</b> Model formulation</a></li>
<li class="chapter" data-level="1.2.2" data-path="linear-models-with-multiple-covariates.html"><a href="linear-models-with-multiple-covariates.html#model-fitting"><i class="fa fa-check"></i><b>1.2.2</b> Model fitting</a></li>
<li class="chapter" data-level="1.2.3" data-path="linear-models-with-multiple-covariates.html"><a href="linear-models-with-multiple-covariates.html#model-checking"><i class="fa fa-check"></i><b>1.2.3</b> Model checking</a></li>
<li class="chapter" data-level="1.2.4" data-path="linear-models-with-multiple-covariates.html"><a href="linear-models-with-multiple-covariates.html#inference-on-coefficients"><i class="fa fa-check"></i><b>1.2.4</b> Inference on coefficients</a></li>
<li class="chapter" data-level="1.2.5" data-path="linear-models-with-multiple-covariates.html"><a href="linear-models-with-multiple-covariates.html#comparing-models"><i class="fa fa-check"></i><b>1.2.5</b> Comparing models</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="prediction-black-cherry-trees.html"><a href="prediction-black-cherry-trees.html"><i class="fa fa-check"></i><b>1.3</b> Prediction: Black Cherry trees</a></li>
<li class="chapter" data-level="1.4" data-path="factors-and-interactions-in-linear-models.html"><a href="factors-and-interactions-in-linear-models.html"><i class="fa fa-check"></i><b>1.4</b> Factors and interactions in linear models</a></li>
<li class="chapter" data-level="1.5" data-path="transforming-the-response-variable-giving-in-the-church-of-england.html"><a href="transforming-the-response-variable-giving-in-the-church-of-england.html"><i class="fa fa-check"></i><b>1.5</b> Transforming the response variable: Giving in the Church of England</a></li>
<li class="chapter" data-level="1.6" data-path="simple-seasonal-terms.html"><a href="simple-seasonal-terms.html"><i class="fa fa-check"></i><b>1.6</b> Simple seasonal terms</a></li>
<li class="chapter" data-level="1.7" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>1.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="exercises.html"><a href="exercises.html#rodents"><i class="fa fa-check"></i><b>1.7.1</b> Rodents</a></li>
<li class="chapter" data-level="1.7.2" data-path="exercises.html"><a href="exercises.html#giving-in-the-church-of-england"><i class="fa fa-check"></i><b>1.7.2</b> Giving in the Church of England</a></li>
<li class="chapter" data-level="1.7.3" data-path="exercises.html"><a href="exercises.html#black-cherry-trees"><i class="fa fa-check"></i><b>1.7.3</b> Black Cherry trees</a></li>
<li class="chapter" data-level="1.7.4" data-path="exercises.html"><a href="exercises.html#cats"><i class="fa fa-check"></i><b>1.7.4</b> Cats</a></li>
<li class="chapter" data-level="1.7.5" data-path="exercises.html"><a href="exercises.html#respiratory-distress-syndrome"><i class="fa fa-check"></i><b>1.7.5</b> Respiratory distress syndrome</a></li>
<li class="chapter" data-level="1.7.6" data-path="exercises.html"><a href="exercises.html#the-clyde-data"><i class="fa fa-check"></i><b>1.7.6</b> The Clyde data</a></li>
<li class="chapter" data-level="1.7.7" data-path="exercises.html"><a href="exercises.html#water-quality-in-loch-leven"><i class="fa fa-check"></i><b>1.7.7</b> Water quality in Loch Leven</a></li>
<li class="chapter" data-level="1.7.8" data-path="exercises.html"><a href="exercises.html#so_2-over-europe"><i class="fa fa-check"></i><b>1.7.8</b> SO<span class="math inline">\(_2\)</span> over Europe</a></li>
<li class="chapter" data-level="1.7.9" data-path="exercises.html"><a href="exercises.html#maximal-heart-rate-and-age"><i class="fa fa-check"></i><b>1.7.9</b> Maximal heart rate and age</a></li>
<li class="chapter" data-level="1.7.10" data-path="exercises.html"><a href="exercises.html#the-effects-of-conservation"><i class="fa fa-check"></i><b>1.7.10</b> The effects of conservation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="issues-in-experimental-design.html"><a href="issues-in-experimental-design.html"><i class="fa fa-check"></i><b>2</b> Issues in experimental design</a>
<ul>
<li class="chapter" data-level="2.1" data-path="completely-randomised-design-comparing-several-treatments.html"><a href="completely-randomised-design-comparing-several-treatments.html"><i class="fa fa-check"></i><b>2.1</b> Completely randomised design: comparing several treatments</a></li>
<li class="chapter" data-level="2.2" data-path="randomised-blocks-the-parable-of-the-sower.html"><a href="randomised-blocks-the-parable-of-the-sower.html"><i class="fa fa-check"></i><b>2.2</b> Randomised blocks: the parable of the sower</a></li>
<li class="chapter" data-level="2.3" data-path="factorial-designs-poisons-and-treatments.html"><a href="factorial-designs-poisons-and-treatments.html"><i class="fa fa-check"></i><b>2.3</b> Factorial designs: poisons and treatments</a></li>
<li class="chapter" data-level="2.4" data-path="power.html"><a href="power.html"><i class="fa fa-check"></i><b>2.4</b> Power</a></li>
<li class="chapter" data-level="2.5" data-path="principles-of-experimental-design.html"><a href="principles-of-experimental-design.html"><i class="fa fa-check"></i><b>2.5</b> Principles of experimental design</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="principles-of-experimental-design.html"><a href="principles-of-experimental-design.html#control"><i class="fa fa-check"></i><b>2.5.1</b> Control</a></li>
<li class="chapter" data-level="2.5.2" data-path="principles-of-experimental-design.html"><a href="principles-of-experimental-design.html#replicate"><i class="fa fa-check"></i><b>2.5.2</b> Replicate</a></li>
<li class="chapter" data-level="2.5.3" data-path="principles-of-experimental-design.html"><a href="principles-of-experimental-design.html#randomise"><i class="fa fa-check"></i><b>2.5.3</b> Randomise</a></li>
<li class="chapter" data-level="2.5.4" data-path="principles-of-experimental-design.html"><a href="principles-of-experimental-design.html#replication-and-pseudo-replication"><i class="fa fa-check"></i><b>2.5.4</b> Replication and Pseudo-Replication</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="exercises-1.html"><a href="exercises-1.html"><i class="fa fa-check"></i><b>2.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="exercises-1.html"><a href="exercises-1.html#student-cost-of-living"><i class="fa fa-check"></i><b>2.6.1</b> Student cost of living</a></li>
<li class="chapter" data-level="2.6.2" data-path="exercises-1.html"><a href="exercises-1.html#us-presidential-election-1936"><i class="fa fa-check"></i><b>2.6.2</b> US presidential election 1936</a></li>
<li class="chapter" data-level="2.6.3" data-path="exercises-1.html"><a href="exercises-1.html#the-parable-of-the-sower"><i class="fa fa-check"></i><b>2.6.3</b> The parable of the sower</a></li>
<li class="chapter" data-level="2.6.4" data-path="exercises-1.html"><a href="exercises-1.html#mururoa"><i class="fa fa-check"></i><b>2.6.4</b> Mururoa</a></li>
<li class="chapter" data-level="2.6.5" data-path="exercises-1.html"><a href="exercises-1.html#a-scottish-firth"><i class="fa fa-check"></i><b>2.6.5</b> A Scottish firth</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="issues-in-building-models.html"><a href="issues-in-building-models.html"><i class="fa fa-check"></i><b>3</b> Issues in building models</a>
<ul>
<li class="chapter" data-level="3.1" data-path="what-are-models-for.html"><a href="what-are-models-for.html"><i class="fa fa-check"></i><b>3.1</b> What are models for?</a></li>
<li class="chapter" data-level="3.2" data-path="model-selection.html"><a href="model-selection.html"><i class="fa fa-check"></i><b>3.2</b> Model selection</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Modelling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="factorial-designs-poisons-and-treatments" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Factorial designs: poisons and treatments<a href="factorial-designs-poisons-and-treatments.html#factorial-designs-poisons-and-treatments" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We are often in the situation where we wish to look at the effects of more than one factor simultaneously. A powerful design for this considers every possible combination of the two factors, ideally with replicates at each combination. This allows us to investigate the effects of each factor and also the possibility of interaction, where the effect of one factor depends on the setting of the other.</p>
<blockquote>
<hr />
<p><strong>Example: poisons and treatments</strong><br />
A famous dataset on poisons and antidotes records the survival times (in units of 10 hours) of animals in a <span class="math inline">\(3 \times 4\)</span> factorial experiment. Four animals were allocated to each combination of three poisons and four treatments, using a randomisation procedure. The data are available in the file <code>poisons</code> dataframe, available in the <code>rpanel</code> package.</p>
<p>What conclusions would you draw about the effects of the poisons and the treatments?</p>
<hr />
</blockquote>
<p>Code to read the data is shown below. The dataset is available in <code>rpanel</code>.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="factorial-designs-poisons-and-treatments.html#cb55-1" tabindex="-1"></a><span class="fu">library</span>(rpanel)  </span>
<span id="cb55-2"><a href="factorial-designs-poisons-and-treatments.html#cb55-2" tabindex="-1"></a>poisons<span class="sc">$</span>poison    <span class="ot">&lt;-</span> <span class="fu">factor</span>(poisons<span class="sc">$</span>poison)</span>
<span id="cb55-3"><a href="factorial-designs-poisons-and-treatments.html#cb55-3" tabindex="-1"></a>poisons<span class="sc">$</span>treatment <span class="ot">&lt;-</span> <span class="fu">factor</span>(poisons<span class="sc">$</span>treatment)</span></code></pre></div>
<p><span style="color: red;">&gt; <em>Are boxplots sensible here when there are so few observations? What did Box &amp; Cox do?</em></span></p>
<p>Some simple boxplots provide a good initial visualisation. An immediate troubling issue os that the standard deviations of the groups are rather different. A linear model seeks to make the assumption that the standard deviation of the errors is the same everywhere. Is there a transformation which might make this assumption more reasonable?</p>
<p><span style="color: red;">&gt; <em>Explain the model, sums-of-squares etc.</em></span></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="factorial-designs-poisons-and-treatments.html#cb56-1" tabindex="-1"></a><span class="fu">rp.lm</span>(stime <span class="sc">~</span> poison <span class="sc">*</span> treatment, <span class="at">data =</span> poisons, <span class="at">panel =</span> <span class="cn">FALSE</span>)</span>
<span id="cb56-2"><a href="factorial-designs-poisons-and-treatments.html#cb56-2" tabindex="-1"></a><span class="fu">rp.lm</span>(stime <span class="sc">~</span> poison <span class="sc">*</span> treatment, <span class="at">comparison.model =</span> <span class="sc">~</span> poison <span class="sc">+</span> treatment,</span>
<span id="cb56-3"><a href="factorial-designs-poisons-and-treatments.html#cb56-3" tabindex="-1"></a>      <span class="at">data =</span> poisons, <span class="at">panel =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="book_files/figure-html/poisons_original-1.png" width="49%" /><img src="book_files/figure-html/poisons_original-2.png" width="49%" /></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="factorial-designs-poisons-and-treatments.html#cb57-1" tabindex="-1"></a>model0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(stime <span class="sc">~</span> treatment <span class="sc">*</span> poison, <span class="at">data =</span> poisons)</span>
<span id="cb57-2"><a href="factorial-designs-poisons-and-treatments.html#cb57-2" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb57-3"><a href="factorial-designs-poisons-and-treatments.html#cb57-3" tabindex="-1"></a><span class="fu">boxcox</span>(model0, <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span>))</span>
<span id="cb57-4"><a href="factorial-designs-poisons-and-treatments.html#cb57-4" tabindex="-1"></a></span>
<span id="cb57-5"><a href="factorial-designs-poisons-and-treatments.html#cb57-5" tabindex="-1"></a>poisons <span class="ot">&lt;-</span> <span class="fu">mutate</span>(poisons, <span class="at">rate =</span> <span class="dv">1</span> <span class="sc">/</span> stime)</span>
<span id="cb57-6"><a href="factorial-designs-poisons-and-treatments.html#cb57-6" tabindex="-1"></a><span class="fu">rp.lm</span>(rate <span class="sc">~</span> poison <span class="sc">*</span> treatment, <span class="at">comparison.model =</span> <span class="sc">~</span> poison <span class="sc">+</span> treatment,</span>
<span id="cb57-7"><a href="factorial-designs-poisons-and-treatments.html#cb57-7" tabindex="-1"></a>      <span class="at">data =</span> poisons, <span class="at">panel =</span> <span class="cn">FALSE</span>)</span>
<span id="cb57-8"><a href="factorial-designs-poisons-and-treatments.html#cb57-8" tabindex="-1"></a></span>
<span id="cb57-9"><a href="factorial-designs-poisons-and-treatments.html#cb57-9" tabindex="-1"></a><span class="co"># mns &lt;- poisons %&gt;% </span></span>
<span id="cb57-10"><a href="factorial-designs-poisons-and-treatments.html#cb57-10" tabindex="-1"></a><span class="co">#   group_by(poison, treatment) %&gt;% </span></span>
<span id="cb57-11"><a href="factorial-designs-poisons-and-treatments.html#cb57-11" tabindex="-1"></a><span class="co">#   summarise(mn = mean(1/stime),</span></span>
<span id="cb57-12"><a href="factorial-designs-poisons-and-treatments.html#cb57-12" tabindex="-1"></a><span class="co">#             se = (sd(1/stime) / sqrt(length(1/stime))))</span></span>
<span id="cb57-13"><a href="factorial-designs-poisons-and-treatments.html#cb57-13" tabindex="-1"></a><span class="co"># ggplot(poisons, aes(treatment, 1/stime)) +</span></span>
<span id="cb57-14"><a href="factorial-designs-poisons-and-treatments.html#cb57-14" tabindex="-1"></a><span class="co">#   geom_jitter(width = 0.1, height = 0, alpha = 0.5) +</span></span>
<span id="cb57-15"><a href="factorial-designs-poisons-and-treatments.html#cb57-15" tabindex="-1"></a><span class="co">#   geom_line(aes(x = treatment, y = mn, group = poison), data = mns) +</span></span>
<span id="cb57-16"><a href="factorial-designs-poisons-and-treatments.html#cb57-16" tabindex="-1"></a><span class="co">#   geom_linerange(aes(x = treatment, y = mn, ymin = mn - 2 * se, ymax = mn + 2 * se),</span></span>
<span id="cb57-17"><a href="factorial-designs-poisons-and-treatments.html#cb57-17" tabindex="-1"></a><span class="co">#                  linewidth = 3, alpha = 0.3, data = mns) +</span></span>
<span id="cb57-18"><a href="factorial-designs-poisons-and-treatments.html#cb57-18" tabindex="-1"></a><span class="co">#   facet_wrap(vars(poison)) + ggtitle(&quot;reciprocal scale&quot;)</span></span></code></pre></div>
<p><img src="book_files/figure-html/poisons_boxcox-1.png" width="49%" /><img src="book_files/figure-html/poisons_boxcox-2.png" width="49%" /></p>
<p>There are ways of identifying suitable transformation more systematically. One is the Box-Cox transformation which considers power transformations (which, when suitably normalised, contain the log transformation as a special case). The statistical principle of likelihood can be used to evaluate different powers. The example below uses the <code>boxcox</code> function in the <code>MASS</code> package to show that the reciprocal (lambda = -1) transformation is a good choice for the poisons data. Why should this be? As the response variable `stime’ is a survival time, its reciprocal could be considered ‘speed of death’. It is always helpful to have an interpretation of a transformation.</p>
<p>A linear model can now be fitted. It is wise to include and examine possible interactions. An anlysis of variance table is a good way of assessing the evidence and this suggests that a model without interaction is justifiable. If evidence of interaction is present then the <em>main effects</em> of the factors do not have a simple interpretation. As the results below show, there is no evidence of interaction in this example, so we have a clear interpretation of the effects of the two factors. These are quantified in the model without an interaction term present, where the terms refer to the effect of each factor level compared to the first factor level.</p>
<p><span style="color: red;">&gt; <em>rp.drop1 does not work below.</em></span></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="factorial-designs-poisons-and-treatments.html#cb58-1" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(rate <span class="sc">~</span> treatment <span class="sc">*</span> poison, <span class="at">data =</span> poisons)</span>
<span id="cb58-2"><a href="factorial-designs-poisons-and-treatments.html#cb58-2" tabindex="-1"></a><span class="fu">anova</span>(model)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: rate
##                  Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## treatment         3 20.414  6.8048 28.3431 1.376e-09 ***
## poison            2 34.877 17.4386 72.6347 2.310e-13 ***
## treatment:poison  6  1.571  0.2618  1.0904    0.3867    
## Residuals        36  8.643  0.2401                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="factorial-designs-poisons-and-treatments.html#cb60-1" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(rate <span class="sc">~</span> treatment <span class="sc">+</span> poison, <span class="at">data =</span> poisons)</span>
<span id="cb60-2"><a href="factorial-designs-poisons-and-treatments.html#cb60-2" tabindex="-1"></a><span class="fu">summary</span>(model)<span class="sc">$</span>coefficients</span></code></pre></div>
<pre><code>##               Estimate Std. Error   t value     Pr(&gt;|t|)
## (Intercept)  2.6976566  0.1743513 15.472534 5.936991e-19
## treatment2  -1.6574024  0.2013236 -8.232531 2.655965e-10
## treatment3  -0.5721354  0.2013236 -2.841870 6.892762e-03
## treatment4  -1.3583383  0.2013236 -6.747041 3.347340e-08
## poison2      0.4686413  0.1743513  2.687914 1.026221e-02
## poison3      1.9964249  0.1743513 11.450587 1.690903e-14</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="factorial-designs-poisons-and-treatments.html#cb62-1" tabindex="-1"></a><span class="co"># rp.drop1(model)</span></span>
<span id="cb62-2"><a href="factorial-designs-poisons-and-treatments.html#cb62-2" tabindex="-1"></a><span class="fu">rp.coefficients</span>(model)</span></code></pre></div>
<p><img src="book_files/figure-html/poisons_reciprocal-1.png" width="49%" /></p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="randomised-blocks-the-parable-of-the-sower.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="power.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["book.pdf", "book.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
