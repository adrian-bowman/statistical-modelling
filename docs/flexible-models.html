<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>12 Flexible models | Statistical Modelling</title>
  <meta name="description" content="A conceptual, visual and practical introduction to statistical modelling" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="12 Flexible models | Statistical Modelling" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A conceptual, visual and practical introduction to statistical modelling" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="12 Flexible models | Statistical Modelling" />
  
  <meta name="twitter:description" content="A conceptual, visual and practical introduction to statistical modelling" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="models-with-random-effects.html"/>
<link rel="next" href="models-for-time.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/rglWebGL-binding-1.2.8/rglWebGL.js"></script>
<link href="libs/rglwidgetClass-1.2.8/rgl.css" rel="stylesheet" />
<script src="libs/rglwidgetClass-1.2.8/rglClass.min.js"></script>
<script src="libs/CanvasMatrix4-1.2.8/CanvasMatrix.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.1/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.1/leaflet-providers-plugin.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A visual and conceptual introduction to statistical modelling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface: what’s the problem?</a></li>
<li class="chapter" data-level="" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html"><i class="fa fa-check"></i>Getting started with R</a></li>
<li class="part"><span><b>I Introduction</b></span></li>
<li class="chapter" data-level="1" data-path="where-data.html"><a href="where-data.html"><i class="fa fa-check"></i><b>1</b> Where do data come from?</a>
<ul>
<li class="chapter" data-level="1.1" data-path="where-data.html"><a href="where-data.html#examples-data"><i class="fa fa-check"></i><b>1.1</b> Some examples of data</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="where-data.html"><a href="where-data.html#co2-and-global-warming"><i class="fa fa-check"></i><b>1.1.1</b> CO2 and global warming</a></li>
<li class="chapter" data-level="1.1.2" data-path="where-data.html"><a href="where-data.html#the-first-tuberculosis-trial"><i class="fa fa-check"></i><b>1.1.2</b> The first tuberculosis trial</a></li>
<li class="chapter" data-level="1.1.3" data-path="where-data.html"><a href="where-data.html#the-birds-and-the-bees-how-to-tell-the-sex-of-a-herring-gull"><i class="fa fa-check"></i><b>1.1.3</b> The birds and the bees: how to tell the sex of a herring gull</a></li>
<li class="chapter" data-level="1.1.4" data-path="where-data.html"><a href="where-data.html#tracking-the-covid-pandemic"><i class="fa fa-check"></i><b>1.1.4</b> Tracking the covid pandemic</a></li>
<li class="chapter" data-level="1.1.5" data-path="where-data.html"><a href="where-data.html#more-complex-data-objects"><i class="fa fa-check"></i><b>1.1.5</b> More complex data objects</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="where-data.html"><a href="where-data.html#some-broad-issues"><i class="fa fa-check"></i><b>1.2</b> Some broad issues</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="where-data.html"><a href="where-data.html#whats-the-problem"><i class="fa fa-check"></i><b>1.2.1</b> What’s the problem?</a></li>
<li class="chapter" data-level="1.2.2" data-path="where-data.html"><a href="where-data.html#whats-the-plan"><i class="fa fa-check"></i><b>1.2.2</b> What’s the plan?</a></li>
<li class="chapter" data-level="1.2.3" data-path="where-data.html"><a href="where-data.html#where-do-the-data-come-from"><i class="fa fa-check"></i><b>1.2.3</b> Where do the data come from?</a></li>
<li class="chapter" data-level="1.2.4" data-path="where-data.html"><a href="where-data.html#who-do-you-trust"><i class="fa fa-check"></i><b>1.2.4</b> Who do you trust?</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="where-data.html"><a href="where-data.html#what-could-possibly-go-wrong"><i class="fa fa-check"></i><b>1.3</b> What could possibly go wrong?</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="where-data.html"><a href="where-data.html#us-presidential-elections-1936-and-1948"><i class="fa fa-check"></i><b>1.3.1</b> US presidential elections, 1936 and 1948</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="where-data.html"><a href="where-data.html#further-reading"><i class="fa fa-check"></i><b>1.4</b> Further reading</a></li>
<li class="chapter" data-level="1.5" data-path="where-data.html"><a href="where-data.html#exercises"><i class="fa fa-check"></i><b>1.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="where-data.html"><a href="where-data.html#an-investigation-of-short-term-memory"><i class="fa fa-check"></i><b>1.5.1</b> An investigation of short-term memory</a></li>
<li class="chapter" data-level="1.5.2" data-path="where-data.html"><a href="where-data.html#a-survey-of-dental-health"><i class="fa fa-check"></i><b>1.5.2</b> A survey of dental health</a></li>
<li class="chapter" data-level="1.5.3" data-path="where-data.html"><a href="where-data.html#hearings-aid-and-dementia"><i class="fa fa-check"></i><b>1.5.3</b> Hearings aid and dementia</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="R-introduction.html"><a href="R-introduction.html"><i class="fa fa-check"></i><b>2</b> A gentle introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="R-introduction.html"><a href="R-introduction.html#r-fuss"><i class="fa fa-check"></i><b>2.1</b> R: what’s all the fuss about?</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="R-introduction.html"><a href="R-introduction.html#history"><i class="fa fa-check"></i><b>2.1.1</b> History</a></li>
<li class="chapter" data-level="2.1.2" data-path="R-introduction.html"><a href="R-introduction.html#why-should-i-be-interested"><i class="fa fa-check"></i><b>2.1.2</b> Why should I be interested?</a></li>
<li class="chapter" data-level="2.1.3" data-path="R-introduction.html"><a href="R-introduction.html#whats-the-down-side"><i class="fa fa-check"></i><b>2.1.3</b> What’s the down side?</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="R-introduction.html"><a href="R-introduction.html#taste-of-r"><i class="fa fa-check"></i><b>2.2</b> A taste of R</a></li>
<li class="chapter" data-level="2.3" data-path="R-introduction.html"><a href="R-introduction.html#a-summary-of-key-concepts-in-r"><i class="fa fa-check"></i><b>2.3</b> A summary of key concepts in R</a></li>
<li class="chapter" data-level="2.4" data-path="R-introduction.html"><a href="R-introduction.html#reading-data"><i class="fa fa-check"></i><b>2.4</b> Reading data into R</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="R-introduction.html"><a href="R-introduction.html#accessing-the-data-used-in-this-book"><i class="fa fa-check"></i><b>2.4.1</b> Accessing the data used in this book</a></li>
<li class="chapter" data-level="2.4.2" data-path="R-introduction.html"><a href="R-introduction.html#functions-for-reading-data"><i class="fa fa-check"></i><b>2.4.2</b> Functions for reading data</a></li>
<li class="chapter" data-level="2.4.3" data-path="R-introduction.html"><a href="R-introduction.html#reading-data-example"><i class="fa fa-check"></i><b>2.4.3</b> An example: reading an <em>Excel</em> spreadsheet</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="R-introduction.html"><a href="R-introduction.html#a-further-example-the-scottish-independence-referendum"><i class="fa fa-check"></i><b>2.5</b> A further example: the Scottish independence referendum</a></li>
<li class="chapter" data-level="2.6" data-path="R-introduction.html"><a href="R-introduction.html#further-reading-1"><i class="fa fa-check"></i><b>2.6</b> Further reading</a></li>
<li class="chapter" data-level="2.7" data-path="R-introduction.html"><a href="R-introduction.html#exercises-1"><i class="fa fa-check"></i><b>2.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="R-introduction.html"><a href="R-introduction.html#scottish-referendum-data"><i class="fa fa-check"></i><b>2.7.1</b> Scottish Referendum data</a></li>
<li class="chapter" data-level="2.7.2" data-path="R-introduction.html"><a href="R-introduction.html#aircraft-designs"><i class="fa fa-check"></i><b>2.7.2</b> Aircraft designs</a></li>
<li class="chapter" data-level="2.7.3" data-path="R-introduction.html"><a href="R-introduction.html#centenarians"><i class="fa fa-check"></i><b>2.7.3</b> Centenarians</a></li>
<li class="chapter" data-level="2.7.4" data-path="R-introduction.html"><a href="R-introduction.html#justification-of-the-log-transformation-for-the-rodent-data"><i class="fa fa-check"></i><b>2.7.4</b> Justification of the log transformation for the rodent data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>3</b> Data wrangling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-wrangling.html"><a href="data-wrangling.html#reorganising-data"><i class="fa fa-check"></i><b>3.1</b> Reorganising data</a></li>
<li class="chapter" data-level="3.2" data-path="data-wrangling.html"><a href="data-wrangling.html#collating-data-from-different-sources"><i class="fa fa-check"></i><b>3.2</b> Collating data from different sources</a></li>
<li class="chapter" data-level="3.3" data-path="data-wrangling.html"><a href="data-wrangling.html#tidy-data"><i class="fa fa-check"></i><b>3.3</b> Tidy data</a></li>
<li class="chapter" data-level="3.4" data-path="data-wrangling.html"><a href="data-wrangling.html#further-reading-2"><i class="fa fa-check"></i><b>3.4</b> Further reading</a></li>
<li class="chapter" data-level="3.5" data-path="data-wrangling.html"><a href="data-wrangling.html#exercises-2"><i class="fa fa-check"></i><b>3.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="data-wrangling.html"><a href="data-wrangling.html#data-wrangling-exercise-UN-demography"><i class="fa fa-check"></i><b>3.5.1</b> UN demography data</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Exploring data</b></span></li>
<li class="chapter" data-level="4" data-path="data-visualisation.html"><a href="data-visualisation.html"><i class="fa fa-check"></i><b>4</b> Data Visualisation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-visualisation.html"><a href="data-visualisation.html#thousand-words"><i class="fa fa-check"></i><b>4.1</b> Graphics: a picture is worth a thousand words</a></li>
<li class="chapter" data-level="4.2" data-path="data-visualisation.html"><a href="data-visualisation.html#ggplot-graphics"><i class="fa fa-check"></i><b>4.2</b> <code>ggplot</code> graphics</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="data-visualisation.html"><a href="data-visualisation.html#ggplot-graphics-basics"><i class="fa fa-check"></i><b>4.2.1</b> The basics</a></li>
<li class="chapter" data-level="4.2.2" data-path="data-visualisation.html"><a href="data-visualisation.html#facets"><i class="fa fa-check"></i><b>4.2.2</b> Facets</a></li>
<li class="chapter" data-level="4.2.3" data-path="data-visualisation.html"><a href="data-visualisation.html#going-deeper"><i class="fa fa-check"></i><b>4.2.3</b> Going deeper</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="data-visualisation.html"><a href="data-visualisation.html#what-are-we-looking-for"><i class="fa fa-check"></i><b>4.3</b> What are we looking for?</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="data-visualisation.html"><a href="data-visualisation.html#continuous-scales"><i class="fa fa-check"></i><b>4.3.1</b> Continuous scales</a></li>
<li class="chapter" data-level="4.3.2" data-path="data-visualisation.html"><a href="data-visualisation.html#discrete-scales"><i class="fa fa-check"></i><b>4.3.2</b> Discrete scales</a></li>
<li class="chapter" data-level="4.3.3" data-path="data-visualisation.html"><a href="data-visualisation.html#categorical-data"><i class="fa fa-check"></i><b>4.3.3</b> Categorical data</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data-visualisation.html"><a href="data-visualisation.html#gaining-an-overview-of-datasets"><i class="fa fa-check"></i><b>4.4</b> Gaining an overview of datasets</a></li>
<li class="chapter" data-level="4.5" data-path="data-visualisation.html"><a href="data-visualisation.html#plots-for-more-complex-data-structures"><i class="fa fa-check"></i><b>4.5</b> Plots for more complex data structures</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="data-visualisation.html"><a href="data-visualisation.html#d-data"><i class="fa fa-check"></i><b>4.5.1</b> 3D data</a></li>
<li class="chapter" data-level="4.5.2" data-path="data-visualisation.html"><a href="data-visualisation.html#circular-spherical-and-compositional-data"><i class="fa fa-check"></i><b>4.5.2</b> Circular, spherical and compositional data</a></li>
<li class="chapter" data-level="4.5.3" data-path="data-visualisation.html"><a href="data-visualisation.html#other-data-structures"><i class="fa fa-check"></i><b>4.5.3</b> Other data structures</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="data-visualisation.html"><a href="data-visualisation.html#going-further"><i class="fa fa-check"></i><b>4.6</b> Going further</a></li>
<li class="chapter" data-level="4.7" data-path="data-visualisation.html"><a href="data-visualisation.html#exercises-3"><i class="fa fa-check"></i><b>4.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="data-visualisation.html"><a href="data-visualisation.html#rodent-mass-and-speed"><i class="fa fa-check"></i><b>4.7.1</b> Rodent mass and speed</a></li>
<li class="chapter" data-level="4.7.2" data-path="data-visualisation.html"><a href="data-visualisation.html#uk-covid-19-deaths"><i class="fa fa-check"></i><b>4.7.2</b> UK covid-19 deaths</a></li>
<li class="chapter" data-level="4.7.3" data-path="data-visualisation.html"><a href="data-visualisation.html#scottish-referendum"><i class="fa fa-check"></i><b>4.7.3</b> Scottish referendum</a></li>
<li class="chapter" data-level="4.7.4" data-path="data-visualisation.html"><a href="data-visualisation.html#centenarians-in-scotland"><i class="fa fa-check"></i><b>4.7.4</b> Centenarians in Scotland</a></li>
<li class="chapter" data-level="4.7.5" data-path="data-visualisation.html"><a href="data-visualisation.html#flour-beetles"><i class="fa fa-check"></i><b>4.7.5</b> Flour beetles</a></li>
<li class="chapter" data-level="4.7.6" data-path="data-visualisation.html"><a href="data-visualisation.html#clyde-estuary-water-quality"><i class="fa fa-check"></i><b>4.7.6</b> Clyde Estuary water quality</a></li>
<li class="chapter" data-level="4.7.7" data-path="data-visualisation.html"><a href="data-visualisation.html#crabs-multivariate"><i class="fa fa-check"></i><b>4.7.7</b> Crabs (<em>multivariate</em>)</a></li>
<li class="chapter" data-level="4.7.8" data-path="data-visualisation.html"><a href="data-visualisation.html#topographic-data"><i class="fa fa-check"></i><b>4.7.8</b> Topographic data</a></li>
<li class="chapter" data-level="4.7.9" data-path="data-visualisation.html"><a href="data-visualisation.html#global-energy-use"><i class="fa fa-check"></i><b>4.7.9</b> Global energy use</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="trends-and-patterns.html"><a href="trends-and-patterns.html"><i class="fa fa-check"></i><b>5</b> Trends and patterns</a>
<ul>
<li class="chapter" data-level="5.1" data-path="trends-and-patterns.html"><a href="trends-and-patterns.html#density-estimation"><i class="fa fa-check"></i><b>5.1</b> Density estimation</a></li>
<li class="chapter" data-level="5.2" data-path="trends-and-patterns.html"><a href="trends-and-patterns.html#flexible-regression"><i class="fa fa-check"></i><b>5.2</b> Flexible regression</a></li>
<li class="chapter" data-level="5.3" data-path="trends-and-patterns.html"><a href="trends-and-patterns.html#further-reading-3"><i class="fa fa-check"></i><b>5.3</b> Further reading</a></li>
<li class="chapter" data-level="5.4" data-path="trends-and-patterns.html"><a href="trends-and-patterns.html#exercises-4"><i class="fa fa-check"></i><b>5.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="trends-and-patterns.html"><a href="trends-and-patterns.html#exercise-conservation-density-displays"><i class="fa fa-check"></i><b>5.4.1</b> Does conservation work?</a></li>
<li class="chapter" data-level="5.4.2" data-path="trends-and-patterns.html"><a href="trends-and-patterns.html#the-spatial-distribution-of-laryngeal-cancer-smoothing"><i class="fa fa-check"></i><b>5.4.2</b> The spatial distribution of laryngeal cancer (<em>smoothing</em>)</a></li>
<li class="chapter" data-level="5.4.3" data-path="trends-and-patterns.html"><a href="trends-and-patterns.html#aircraft-data"><i class="fa fa-check"></i><b>5.4.3</b> Aircraft data</a></li>
<li class="chapter" data-level="5.4.4" data-path="trends-and-patterns.html"><a href="trends-and-patterns.html#radiocarbon-data"><i class="fa fa-check"></i><b>5.4.4</b> Radiocarbon data</a></li>
<li class="chapter" data-level="5.4.5" data-path="trends-and-patterns.html"><a href="trends-and-patterns.html#follicle-data"><i class="fa fa-check"></i><b>5.4.5</b> Follicle data</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Statistical Inference</b></span></li>
<li class="chapter" data-level="6" data-path="inference.html"><a href="inference.html"><i class="fa fa-check"></i><b>6</b> Inference: turning data into evidence</a>
<ul>
<li class="chapter" data-level="6.1" data-path="inference.html"><a href="inference.html#where-do-data-come-from-samples-and-populations"><i class="fa fa-check"></i><b>6.1</b> Where do data come from? Samples and populations</a></li>
<li class="chapter" data-level="6.2" data-path="inference.html"><a href="inference.html#quantifying-uncertainty-standard-error"><i class="fa fa-check"></i><b>6.2</b> Quantifying uncertainty: standard error</a></li>
<li class="chapter" data-level="6.3" data-path="inference.html"><a href="inference.html#quantifying-uncertainty-confidence-intervals"><i class="fa fa-check"></i><b>6.3</b> Quantifying uncertainty: confidence intervals</a></li>
<li class="chapter" data-level="6.4" data-path="inference.html"><a href="inference.html#hypothesis-tests"><i class="fa fa-check"></i><b>6.4</b> Hypothesis tests</a></li>
<li class="chapter" data-level="6.5" data-path="inference.html"><a href="inference.html#variability-bands-for-flexible-regression"><i class="fa fa-check"></i><b>6.5</b> Variability bands for flexible regression</a></li>
<li class="chapter" data-level="6.6" data-path="inference.html"><a href="inference.html#further-reading-4"><i class="fa fa-check"></i><b>6.6</b> Further reading</a></li>
<li class="chapter" data-level="6.7" data-path="inference.html"><a href="inference.html#exercises-5"><i class="fa fa-check"></i><b>6.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="inference.html"><a href="inference.html#standard-errors"><i class="fa fa-check"></i><b>6.7.1</b> Standard errors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="other-approaches-to-inference.html"><a href="other-approaches-to-inference.html"><i class="fa fa-check"></i><b>7</b> Other approaches to inference</a>
<ul>
<li class="chapter" data-level="7.1" data-path="other-approaches-to-inference.html"><a href="other-approaches-to-inference.html#computational-inference"><i class="fa fa-check"></i><b>7.1</b> Computational inference</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="other-approaches-to-inference.html"><a href="other-approaches-to-inference.html#simulation-methods"><i class="fa fa-check"></i><b>7.1.1</b> Simulation methods</a></li>
<li class="chapter" data-level="7.1.2" data-path="other-approaches-to-inference.html"><a href="other-approaches-to-inference.html#randomisation-tests"><i class="fa fa-check"></i><b>7.1.2</b> Randomisation tests</a></li>
<li class="chapter" data-level="7.1.3" data-path="other-approaches-to-inference.html"><a href="other-approaches-to-inference.html#the-bootstrap"><i class="fa fa-check"></i><b>7.1.3</b> The bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="other-approaches-to-inference.html"><a href="other-approaches-to-inference.html#bayesian-inference"><i class="fa fa-check"></i><b>7.2</b> Bayesian inference</a></li>
<li class="chapter" data-level="7.3" data-path="other-approaches-to-inference.html"><a href="other-approaches-to-inference.html#exercises-6"><i class="fa fa-check"></i><b>7.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="other-approaches-to-inference.html"><a href="other-approaches-to-inference.html#coverage-property-of-bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>7.3.1</b> Coverage property of bootstrap confidence intervals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="inference-with-categorical-data.html"><a href="inference-with-categorical-data.html"><i class="fa fa-check"></i><b>8</b> Inference with categorical data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="inference-with-categorical-data.html"><a href="inference-with-categorical-data.html#simple-proportions"><i class="fa fa-check"></i><b>8.1</b> Simple proportions</a></li>
<li class="chapter" data-level="8.2" data-path="inference-with-categorical-data.html"><a href="inference-with-categorical-data.html#comparing-proportions"><i class="fa fa-check"></i><b>8.2</b> Comparing proportions</a></li>
<li class="chapter" data-level="8.3" data-path="inference-with-categorical-data.html"><a href="inference-with-categorical-data.html#contingency-tables"><i class="fa fa-check"></i><b>8.3</b> Contingency tables</a></li>
<li class="chapter" data-level="8.4" data-path="inference-with-categorical-data.html"><a href="inference-with-categorical-data.html#exercises-7"><i class="fa fa-check"></i><b>8.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="inference-with-categorical-data.html"><a href="inference-with-categorical-data.html#opinion-polls"><i class="fa fa-check"></i><b>8.4.1</b> Opinion polls</a></li>
<li class="chapter" data-level="8.4.2" data-path="inference-with-categorical-data.html"><a href="inference-with-categorical-data.html#respiratory-disease-in-infancy"><i class="fa fa-check"></i><b>8.4.2</b> Respiratory disease in infancy</a></li>
<li class="chapter" data-level="8.4.3" data-path="inference-with-categorical-data.html"><a href="inference-with-categorical-data.html#smoking-and-lung-cancer"><i class="fa fa-check"></i><b>8.4.3</b> Smoking and lung cancer</a></li>
<li class="chapter" data-level="8.4.4" data-path="inference-with-categorical-data.html"><a href="inference-with-categorical-data.html#confidence-intervals-and-p-values"><i class="fa fa-check"></i><b>8.4.4</b> Confidence intervals and p-values</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Statistical Models</b></span></li>
<li class="chapter" data-level="9" data-path="linear-models.html"><a href="linear-models.html"><i class="fa fa-check"></i><b>9</b> Linear models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="linear-models.html"><a href="linear-models.html#simple-regression"><i class="fa fa-check"></i><b>9.1</b> One covariate: linear models in miniature</a></li>
<li class="chapter" data-level="9.2" data-path="linear-models.html"><a href="linear-models.html#formulating-and-fitting-linear-models"><i class="fa fa-check"></i><b>9.2</b> Formulating and fitting linear models</a></li>
<li class="chapter" data-level="9.3" data-path="linear-models.html"><a href="linear-models.html#model-checking"><i class="fa fa-check"></i><b>9.3</b> Model checking</a></li>
<li class="chapter" data-level="9.4" data-path="linear-models.html"><a href="linear-models.html#inference-1"><i class="fa fa-check"></i><b>9.4</b> Inference</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="linear-models.html"><a href="linear-models.html#confidence-intervals"><i class="fa fa-check"></i><b>9.4.1</b> Confidence intervals</a></li>
<li class="chapter" data-level="9.4.2" data-path="linear-models.html"><a href="linear-models.html#hypothesis-tests-1"><i class="fa fa-check"></i><b>9.4.2</b> Hypothesis tests</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="linear-models.html"><a href="linear-models.html#two-covariates-black-cherry-trees"><i class="fa fa-check"></i><b>9.5</b> Two covariates: Black Cherry Trees</a></li>
<li class="chapter" data-level="9.6" data-path="linear-models.html"><a href="linear-models.html#comparing-groups-analysis-of-variance"><i class="fa fa-check"></i><b>9.6</b> Comparing groups: analysis of variance</a></li>
<li class="chapter" data-level="9.7" data-path="linear-models.html"><a href="linear-models.html#comparing-regression-lines-analysis-of-covariance"><i class="fa fa-check"></i><b>9.7</b> Comparing regression lines: analysis of covariance</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="linear-models.html"><a href="linear-models.html#trout"><i class="fa fa-check"></i><b>9.7.1</b> Trout</a></li>
<li class="chapter" data-level="9.7.2" data-path="linear-models.html"><a href="linear-models.html#respiratory-distress-syndrome"><i class="fa fa-check"></i><b>9.7.2</b> Respiratory distress syndrome</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="linear-models.html"><a href="linear-models.html#general-thoughts-on-models"><i class="fa fa-check"></i><b>9.8</b> General thoughts on models</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="linear-models.html"><a href="linear-models.html#what-are-models-for"><i class="fa fa-check"></i><b>9.8.1</b> What are models for?</a></li>
<li class="chapter" data-level="9.8.2" data-path="linear-models.html"><a href="linear-models.html#model-selection"><i class="fa fa-check"></i><b>9.8.2</b> Model selection</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="linear-models.html"><a href="linear-models.html#exercises-8"><i class="fa fa-check"></i><b>9.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="9.9.1" data-path="linear-models.html"><a href="linear-models.html#giving-in-the-church-of-england"><i class="fa fa-check"></i><b>9.9.1</b> Giving in the Church of England</a></li>
<li class="chapter" data-level="9.9.2" data-path="linear-models.html"><a href="linear-models.html#black-cherry-trees"><i class="fa fa-check"></i><b>9.9.2</b> Black Cherry trees</a></li>
<li class="chapter" data-level="9.9.3" data-path="linear-models.html"><a href="linear-models.html#cats"><i class="fa fa-check"></i><b>9.9.3</b> Cats</a></li>
<li class="chapter" data-level="9.9.4" data-path="linear-models.html"><a href="linear-models.html#respiratory-distress-syndrome-1"><i class="fa fa-check"></i><b>9.9.4</b> Respiratory distress syndrome</a></li>
<li class="chapter" data-level="9.9.5" data-path="linear-models.html"><a href="linear-models.html#the-clyde-data"><i class="fa fa-check"></i><b>9.9.5</b> The Clyde data</a></li>
<li class="chapter" data-level="9.9.6" data-path="linear-models.html"><a href="linear-models.html#water-quality-in-loch-leven"><i class="fa fa-check"></i><b>9.9.6</b> Water quality in Loch Leven</a></li>
<li class="chapter" data-level="9.9.7" data-path="linear-models.html"><a href="linear-models.html#so_2-over-europe"><i class="fa fa-check"></i><b>9.9.7</b> SO<span class="math inline">\(_2\)</span> over Europe</a></li>
<li class="chapter" data-level="9.9.8" data-path="linear-models.html"><a href="linear-models.html#maximal-heart-rate-and-age"><i class="fa fa-check"></i><b>9.9.8</b> Maximal heart rate and age</a></li>
<li class="chapter" data-level="9.9.9" data-path="linear-models.html"><a href="linear-models.html#the-effects-of-conservation"><i class="fa fa-check"></i><b>9.9.9</b> The effects of conservation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html"><i class="fa fa-check"></i><b>10</b> Generalised linear models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#logistic-regression"><i class="fa fa-check"></i><b>10.1</b> Binomial data: logistic regression</a></li>
<li class="chapter" data-level="10.2" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#the-concept-of-likelihood"><i class="fa fa-check"></i><b>10.2</b> The concept of likelihood</a></li>
<li class="chapter" data-level="10.3" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#poisson-regression"><i class="fa fa-check"></i><b>10.3</b> Count data: Poisson regression</a></li>
<li class="chapter" data-level="10.4" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#general-glms"><i class="fa fa-check"></i><b>10.4</b> A general formulation of GLMs</a></li>
<li class="chapter" data-level="10.5" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#further-examples"><i class="fa fa-check"></i><b>10.5</b> Further examples</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#two-covariates-vasoconstriction-of-the-digits"><i class="fa fa-check"></i><b>10.5.1</b> Two covariates: vasoconstriction of the digits</a></li>
<li class="chapter" data-level="10.5.2" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#doctors-and-smoking"><i class="fa fa-check"></i><b>10.5.2</b> Doctors and smoking</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#exercises-9"><i class="fa fa-check"></i><b>10.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#bissell-data"><i class="fa fa-check"></i><b>10.6.1</b> Bissell data</a></li>
<li class="chapter" data-level="10.6.2" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#vasoconstriction-data"><i class="fa fa-check"></i><b>10.6.2</b> Vasoconstriction data</a></li>
<li class="chapter" data-level="10.6.3" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#the-framingham-heart-study"><i class="fa fa-check"></i><b>10.6.3</b> The Framingham heart study</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="models-with-random-effects.html"><a href="models-with-random-effects.html"><i class="fa fa-check"></i><b>11</b> Models with random effects</a>
<ul>
<li class="chapter" data-level="11.1" data-path="models-with-random-effects.html"><a href="models-with-random-effects.html#a-problem-with-paste"><i class="fa fa-check"></i><b>11.1</b> A problem with paste</a></li>
<li class="chapter" data-level="11.2" data-path="models-with-random-effects.html"><a href="models-with-random-effects.html#repeated-measurements"><i class="fa fa-check"></i><b>11.2</b> Repeated measurements</a></li>
<li class="chapter" data-level="11.3" data-path="models-with-random-effects.html"><a href="models-with-random-effects.html#a-case-study-reading-attainment"><i class="fa fa-check"></i><b>11.3</b> A case study: reading attainment</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="flexible-models.html"><a href="flexible-models.html"><i class="fa fa-check"></i><b>12</b> Flexible models</a>
<ul>
<li class="chapter" data-level="12.1" data-path="flexible-models.html"><a href="flexible-models.html#flexible-methods"><i class="fa fa-check"></i><b>12.1</b> Methods for constructing flexible models</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="flexible-models.html"><a href="flexible-models.html#fitting-models-locally"><i class="fa fa-check"></i><b>12.1.1</b> Fitting models locally</a></li>
<li class="chapter" data-level="12.1.2" data-path="flexible-models.html"><a href="flexible-models.html#splines"><i class="fa fa-check"></i><b>12.1.2</b> Splines</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="flexible-models.html"><a href="flexible-models.html#inference-with-simple-flexible-models"><i class="fa fa-check"></i><b>12.2</b> Inference with simple flexible models</a></li>
<li class="chapter" data-level="12.3" data-path="flexible-models.html"><a href="flexible-models.html#a-simple-additive-model"><i class="fa fa-check"></i><b>12.3</b> A simple additive model</a></li>
<li class="chapter" data-level="12.4" data-path="flexible-models.html"><a href="flexible-models.html#inference-with-additive-models"><i class="fa fa-check"></i><b>12.4</b> Inference with additive models</a></li>
<li class="chapter" data-level="12.5" data-path="flexible-models.html"><a href="flexible-models.html#further-reading-5"><i class="fa fa-check"></i><b>12.5</b> Further reading</a></li>
<li class="chapter" data-level="12.6" data-path="flexible-models.html"><a href="flexible-models.html#exercises-10"><i class="fa fa-check"></i><b>12.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="flexible-models.html"><a href="flexible-models.html#fitting-a-p-spline-model"><i class="fa fa-check"></i><b>12.6.1</b> Fitting a p-spline model</a></li>
<li class="chapter" data-level="12.6.2" data-path="flexible-models.html"><a href="flexible-models.html#the-backfitting-algorithm"><i class="fa fa-check"></i><b>12.6.2</b> The backfitting algorithm</a></li>
<li class="chapter" data-level="12.6.3" data-path="flexible-models.html"><a href="flexible-models.html#water-quality-in-the-clyde-estuary"><i class="fa fa-check"></i><b>12.6.3</b> Water quality in the Clyde estuary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="models-for-time.html"><a href="models-for-time.html"><i class="fa fa-check"></i><b>13</b> Models for time</a>
<ul>
<li class="chapter" data-level="13.1" data-path="models-for-time.html"><a href="models-for-time.html#time-series-data"><i class="fa fa-check"></i><b>13.1</b> Time series data</a></li>
<li class="chapter" data-level="13.2" data-path="models-for-time.html"><a href="models-for-time.html#visualisation"><i class="fa fa-check"></i><b>13.2</b> Visualisation</a></li>
<li class="chapter" data-level="13.3" data-path="models-for-time.html"><a href="models-for-time.html#models"><i class="fa fa-check"></i><b>13.3</b> Models</a></li>
<li class="chapter" data-level="13.4" data-path="models-for-time.html"><a href="models-for-time.html#further-reading-6"><i class="fa fa-check"></i><b>13.4</b> Further reading</a></li>
<li class="chapter" data-level="13.5" data-path="models-for-time.html"><a href="models-for-time.html#exercises-11"><i class="fa fa-check"></i><b>13.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="models-for-time.html"><a href="models-for-time.html#simulating-time-series"><i class="fa fa-check"></i><b>13.5.1</b> Simulating time series</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="models-for-space.html"><a href="models-for-space.html"><i class="fa fa-check"></i><b>14</b> Models for space</a>
<ul>
<li class="chapter" data-level="14.1" data-path="models-for-space.html"><a href="models-for-space.html#visualising-spatial-data"><i class="fa fa-check"></i><b>14.1</b> Visualising spatial data</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="models-for-space.html"><a href="models-for-space.html#the-maps-package"><i class="fa fa-check"></i><b>14.1.1</b> The <code>maps</code> package</a></li>
<li class="chapter" data-level="14.1.2" data-path="models-for-space.html"><a href="models-for-space.html#leaflet-and-mapview-interactive-maps"><i class="fa fa-check"></i><b>14.1.2</b> <code>leaflet</code> and <code>mapview</code>: interactive maps</a></li>
<li class="chapter" data-level="14.1.3" data-path="models-for-space.html"><a href="models-for-space.html#ggplot-and-ggmap"><i class="fa fa-check"></i><b>14.1.3</b> <code>ggplot</code> and <code>ggmap</code></a></li>
<li class="chapter" data-level="14.1.4" data-path="models-for-space.html"><a href="models-for-space.html#tmap"><i class="fa fa-check"></i><b>14.1.4</b> <code>tmap</code></a></li>
<li class="chapter" data-level="14.1.5" data-path="models-for-space.html"><a href="models-for-space.html#spatstat-for-spatial-point-patterns"><i class="fa fa-check"></i><b>14.1.5</b> <code>spatstat</code> for spatial point patterns</a></li>
<li class="chapter" data-level="14.1.6" data-path="models-for-space.html"><a href="models-for-space.html#areal-data"><i class="fa fa-check"></i><b>14.1.6</b> Areal data</a></li>
<li class="chapter" data-level="14.1.7" data-path="models-for-space.html"><a href="models-for-space.html#image-data"><i class="fa fa-check"></i><b>14.1.7</b> Image data</a></li>
<li class="chapter" data-level="14.1.8" data-path="models-for-space.html"><a href="models-for-space.html#spatiotemporal-animation"><i class="fa fa-check"></i><b>14.1.8</b> Spatiotemporal animation</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="models-for-space.html"><a href="models-for-space.html#models-for-point-pattern-data"><i class="fa fa-check"></i><b>14.2</b> Models for point pattern data</a></li>
<li class="chapter" data-level="14.3" data-path="models-for-space.html"><a href="models-for-space.html#geostatistical-models"><i class="fa fa-check"></i><b>14.3</b> Geostatistical models</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="models-for-space.html"><a href="models-for-space.html#gaussian-processes"><i class="fa fa-check"></i><b>14.3.1</b> Gaussian processes</a></li>
<li class="chapter" data-level="14.3.2" data-path="models-for-space.html"><a href="models-for-space.html#geostatistical-models-1"><i class="fa fa-check"></i><b>14.3.2</b> Geostatistical models</a></li>
<li class="chapter" data-level="14.3.3" data-path="models-for-space.html"><a href="models-for-space.html#so2-a-model-based-on-smoothing"><i class="fa fa-check"></i><b>14.3.3</b> SO2: a model based on smoothing</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="models-for-space.html"><a href="models-for-space.html#models-for-areal-data"><i class="fa fa-check"></i><b>14.4</b> Models for areal data</a></li>
<li class="chapter" data-level="14.5" data-path="models-for-space.html"><a href="models-for-space.html#further-reading-7"><i class="fa fa-check"></i><b>14.5</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="experimental-design-revisited.html"><a href="experimental-design-revisited.html"><i class="fa fa-check"></i><b>15</b> Experimental design revisited</a>
<ul>
<li class="chapter" data-level="15.1" data-path="experimental-design-revisited.html"><a href="experimental-design-revisited.html#power"><i class="fa fa-check"></i><b>15.1</b> Power</a></li>
<li class="chapter" data-level="15.2" data-path="experimental-design-revisited.html"><a href="experimental-design-revisited.html#completely-randomised-design-comparing-several-treatments"><i class="fa fa-check"></i><b>15.2</b> Completely randomised design: comparing several treatments</a></li>
<li class="chapter" data-level="15.3" data-path="experimental-design-revisited.html"><a href="experimental-design-revisited.html#randomised-blocks-the-parable-of-the-sower"><i class="fa fa-check"></i><b>15.3</b> Randomised blocks: the parable of the sower</a></li>
<li class="chapter" data-level="15.4" data-path="experimental-design-revisited.html"><a href="experimental-design-revisited.html#factorial-designs-poisons-and-treatments"><i class="fa fa-check"></i><b>15.4</b> Factorial designs: poisons and treatments</a></li>
<li class="chapter" data-level="15.5" data-path="experimental-design-revisited.html"><a href="experimental-design-revisited.html#principles-of-experimental-design"><i class="fa fa-check"></i><b>15.5</b> Principles of experimental design</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="experimental-design-revisited.html"><a href="experimental-design-revisited.html#control"><i class="fa fa-check"></i><b>15.5.1</b> Control</a></li>
<li class="chapter" data-level="15.5.2" data-path="experimental-design-revisited.html"><a href="experimental-design-revisited.html#replicate"><i class="fa fa-check"></i><b>15.5.2</b> Replicate</a></li>
<li class="chapter" data-level="15.5.3" data-path="experimental-design-revisited.html"><a href="experimental-design-revisited.html#randomise"><i class="fa fa-check"></i><b>15.5.3</b> Randomise</a></li>
<li class="chapter" data-level="15.5.4" data-path="experimental-design-revisited.html"><a href="experimental-design-revisited.html#replication-and-pseudo-replication"><i class="fa fa-check"></i><b>15.5.4</b> Replication and Pseudo-Replication</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="experimental-design-revisited.html"><a href="experimental-design-revisited.html#exercises-12"><i class="fa fa-check"></i><b>15.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="experimental-design-revisited.html"><a href="experimental-design-revisited.html#student-cost-of-living"><i class="fa fa-check"></i><b>15.6.1</b> Student cost of living</a></li>
<li class="chapter" data-level="15.6.2" data-path="experimental-design-revisited.html"><a href="experimental-design-revisited.html#us-presidential-election-1936"><i class="fa fa-check"></i><b>15.6.2</b> US presidential election 1936</a></li>
<li class="chapter" data-level="15.6.3" data-path="experimental-design-revisited.html"><a href="experimental-design-revisited.html#the-parable-of-the-sower"><i class="fa fa-check"></i><b>15.6.3</b> The parable of the sower</a></li>
<li class="chapter" data-level="15.6.4" data-path="experimental-design-revisited.html"><a href="experimental-design-revisited.html#mururoa"><i class="fa fa-check"></i><b>15.6.4</b> Mururoa</a></li>
<li class="chapter" data-level="15.6.5" data-path="experimental-design-revisited.html"><a href="experimental-design-revisited.html#a-scottish-firth"><i class="fa fa-check"></i><b>15.6.5</b> A Scottish firth</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>V Statistical Models in Practice</b></span></li>
<li class="chapter" data-level="16" data-path="case-studies-of-statistical-modelling.html"><a href="case-studies-of-statistical-modelling.html"><i class="fa fa-check"></i><b>16</b> Case studies of statistical modelling</a>
<ul>
<li class="chapter" data-level="16.1" data-path="case-studies-of-statistical-modelling.html"><a href="case-studies-of-statistical-modelling.html#covid-19-initial-surveillance"><i class="fa fa-check"></i><b>16.1</b> Covid-19 initial surveillance</a></li>
<li class="chapter" data-level="16.2" data-path="case-studies-of-statistical-modelling.html"><a href="case-studies-of-statistical-modelling.html#uk-parliamentary-election-2024"><i class="fa fa-check"></i><b>16.2</b> UK parliamentary election 2024</a></li>
</ul></li>
<li class="part"><span><b>VI Other topics</b></span></li>
<li class="chapter" data-level="17" data-path="more-on-r.html"><a href="more-on-r.html"><i class="fa fa-check"></i><b>17</b> More on R</a>
<ul>
<li class="chapter" data-level="17.1" data-path="more-on-r.html"><a href="more-on-r.html#repetition"><i class="fa fa-check"></i><b>17.1</b> Repetition</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="more-on-r.html"><a href="more-on-r.html#standard-loops"><i class="fa fa-check"></i><b>17.1.1</b> Standard loops</a></li>
<li class="chapter" data-level="17.1.2" data-path="more-on-r.html"><a href="more-on-r.html#the-apply-family"><i class="fa fa-check"></i><b>17.1.2</b> The ‘apply’ family</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="more-on-r.html"><a href="more-on-r.html#writing-your-own-functions"><i class="fa fa-check"></i><b>17.2</b> Writing your own functions</a></li>
<li class="chapter" data-level="17.3" data-path="more-on-r.html"><a href="more-on-r.html#conditional-statements-and-while-loops"><i class="fa fa-check"></i><b>17.3</b> Conditional statements and <code>while</code> loops</a></li>
<li class="chapter" data-level="17.4" data-path="more-on-r.html"><a href="more-on-r.html#further-reading-8"><i class="fa fa-check"></i><b>17.4</b> Further reading</a></li>
<li class="chapter" data-level="17.5" data-path="more-on-r.html"><a href="more-on-r.html#exercises-13"><i class="fa fa-check"></i><b>17.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="more-on-r.html"><a href="more-on-r.html#a-simple-function"><i class="fa fa-check"></i><b>17.5.1</b> A simple function</a></li>
<li class="chapter" data-level="17.5.2" data-path="more-on-r.html"><a href="more-on-r.html#a-simple-function-thresholds"><i class="fa fa-check"></i><b>17.5.2</b> A simple function: thresholds</a></li>
<li class="chapter" data-level="17.5.3" data-path="more-on-r.html"><a href="more-on-r.html#improving-the-sim.max-function"><i class="fa fa-check"></i><b>17.5.3</b> Improving the sim.max function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Modelling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="flexible-models" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">12</span> Flexible models<a href="flexible-models.html#flexible-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>`</p>
<div id="flexible-methods" class="section level2 hasAnchor" number="12.1">
<h2><span class="header-section-number">12.1</span> Methods for constructing flexible models<a href="flexible-models.html#flexible-methods" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the previous lecture, some ways of constructing flexible (or ‘nonparametric’) regression curves were described. There are many ways of doing this. Here are some further possibilities.</p>
<div id="fitting-models-locally" class="section level3 hasAnchor" number="12.1.1">
<h3><span class="header-section-number">12.1.1</span> Fitting models locally<a href="flexible-models.html#fitting-models-locally" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="splines" class="section level3 hasAnchor" number="12.1.2">
<h3><span class="header-section-number">12.1.2</span> Splines<a href="flexible-models.html#splines" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In mathematics, a <em>spline</em> denotes a function <span class="math inline">\(g(x)\)</span> which is essentially a piecewise polynomial over an interval <span class="math inline">\((a, b)\)</span>, such that a certain number of its derivatives are continuous for all points of <span class="math inline">\((a, b)\)</span>. More precisely, <span class="math inline">\(g(x)\)</span> must satisfy the following properties. For some given positive integer <span class="math inline">\(r\)</span> and a sequence of points <span class="math inline">\(t_1,\ldots,t_k\)</span>, called <em>knots</em>, such that <span class="math inline">\(a&lt;t_1&lt;\ldots&lt;t_k&lt;b\)</span>, it is required that:</p>
<ul>
<li><span class="math inline">\(g(x)\)</span> has <span class="math inline">\(r-2\)</span> continuous derivatives;</li>
<li>the <span class="math inline">\((r-1)\)</span>th derivative of <span class="math inline">\(g(x)\)</span> is a step function with
jumps at <span class="math inline">\(t_1,\ldots,t_k\)</span>.</li>
</ul>
<p>Often <span class="math inline">\(r\)</span> is chosen to be <span class="math inline">\(3\)</span>, and the term <em>cubic spline</em> is then used for the associated curve.</p>
<p>In statistics, splines are used not for data interpolation, as in numerical analysis, but for data smoothing. Specifically, the quantity
<span class="math display">\[
  D = \sum_{i=1}^n \left(y_i - s(x_i) \right)^2 + \lambda \int_a^b s&#39;&#39;(x)^2 dx ,
\]</span>
where <span class="math inline">\(\lambda\)</span> is some positive constant, is used as an objective function in a minimisation problem with respect to the unknown regression function <span class="math inline">\(s(x)\)</span> on the basis of the data <span class="math inline">\((x_i, y_i)\)</span>.</p>
<p>The connection between <span class="math inline">\(D\)</span> and splines is that the mathematical function which minimises <span class="math inline">\(D\)</span> is a cubic spline, whose specific expression depends on the data and on the choice of <span class="math inline">\(\lambda\)</span>. If <span class="math inline">\(\lambda=0\)</span>, minimisation of <span class="math inline">\(D\)</span> corresponds to interpolation of the data, which is not a useful method of fitting the model, since the residuals are all set equal to <span class="math inline">\(0\)</span>. To avoid this, the second term in the expression of <span class="math inline">\(D\)</span> is then inserted as a <em>roughness penalty</em>.</p>
<p>The choice of <span class="math inline">\(\lambda\)</span> determines the relative weight attributed to the two terms, the residual sum of squares and the roughness penalty <span class="math inline">\(\int s&#39;&#39;(x)^2 dx\)</span>. Increasing <span class="math inline">\(\lambda\)</span> penalises fluctuations, and so produces a smoother curve. The term <em>penalised least squares</em> is then used in conjunction with <span class="math inline">\(D\)</span>. If <span class="math inline">\(\lambda\to\infty\)</span>, the second derivative is effectively constrained to be 0, and the outcome is then the least squares line. Hence, <span class="math inline">\(\lambda\)</span> plays a similar role to the smoothing parameter <span class="math inline">\(h\)</span> used in earlier sections.</p>
<p>The philosophy underlying this approach is an elegant and powerful one and it can be modified to apply to many other situations. Extensive discussions are given by Eubank (1988),
Wahba (1990), Green and Silverman (1994) and Wood (2017).</p>
<!-- ### Wavelets -->
<!-- Here, a doubly indexed family of functions $\{\psi_{jk}(x)\}$ leads to the representation of a function $s$ in the form  -->
<!-- $$ -->
<!--       f(x) = \sum_j \sum_k c_{jk} \psi_{jk}(x) , -->
<!-- $$ -->
<!-- where $c_{jk} = \int_\mathcal{R} f(x)\,\psi_{jk}(x) dx$ are the coefficients of the projection. -->
<!-- The novel feature is the use of particular functions, called *wavelets*, for the basis. These take the form -->
<!-- $$ -->
<!--       \psi_{jk}(x)= 2^{j/2} \psi(2^j x-k) -->
<!-- $$ -->
<!-- for some given function $\psi(x)$, called the *mother wavelet*, with additional requirements to ensure a basis is created. -->
<!-- The whole set of functions is therefore generated from the mother wavelet, by applying a scale and a shift transform. Clearly, the coefficients $c_{jk}$ must be estimated from the data and only a finite set of them is retained in the estimator. The number of $j$ indices considered for each given $k$ does not need to be constant. This fact, coupled with the special nature of the wavelet bases, where the index $k$ is associated with location and the index $j$ with frequency, allows variation in the degree of smoothness along the $x$ axis.  -->
<!-- The term *multiresolution analysis* is used in this context. This important and powerful feature is one of the principal reasons for the current research interest in this topic. -->
<!-- An accessible account of the wavelet approach is provided by Fan and Gijbels (1996, Section 2.5). -->
<p>Another way of estimating a smooth regression curve is to use a set of functions which provide a set of local building blocks. For example b-splines, which are made up on polynomial pieces, provide a convenient and efficient option. A curve estimate can then be produced by fitting the regression
<span class="math display">\[
     Y_i = \beta_0 + \beta_1 b_1(x_i) + \beta_2 b_2(x_i) + \ldots + \beta_p
              b_p(x_i) + \varepsilon_i ,
\]</span>
where the <span class="math inline">\(b_j\)</span> are the local b-spline functions. The <span class="math inline">\(b_j\)</span> are centred at different positions along a regular grid of <span class="math inline">\(x\)</span> values. This creates a regression problem of the usual form <span class="math inline">\(y = B \beta + \varepsilon\)</span>, where <span class="math inline">\(y\)</span> denotes the vector of response values, <span class="math inline">\(\beta\)</span> is a vector of unknown coefficients and <span class="math inline">\(B\)</span> is a matrix whose columns evaluate each basis function at the observed values of <span class="math inline">\(x\)</span> (with an initial column of 1’s, as usual, to deal with the intercept term). The solution <span class="math inline">\(\hat\beta = (B^TB)^{-1}B^Ty\)</span> arises from standard linear model theory.</p>
<p>Of course, one important question is how many basis functions should be used. An attractive solution is to use a large number of basis functions but to control the complexity, or smoothness, of the model through a penalty function, in the manner discussed in smoothing splines above. Eilers &amp; Marx (2020) describe this approach in detail. Rather than use the second derivative of the regression function as the basis of the penalty, there are advantages in penalising the sequence of coefficients through a term such as <span class="math inline">\(\lambda \sum_{j=2}^p (\beta_j - \beta_{j-1})^2\)</span>. Second-order differences can also be used and, indeed, that is a more common strategy. The penalised least squares problem then becomes to find <span class="math inline">\(\beta\)</span> to minimise
<span class="math display">\[
      (y - B\beta)^T(y - B \beta) + \lambda \beta^T D^T D \beta ,
\]</span>
where <span class="math inline">\(D\)</span> is a differencing matrix. This leads to the solution
<span class="math display">\[
      \hat\beta = (B^TB + \lambda P)^{-1}B^Ty
\]</span>
where <span class="math inline">\(P\)</span> denotes the penalty matrix <span class="math inline">\(D^TD\)</span>. This is referred to as a <em>p-spline</em> model.</p>
<p>If this estimate is written in the form <span class="math inline">\(\hat{y} = S y\)</span> then the concept of approximate degrees of freedom, discussed earlier as <span class="math inline">\(tr(S)\)</span>, can be applied. This gives a more intuitive scale of complexity. Specifying the degrees of freedom leads to a unique corresponding <span class="math inline">\(\lambda\)</span>. The earlier concept of cross-validation, or the general principal of AIC, can be applied to provide a more automatic proposal for the amount of smoothing applied.</p>
</div>
</div>
<div id="inference-with-simple-flexible-models" class="section level2 hasAnchor" number="12.2">
<h2><span class="header-section-number">12.2</span> Inference with simple flexible models<a href="flexible-models.html#inference-with-simple-flexible-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Historical data on Winter NAO data was discussed in Chapter on Trends and Patterns. If we fit a linear trend this is not significant. We can ask similar questions of the flexible regression: is there evidence of change of any kind?; is there evidence that this change is not linear? The flexible regression plots below display ‘reference bands’ which indicate where we expect the smooth curve to lie if indeed there is no trend at all, and in the second case if there is only linear trend. These graphical displays can be backed up by more formal methods which compare the sums-of-squares associated with the ‘no effect’, linear and smooth models. The calculation to produce p-values are a little more complex than in the standard case of linear models.</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="flexible-models.html#cb195-1" tabindex="-1"></a><span class="fu">library</span>(rpanel)</span>
<span id="cb195-2"><a href="flexible-models.html#cb195-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb195-3"><a href="flexible-models.html#cb195-3" tabindex="-1"></a><span class="fu">library</span>(sm)</span>
<span id="cb195-4"><a href="flexible-models.html#cb195-4" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="fu">rp.datalink</span>(<span class="st">&#39;NAO&#39;</span>)</span>
<span id="cb195-5"><a href="flexible-models.html#cb195-5" tabindex="-1"></a>NAO  <span class="ot">&lt;-</span> <span class="fu">read.table</span>(path, <span class="at">header =</span> <span class="cn">FALSE</span>, <span class="at">skip =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb195-6"><a href="flexible-models.html#cb195-6" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">Year =</span> <span class="dv">1</span>, <span class="at">NAO =</span> <span class="dv">2</span>)</span>
<span id="cb195-7"><a href="flexible-models.html#cb195-7" tabindex="-1"></a><span class="fu">ggplot</span>(NAO, <span class="fu">aes</span>(Year, NAO)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>)</span>
<span id="cb195-8"><a href="flexible-models.html#cb195-8" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(NAO <span class="sc">~</span> Year, <span class="at">data =</span> NAO))<span class="sc">$</span>coefficients</span>
<span id="cb195-9"><a href="flexible-models.html#cb195-9" tabindex="-1"></a><span class="fu">ggplot</span>(NAO, <span class="fu">aes</span>(Year, NAO)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>()</span>
<span id="cb195-10"><a href="flexible-models.html#cb195-10" tabindex="-1"></a><span class="fu">sm.regression</span>(NAO<span class="sc">$</span>Year, NAO<span class="sc">$</span>NAO, <span class="at">model =</span> <span class="st">&#39;no effect&#39;</span>)</span>
<span id="cb195-11"><a href="flexible-models.html#cb195-11" tabindex="-1"></a><span class="fu">sm.regression</span>(NAO<span class="sc">$</span>Year, NAO<span class="sc">$</span>NAO, <span class="at">model =</span> <span class="st">&#39;linear&#39;</span>)</span></code></pre></div>
<pre><code>##                  Estimate  Std. Error   t value   Pr(&gt;|t|)
## (Intercept) -10.812202830 6.469981059 -1.671134 0.09667481
## Year          0.005689807 0.003328096  1.709628 0.08929780
## Test of no effect model:  significance =  0.015 
## Test of linear model:  significance =  0.026</code></pre>
<p><img src="book_files/figure-html/NAO_flexible_inference-1.png" width="49%" /><img src="book_files/figure-html/NAO_flexible_inference-2.png" width="49%" /><img src="book_files/figure-html/NAO_flexible_inference-3.png" width="49%" /><img src="book_files/figure-html/NAO_flexible_inference-4.png" width="49%" /></p>
<!-- Put the `hyde` data into an exercise. -->
<!-- ```{r hyde_regression_all, message = FALSE, results = 'hold', out.width = '33%', fig.align = 'none'} -->
<!-- path <- rp.datalink("hyde") -->
<!-- hyde <- read.table(path, header = TRUE) -->
<!-- ind  <- rep(1:nrow(hyde), hyde$Frequency) -->
<!-- hyde <- hyde[ind, 1:2] -->
<!-- library(sm) -->
<!-- sm.regression(hyde$Father, hyde$Child, model = "no effect", -->
<!--               eval.points = 20:60) -->
<!-- sbst <- subset(hyde, Child > 9) -->
<!-- sm.regression(sbst$Father, sbst$Child, model = "no effect", -->
<!--               eval.points = 20:60) -->
<!-- sbst <- subset(hyde, Child < 10) -->
<!-- sm.regression(sbst$Father, sbst$Child, model = "no effect", -->
<!--               eval.points = 20:60) -->
<!-- ``` -->
<!-- Possible discussion of the few unusually large father's ages and the influence on the curve estimate and the se. -->
</div>
<div id="a-simple-additive-model" class="section level2 hasAnchor" number="12.3">
<h2><span class="header-section-number">12.3</span> A simple additive model<a href="flexible-models.html#a-simple-additive-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that we have tools available to estimate smooth curves and surfaces, linear regression models can be extended to <em>additive models</em> as
<span class="math display">\[
        y_i = \beta_0 + s_1(x_{1i}) + \ldots + s_p(x_{pi}) + \varepsilon_i,
                        \hspace{15mm}   i=1, \dots , n.
\]</span>
The <span class="math inline">\(m_i\)</span> are functions whose shapes are unrestricted, apart from an assumption of smoothness and the constraint, for identifiability, that <span class="math inline">\(\sum_i s_{j}(x_{ji}) = 0\)</span> for each <span class="math inline">\(j\)</span>. As a consequence, we usually estimate <span class="math inline">\(\beta_0\)</span> by <span class="math inline">\(\bar{y}\)</span>. This gives a very flexible set of modelling tools.</p>
<p>To see one approach to how these models can be fitted, consider the case of only two covariates,
<span class="math display">\[
        y_i = \beta_0 + s_1(x_{1i}) + s_2(x_{2i}) + \varepsilon_i,
                        \hspace{1.5cm}   i=1, \dots , n.
\]</span>
A rearrangement of this as <span class="math inline">\(y_i - \beta_0 - s_2(x_{2i}) = s_1(x_{1i}) + \varepsilon_i\)</span> suggests that an estimate of component <span class="math inline">\(m_1\)</span> can then be obtained by smoothing the
residuals of the data after fitting <span class="math inline">\(\hat{s}_2\)</span>,
<span class="math display">\[
        \hat{m}_1 = S_1 (y - \bar{y} - \hat{s}_2)
\]</span>
and that, similarly, subsequent estimates of <span class="math inline">\(s_2\)</span> can be obtained as
<span class="math display">\[
        \hat{m}_2 = S_2 (y - \bar{y} - \hat{s}_1) .
\]</span>
These smoothing operations are repeated until convergence. This is called the <em>backfitting algorithm</em>.</p>
<p>However, the regression and p-spline approaches described above allow models to be fitted directly. Each term <span class="math inline">\(s_1, s_2, \ldots\)</span> can be represented by its own set of basis functions to create the usual linear model form <span class="math inline">\(y = B \beta\)</span>, where <span class="math inline">\(\beta\)</span> now denotes a collections of several sets of coefficients, one for each term, and the columns of <span class="math inline">\(B\)</span> similarly cover the basis functions for all terms in the model. Combined with a set of penalty matrices and associated penalty parameters, the direct solution <span class="math inline">\(\hat\beta = (B^TB + P)^{-1}B^Ty\)</span> still applies, where <span class="math inline">\(P\)</span> now denotes the sum of the individual penalty matrices weighted by their associated penalty parameters.</p>
<p>Here is an example of an additive model fitted to the trawl data. This uses the <code>gam</code> function in the <code>mgcv</code> package in <code>R</code>, which is a very powerful set of tools comprehensively described by Wood (2017). There are many options for how the model is fitted but here we will simply accept the defaults.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="flexible-models.html#cb197-1" tabindex="-1"></a><span class="fu">library</span>(sm)</span>
<span id="cb197-2"><a href="flexible-models.html#cb197-2" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb197-3"><a href="flexible-models.html#cb197-3" tabindex="-1"></a><span class="fu">library</span>(gratia)</span>
<span id="cb197-4"><a href="flexible-models.html#cb197-4" tabindex="-1"></a>ind         <span class="ot">&lt;-</span> (trawl<span class="sc">$</span>Year<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> trawl<span class="sc">$</span>Zone<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb197-5"><a href="flexible-models.html#cb197-5" tabindex="-1"></a>trawl.model <span class="ot">&lt;-</span> <span class="fu">gam</span>(Score1 <span class="sc">~</span> <span class="fu">s</span>(Latitude) <span class="sc">+</span> <span class="fu">s</span>(Longitude), <span class="at">data =</span> trawl, <span class="at">subset =</span> ind)</span>
<span id="cb197-6"><a href="flexible-models.html#cb197-6" tabindex="-1"></a><span class="fu">draw</span>(trawl.model, <span class="at">residuals =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-801-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>The non-linear effect of Longitude is apparent, as we saw in earlier examples. Here the model selection methods included in <code>mgcv</code> have led to a proposed linear relationship with Latitude.</p>
</div>
<div id="inference-with-additive-models" class="section level2 hasAnchor" number="12.4">
<h2><span class="header-section-number">12.4</span> Inference with additive models<a href="flexible-models.html#inference-with-additive-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>While models of this type provide very flexible and visually informative descriptions of the data, it is also necessary to consider how models can be compared and inferences drawn. Although we are outside the strict realm of a standard linear model, as a result of the smoothness constraints, we generally proceed by analogy with the linear model.</p>
<p>For an additive model, the residual sum-of-squares can easily be defined as
<span class="math display">\[
        \mbox{RSS} = \sum_{i=1}^n (y_i - \hat{y}_i)^2,
\]</span>
where <span class="math inline">\(\hat{y}_i\)</span> denotes the fitted value, produced by evaluating the additive model at the observation <span class="math inline">\(x_i\)</span>. We can write the residual sum-of-squares as
<span class="math display">\[
        \mbox{RSS} = \sum_{i=1}^n (y_i - \hat{y}_i)^2 = y^T (I-S)^T (I-S) y,
\]</span>
where <span class="math inline">\(S\)</span> denotes the projection matrix discussed earlier. The approximate degrees of freedom for error can be defined as
<span class="math display">\[
   \mbox{df} = \mbox{tr}\{(I-S)^T (I-S)\} .
\]</span></p>
<p>In an obvious notation, comparisons of two models can expressed quantitatively in
<span class="math display">\[
        F = \frac{(\mbox{RSS}_2-\mbox{RSS}_1) / (\mbox{df}_2-\mbox{df}_1)}
                 {\mbox{RSS}_1 / \mbox{df}_1} ,
                                \label{eq:add_F}
\]</span>
by analogy with the <span class="math inline">\(F\)</span>-statistic used to compare linear models. Unfortunately, this analogy does not extend to distributional calculations and no general expression for the distribution of the F-statistic is available. However, Hastie &amp; Tibshirani (1990; sections 3.9 and 6.8) suggest that at least some approximate guidance can be given by referring the observed nonparametric <span class="math inline">\(F\)</span>-statistic to an F distribution with <span class="math inline">\((\mbox{df}_2-\mbox{df}_1)\)</span> and <span class="math inline">\(\mbox{df}_1\)</span> degrees of freedom.</p>
<p>A different approach is to examine whether particular groups of coefficients in the regression spline, for example those associated with the building blocks for a particular term in the additive model, might all be zero. The details of this are comprehensively discussed in Wood (2017) and this is the approach implemented in <code>mgcv</code>.</p>
<p>The reef data provide a simple illustration of how model comparisons may be made. The table below indicates that both Latitude and Longitude show significant effects on the catch score.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="flexible-models.html#cb198-1" tabindex="-1"></a>  <span class="fu">summary</span>(trawl.model)<span class="sc">$</span>s.table</span></code></pre></div>
<pre><code>##                   edf   Ref.df         F     p-value
## s(Latitude)  1.000000 1.000000  9.648493 0.003879748
## s(Longitude) 7.023069 8.064042 26.768506 0.000000000</code></pre>
<p>Is the additive model sufficient or do we need an interaction term (which would simply create a smooth surface over Latitude and Longitude simultaneously)? We can examine that by adding an interaction term. The evidence for its presence is not convincing.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="flexible-models.html#cb200-1" tabindex="-1"></a>ind         <span class="ot">&lt;-</span> (trawl<span class="sc">$</span>Year<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> trawl<span class="sc">$</span>Zone<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb200-2"><a href="flexible-models.html#cb200-2" tabindex="-1"></a>trawl.model1 <span class="ot">&lt;-</span> <span class="fu">gam</span>(Score1 <span class="sc">~</span> <span class="fu">s</span>(Latitude) <span class="sc">+</span> <span class="fu">s</span>(Longitude) <span class="sc">+</span> <span class="fu">ti</span>(Latitude, Longitude),</span>
<span id="cb200-3"><a href="flexible-models.html#cb200-3" tabindex="-1"></a>                    <span class="at">data =</span> trawl, <span class="at">subset =</span> ind)</span>
<span id="cb200-4"><a href="flexible-models.html#cb200-4" tabindex="-1"></a><span class="fu">summary</span>(trawl.model1)<span class="sc">$</span>s.table</span></code></pre></div>
<pre><code>##                             edf   Ref.df         F   p-value
## s(Latitude)            1.000000 1.000000  6.213004 0.0196678
## s(Longitude)           7.799202 8.444384 23.363779 0.0000000
## ti(Latitude,Longitude) 6.972077 8.728649  1.154443 0.3665392</code></pre>
<!-- ## Example: mackerel eggs -->
<!-- ```{r child = 'chapters/flexible_models/example_mackerel_eggs.Rmd'} -->
<!-- ``` -->
<!-- ## Generalised additive models -->
<!-- ```{r child = 'chapters/flexible_models/generalised_additive.Rmd'} -->
<!-- ``` -->
</div>
<div id="further-reading-5" class="section level2 hasAnchor" number="12.5">
<h2><span class="header-section-number">12.5</span> Further reading<a href="flexible-models.html#further-reading-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Bowman, A.W. &amp; Azzalini, A. (1996).
<em>Applied Smoothing Techniques for Data Analysis.</em>
OUP: Oxford.</p>
<p>Green, P.J. and Silverman, B.W. (1994).
<em>Nonparametric Regression and Generalized Linear Models: A Roughness Penalty Approach</em>.
Chapman &amp; Hall: London.</p>
<p>Hastie, T. and Tibshirani, R. (1990).
<em>Generalized Additive Models</em>.
Chapman &amp; Hall: London.</p>
<p>Eubank, R.L. (1999)<br />
<em>Nonparametric regression and spline smoothing</em>.
Marcel Dekker, New York.</p>
<p>Wood, S. (2017).
<em>Generalized additive models: an introduction with R</em>.
2nd edition. Chapman &amp; Hall/CRC, London.</p>
<p>Eilers, P.H.C. and Marx, B.D. (2020).
<em>Practical Smoothing: the joy of p-splines.</em>
Cambridge University Press.</p>
<!-- ```{r child = 'material/flexible_regression/flexible_models_brief.Rmd'} -->
<!-- ``` -->
</div>
<div id="exercises-10" class="section level2 hasAnchor" number="12.6">
<h2><span class="header-section-number">12.6</span> Exercises<a href="flexible-models.html#exercises-10" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="fitting-a-p-spline-model" class="section level3 hasAnchor" number="12.6.1">
<h3><span class="header-section-number">12.6.1</span> Fitting a p-spline model<a href="flexible-models.html#fitting-a-p-spline-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Verify the solution given earlier for the value of <span class="math inline">\(\beta\)</span> which minimises the p-splines criterion
<span class="math display">\[
      (y - B\beta)^T(y - B \beta) + \lambda \beta^T D^T D \beta ,
\]</span></p>
</div>
<div id="the-backfitting-algorithm" class="section level3 hasAnchor" number="12.6.2">
<h3><span class="header-section-number">12.6.2</span> The backfitting algorithm<a href="flexible-models.html#the-backfitting-algorithm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>sm.regression</code> function in the <code>sm</code> package estimates a flexible regression curve for a single covariate and a response variables. (You can use any other function which does the same thing, if you prefer.) Write code which implements the backfitting algorithm, discussed earlier, and apply this to an additive model which relates <code>Score1</code> to <code>Latitude</code> and <code>Longitude</code> in the <code>trawl</code> data.</p>
<p>You will need a convergence criterion. You might simply use a small proportionate change in the fitted values.</p>
<p>You will need to consult the help file for <code>sm.regression</code> to see what arguments are required and what is returned by the function.</p>
</div>
<div id="water-quality-in-the-clyde-estuary" class="section level3 hasAnchor" number="12.6.3">
<h3><span class="header-section-number">12.6.3</span> Water quality in the Clyde estuary<a href="flexible-models.html#water-quality-in-the-clyde-estuary" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>R</code> instructions below will read a dataset containing measurements of dissolved oxygen (DO) in the River Clyde and then create a dataframe <code>clyde4</code> containing a subset for a particular sampling location.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="flexible-models.html#cb202-1" tabindex="-1"></a>  path <span class="ot">&lt;-</span> <span class="fu">rp.datalink</span>(<span class="st">&quot;DO_Clyde&quot;</span>)</span>
<span id="cb202-2"><a href="flexible-models.html#cb202-2" tabindex="-1"></a>  <span class="fu">load</span>(path)</span>
<span id="cb202-3"><a href="flexible-models.html#cb202-3" tabindex="-1"></a>  clyde4  <span class="ot">&lt;-</span> <span class="fu">subset</span>(clyde, Station <span class="sc">==</span> <span class="dv">4</span>)</span></code></pre></div>
<p>Use the <code>gam</code> function in <code>mgcv</code> to fit an additive model which relates <code>DO</code> to the covariates <code>Year</code>, <code>Temperature</code> and <code>Salinity</code>. Comment on what the fitted modell tells you about these relationships.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="models-with-random-effects.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="models-for-time.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["book.pdf", "book.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
