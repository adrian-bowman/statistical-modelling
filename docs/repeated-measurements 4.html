<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1.4 Repeated measurements | Statistical Modelling</title>
  <meta name="description" content="A conceptual, visual and practical introduction to statistical modelling" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="1.4 Repeated measurements | Statistical Modelling" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A conceptual, visual and practical introduction to statistical modelling" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1.4 Repeated measurements | Statistical Modelling" />
  
  <meta name="twitter:description" content="A conceptual, visual and practical introduction to statistical modelling" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="inference-with-mixed-models.html"/>
<link rel="next" href="case-studies-of-mixed-models.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A visual and conceptual introduction to statistical modelling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface: whatâ€™s the problem?</a></li>
<li class="chapter" data-level="1" data-path="models-with-random-effects.html"><a href="models-with-random-effects.html"><i class="fa fa-check"></i><b>1</b> Models with random effects</a>
<ul>
<li class="chapter" data-level="1.1" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>1.1</b> Examples</a></li>
<li class="chapter" data-level="1.2" data-path="formulating-and-fitting-mixed-effects-models.html"><a href="formulating-and-fitting-mixed-effects-models.html"><i class="fa fa-check"></i><b>1.2</b> Formulating and fitting mixed effects models</a></li>
<li class="chapter" data-level="1.3" data-path="inference-with-mixed-models.html"><a href="inference-with-mixed-models.html"><i class="fa fa-check"></i><b>1.3</b> Inference with mixed models</a></li>
<li class="chapter" data-level="1.4" data-path="repeated-measurements.html"><a href="repeated-measurements.html"><i class="fa fa-check"></i><b>1.4</b> Repeated measurements</a></li>
<li class="chapter" data-level="1.5" data-path="case-studies-of-mixed-models.html"><a href="case-studies-of-mixed-models.html"><i class="fa fa-check"></i><b>1.5</b> Case studies of mixed models</a></li>
<li class="chapter" data-level="1.6" data-path="non-linear-mixed-models.html"><a href="non-linear-mixed-models.html"><i class="fa fa-check"></i><b>1.6</b> Non-linear mixed models</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="non-linear-mixed-models.html"><a href="non-linear-mixed-models.html#indomethacin-kinetics"><i class="fa fa-check"></i><b>1.6.1</b> Indomethacin kinetics</a></li>
<li class="chapter" data-level="1.6.2" data-path="non-linear-mixed-models.html"><a href="non-linear-mixed-models.html#growth-of-soyabean-plants"><i class="fa fa-check"></i><b>1.6.2</b> Growth of Soyabean plants</a></li>
<li class="chapter" data-level="1.6.3" data-path="non-linear-mixed-models.html"><a href="non-linear-mixed-models.html#phenobarbital-kinetics"><i class="fa fa-check"></i><b>1.6.3</b> Phenobarbital kinetics</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="generalised-linear-mixed-models.html"><a href="generalised-linear-mixed-models.html"><i class="fa fa-check"></i><b>1.7</b> Generalised linear mixed models</a></li>
<li class="chapter" data-level="1.8" data-path="further-reading.html"><a href="further-reading.html"><i class="fa fa-check"></i><b>1.8</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Modelling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="repeated-measurements" class="section level2 hasAnchor" number="1.4">
<h2><span class="header-section-number">1.4</span> Repeated measurements<a href="repeated-measurements.html#repeated-measurements" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In many experiments there is interest in understanding how things change over time. It is natural that each experimental unit (patient, animal, specimen) is measured repeatedly over time. This leads to a <em>repeated measurements</em> structure. A random effects model can be used to recognise that each individual has their own (random) characteristics which they carry with them throughout the series of repeated measurements.</p>
<p>The plot below show the Clyde data on <code>DO</code> plotted against <code>Station</code> with each survey of the river on a particular date given a unique identifier. (Recall the <code>Year</code> is on a continuous scale with individual days identified by where they sit on a proportional scale.) Although this does not involve time, it still represents a repeated measurement structure.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="repeated-measurements.html#cb1-1" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="fu">rp.datalink</span>(<span class="st">&quot;DO_Clyde&quot;</span>)</span>
<span id="cb1-2"><a href="repeated-measurements.html#cb1-2" tabindex="-1"></a><span class="fu">load</span>(path)</span>
<span id="cb1-3"><a href="repeated-measurements.html#cb1-3" tabindex="-1"></a>clyde <span class="ot">&lt;-</span> <span class="fu">mutate</span>(clyde, <span class="at">id =</span> <span class="fu">factor</span>(Year), <span class="at">Station =</span> <span class="fu">factor</span>(Station))</span>
<span id="cb1-4"><a href="repeated-measurements.html#cb1-4" tabindex="-1"></a><span class="fu">ggplot</span>(clyde, <span class="fu">aes</span>(Station, DO, <span class="at">group =</span> id, <span class="at">col =</span> <span class="fu">factor</span>(id))) <span class="sc">+</span></span>
<span id="cb1-5"><a href="repeated-measurements.html#cb1-5" tabindex="-1"></a>   <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="book_files/figure-html/clyde_repeated_measurements-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>A simple model uses the covariates identified in our earlier work with <code>Station</code> added as a factor and with a random effect for each survey of the river. Close inspection of the plot may give us some cause for concern as the residuals seem to be systematically low at very low and very high fitted values. We will explore more sophisticated models later. Nonetheless this simple provides a first assessment of the nature and size of the different effects at work.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="repeated-measurements.html#cb2-1" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb2-2"><a href="repeated-measurements.html#cb2-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lmer</span>(DO <span class="sc">~</span> Year <span class="sc">+</span> Temperature <span class="sc">+</span> Salinity <span class="sc">+</span> Station <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>id), <span class="at">data =</span> clyde)</span>
<span id="cb2-3"><a href="repeated-measurements.html#cb2-3" tabindex="-1"></a><span class="fu">plot</span>(model)</span></code></pre></div>
<p><img src="book_files/figure-html/clyde_repeated_measurements_model-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="repeated-measurements.html#cb3-1" tabindex="-1"></a><span class="fu">summary</span>(model)<span class="sc">$</span>coefficients</span></code></pre></div>
<pre><code>##                  Estimate   Std. Error       t value
## (Intercept) -1.984023e+02 34.427070403  -5.762973610
## Year         1.073006e-01  0.017359427   6.181113422
## Temperature -6.080901e-01  0.019789679 -30.727639400
## Salinity    -6.403902e-02  0.009979926  -6.416782871
## Station2    -1.162670e-01  0.132708986  -0.876104804
## Station4    -1.005766e+00  0.134251053  -7.491677866
## Station6    -1.246029e+00  0.135887367  -9.169572462
## Station8    -1.634330e+00  0.138578921 -11.793499816
## Station10   -1.808147e+00  0.142454530 -12.692803140
## Station12   -1.917212e+00  0.149310252 -12.840460726
## Station14   -1.206095e+00  0.155097752  -7.776353773
## Station16   -7.994754e-01  0.173955255  -4.595867884
## Station18   -1.967655e-03  0.197033609  -0.009986393
## Station20    6.864268e-01  0.235454384   2.915328268
## Station22    1.465074e+00  0.288116720   5.085001178
## Station24    2.193303e+00  0.307531331   7.131965182</code></pre>
<hr />
<blockquote>
<p><strong>Example: Leutinizing Hormone Levels in Cows</strong><br />
An experiment was carried out to compare the concentrations of leutinizing hormone (LH) in 16 suckled and 16 nonsuckled cows. Measurements were made daily from day 1 through to day 4 postpartum, and twice daily from day 5 through to day 10 postpartum. The cows were ovariectomised on day 5 postpartum.</p>
<p>Source: Raz(1989), Biometrics 54, 851-71.<br />
The data are available in the dataframe <code>luthor</code> in the <code>rpanel</code> package.</p>
</blockquote>
<hr />
<p>The data are in â€˜blockâ€™ form so we need to reorganise them into long vectors in order to make use of later modelling functions.</p>
<!-- ```{r} -->
<!--   library(rpanel) -->
<!--   head(luthor) -->
<!-- ``` -->
<p>The <code>gather</code> function (in the <code>tidyr</code> package) handles the details for us. First we give the dataframe variables names and then we create an <code>id</code> variable so that we can keep track of which animal each measurement comes from. The <code>key</code> argument gives a name to the variable which will index the long vector of measurements and the <code>value</code> argument names the long vector. The remaining argument specifies the columns from which the long vector is made.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="repeated-measurements.html#cb5-1" tabindex="-1"></a>  <span class="fu">library</span>(tidyverse)</span>
<span id="cb5-2"><a href="repeated-measurements.html#cb5-2" tabindex="-1"></a>  <span class="fu">names</span>(luthor) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;gp&quot;</span>, <span class="fu">as.character</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, (<span class="dv">5</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">/</span> <span class="dv">2</span>))))</span>
<span id="cb5-3"><a href="repeated-measurements.html#cb5-3" tabindex="-1"></a>  luthor<span class="sc">$</span>id     <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(luthor)</span>
<span id="cb5-4"><a href="repeated-measurements.html#cb5-4" tabindex="-1"></a>  luthor.tidy   <span class="ot">&lt;-</span> <span class="fu">gather</span>(luthor, <span class="at">key =</span> <span class="st">&quot;times&quot;</span>, <span class="at">value =</span> <span class="st">&quot;luthor&quot;</span>, <span class="dv">2</span><span class="sc">:</span><span class="dv">16</span>)</span>
<span id="cb5-5"><a href="repeated-measurements.html#cb5-5" tabindex="-1"></a>  <span class="fu">glimpse</span>(luthor.tidy)</span></code></pre></div>
<pre><code>## Rows: 480
## Columns: 4
## $ gp     &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, â€¦
## $ id     &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, â€¦
## $ times  &lt;chr&gt; &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;â€¦
## $ luthor &lt;dbl&gt; 0.516, 0.367, 0.471, 0.450, 0.709, 0.273, 0.346, 0.261, 0.433, â€¦</code></pre>
<p>A plot of the â€˜repeated measurementsâ€™ over time immediately suggests that a transformation to the log scale might be helpful.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="repeated-measurements.html#cb7-1" tabindex="-1"></a><span class="fu">ggplot</span>(luthor.tidy,</span>
<span id="cb7-2"><a href="repeated-measurements.html#cb7-2" tabindex="-1"></a>  <span class="fu">aes</span>(times, luthor, <span class="at">group =</span> id, <span class="at">col =</span> <span class="fu">factor</span>(gp))) <span class="sc">+</span></span>
<span id="cb7-3"><a href="repeated-measurements.html#cb7-3" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span>
<span id="cb7-4"><a href="repeated-measurements.html#cb7-4" tabindex="-1"></a><span class="fu">ggplot</span>(luthor.tidy,</span>
<span id="cb7-5"><a href="repeated-measurements.html#cb7-5" tabindex="-1"></a>  <span class="fu">aes</span>(times, <span class="fu">log</span>(luthor), <span class="at">group =</span> id, <span class="at">col =</span> <span class="fu">factor</span>(gp))) <span class="sc">+</span></span>
<span id="cb7-6"><a href="repeated-measurements.html#cb7-6" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-32-1.png" width="49%" /><img src="book_files/figure-html/unnamed-chunk-32-2.png" width="49%" /></p>
<p>It is also useful to plot summaries such as means and (2) standard errors to see the underlying patterns. We will move to the convenient function <code>rp.rmplot</code> from the <code>rpanel</code> package to do this. In the third plot below the shaded area has width two standard errors of the <em>difference</em> between the means at each time point. This helpfully highlights evidence for differences in the two mean trajectories, in an informal manner.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="repeated-measurements.html#cb8-1" tabindex="-1"></a>LH    <span class="ot">&lt;-</span> luthor[,<span class="dv">2</span><span class="sc">:</span><span class="dv">16</span>]</span>
<span id="cb8-2"><a href="repeated-measurements.html#cb8-2" tabindex="-1"></a>gp    <span class="ot">&lt;-</span> <span class="fu">factor</span>(luthor[,<span class="dv">1</span>])</span>
<span id="cb8-3"><a href="repeated-measurements.html#cb8-3" tabindex="-1"></a>times <span class="ot">&lt;-</span> times <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,(<span class="dv">5</span><span class="sc">+</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb8-4"><a href="repeated-measurements.html#cb8-4" tabindex="-1"></a><span class="fu">rp.rmplot</span>(<span class="fu">log</span>(LH), <span class="at">id =</span> id, <span class="at">fac =</span> gp, <span class="at">timept =</span> times, <span class="at">type =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb8-5"><a href="repeated-measurements.html#cb8-5" tabindex="-1"></a>          <span class="at">panel =</span> <span class="cn">FALSE</span>)</span>
<span id="cb8-6"><a href="repeated-measurements.html#cb8-6" tabindex="-1"></a><span class="fu">rp.rmplot</span>(<span class="fu">log</span>(LH), <span class="at">id =</span> id, <span class="at">fac =</span> gp, <span class="at">timept =</span> times, <span class="at">type =</span> <span class="st">&quot;mean+bar&quot;</span>,</span>
<span id="cb8-7"><a href="repeated-measurements.html#cb8-7" tabindex="-1"></a>          <span class="at">panel =</span> <span class="cn">FALSE</span>)</span>
<span id="cb8-8"><a href="repeated-measurements.html#cb8-8" tabindex="-1"></a><span class="fu">rp.rmplot</span>(<span class="fu">log</span>(LH), <span class="at">id =</span> id, <span class="at">fac =</span> gp, <span class="at">timept =</span> times, <span class="at">type =</span> <span class="st">&quot;band&quot;</span>,</span>
<span id="cb8-9"><a href="repeated-measurements.html#cb8-9" tabindex="-1"></a>          <span class="at">panel =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-33-1.png" width="32%" /><img src="book_files/figure-html/unnamed-chunk-33-2.png" width="32%" /><img src="book_files/figure-html/unnamed-chunk-33-3.png" width="32%" /></p>
<p>For a proper analysis, a model is required. It is clear that we need a time effect and a group effect, and possibly an interaction. This can be written as
<span class="math display">\[
      y_{ijk} = \mu + g_i + t_k + (gt)_{ik} + a_{ij} + \varepsilon_{ijk},
\]</span>
where <span class="math inline">\(i\)</span> refers to group, <span class="math inline">\(j\)</span> to animal within the group and <span class="math inline">\(k\)</span> to time point. Notice the additional term <span class="math inline">\(a_{ij}\)</span> which represents a `level shiftâ€™, above or below the mean, associated with animal <span class="math inline">\(j\)</span> in group <span class="math inline">\(i\)</span>. This level shift appears for all the measurements over time for this animal. It is assumed to be a normal random variable with mean <span class="math inline">\(0\)</span>. The model parameter associated with this term is the standard deviation of this random level shift.</p>
<p>The advantage of this model is that it gives a more realistic description of how the data have been generated. In particular, it should make a better job of capturing the structure of the random variation present. That means that the standard errors of the group and time effects will be more realistic than a model which assumes all the variation is simply independent added noise.</p>
<p>Main effects and their interaction from the fitted model are shown in the summary below.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="repeated-measurements.html#cb9-1" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb9-2"><a href="repeated-measurements.html#cb9-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lme</span>(<span class="fu">log</span>(luthor) <span class="sc">~</span> times <span class="sc">*</span> gp, <span class="at">random =</span> <span class="sc">~</span> <span class="dv">1</span><span class="sc">|</span>id, <span class="at">data =</span> luthor.tidy)</span>
<span id="cb9-3"><a href="repeated-measurements.html#cb9-3" tabindex="-1"></a><span class="fu">anova</span>(model, <span class="at">type =</span> <span class="st">&quot;marginal&quot;</span>)</span></code></pre></div>
<pre><code>##             numDF denDF   F-value p-value
## (Intercept)     1   420 13.164260  0.0003
## times          14   420  3.484231  &lt;.0001
## gp              1    30  0.164824  0.6876
## times:gp       14   420  1.516862  0.1014</code></pre>
<p>The interaction is not significant, suggesting that the evidence for the shape of the mean trajectories being different is not convincing. However, we have treated <code>time</code> as a factor, assuming no connection between the mean responses at each time point. Perhaps we should investigate a model which describes the evolution over time through a smooth, non-linear curve of some kind.</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="inference-with-mixed-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="case-studies-of-mixed-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["book.pdf", "book.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
