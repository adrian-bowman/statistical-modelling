<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1.5 Case studies of mixed models | Statistical Modelling</title>
  <meta name="description" content="A conceptual, visual and practical introduction to statistical modelling" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="1.5 Case studies of mixed models | Statistical Modelling" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A conceptual, visual and practical introduction to statistical modelling" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1.5 Case studies of mixed models | Statistical Modelling" />
  
  <meta name="twitter:description" content="A conceptual, visual and practical introduction to statistical modelling" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="repeated-measurements.html"/>
<link rel="next" href="non-linear-mixed-models.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A visual and conceptual introduction to statistical modelling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface: what’s the problem?</a></li>
<li class="chapter" data-level="1" data-path="models-with-random-effects.html"><a href="models-with-random-effects.html"><i class="fa fa-check"></i><b>1</b> Models with random effects</a>
<ul>
<li class="chapter" data-level="1.1" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>1.1</b> Examples</a></li>
<li class="chapter" data-level="1.2" data-path="formulating-and-fitting-mixed-effects-models.html"><a href="formulating-and-fitting-mixed-effects-models.html"><i class="fa fa-check"></i><b>1.2</b> Formulating and fitting mixed effects models</a></li>
<li class="chapter" data-level="1.3" data-path="inference-with-mixed-models.html"><a href="inference-with-mixed-models.html"><i class="fa fa-check"></i><b>1.3</b> Inference with mixed models</a></li>
<li class="chapter" data-level="1.4" data-path="repeated-measurements.html"><a href="repeated-measurements.html"><i class="fa fa-check"></i><b>1.4</b> Repeated measurements</a></li>
<li class="chapter" data-level="1.5" data-path="case-studies-of-mixed-models.html"><a href="case-studies-of-mixed-models.html"><i class="fa fa-check"></i><b>1.5</b> Case studies of mixed models</a></li>
<li class="chapter" data-level="1.6" data-path="non-linear-mixed-models.html"><a href="non-linear-mixed-models.html"><i class="fa fa-check"></i><b>1.6</b> Non-linear mixed models</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="non-linear-mixed-models.html"><a href="non-linear-mixed-models.html#indomethacin-kinetics"><i class="fa fa-check"></i><b>1.6.1</b> Indomethacin kinetics</a></li>
<li class="chapter" data-level="1.6.2" data-path="non-linear-mixed-models.html"><a href="non-linear-mixed-models.html#growth-of-soyabean-plants"><i class="fa fa-check"></i><b>1.6.2</b> Growth of Soyabean plants</a></li>
<li class="chapter" data-level="1.6.3" data-path="non-linear-mixed-models.html"><a href="non-linear-mixed-models.html#phenobarbital-kinetics"><i class="fa fa-check"></i><b>1.6.3</b> Phenobarbital kinetics</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="generalised-linear-mixed-models.html"><a href="generalised-linear-mixed-models.html"><i class="fa fa-check"></i><b>1.7</b> Generalised linear mixed models</a></li>
<li class="chapter" data-level="1.8" data-path="further-reading.html"><a href="further-reading.html"><i class="fa fa-check"></i><b>1.8</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Modelling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="case-studies-of-mixed-models" class="section level2 hasAnchor" number="1.5">
<h2><span class="header-section-number">1.5</span> Case studies of mixed models<a href="case-studies-of-mixed-models.html#case-studies-of-mixed-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>See datasets in the `mlmRev’ package.</p>
<p>Use chemistry data there instead of the reading attainment data?</p>
<hr />
<p><strong>Example: Reading attainment in primary school-children</strong><br />
&gt;
&gt; These data arose from a longitudinal study of a cohort of 407 pupils who entered 33 multi-ethnic inner London infant schools in 1982, and who were followed-up until the end of their junior schooling in 1989. The reading ability of pupils was tested on up to six occasions: annually from 1982 to 1986 and in 1989. Data are also available on the age of the pupils at the occasions when testing was performed and also their sex and ethnic group. The pupils took a variable number of the assessments and so the data are unbalanced. (Data source: <em>Statistics in Education</em> by Ian Plewis.)
&gt;
&gt; The data set has eight columns:
&gt;
&gt; 1. School Number (1 to 33)
&gt; 2. Pupil Number (1 to 751)
&gt; 3. Assessment Occasion (1 to 6)
&gt; 4. Reading attainment score
&gt; 5. A standardised reading score (to be ignored here)
&gt; 6. Ethnic Group (white or black {African Caribbean})
&gt; 7. Sex (boy or girl)
&gt; 8. Age (in years, but mean-centred)
&gt;
&gt; The questions of interest are:
&gt;
&gt; * How does reading ability develop as children grow older?
&gt; * Does this development vary from pupil to pupil or from school to school?
&gt; * If so, does it vary systematically from one type of pupil to another (e.g. boys vs girls, white vs black or both), and according to the characteristics of the school?</p>
<hr />
<p>First we read the data.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="case-studies-of-mixed-models.html#cb11-1" tabindex="-1"></a>   path <span class="ot">&lt;-</span> <span class="fu">rp.datalink</span>(<span class="st">&quot;reading&quot;</span>)</span>
<span id="cb11-2"><a href="case-studies-of-mixed-models.html#cb11-2" tabindex="-1"></a>   d    <span class="ot">&lt;-</span> <span class="fu">read.table</span>(path, <span class="at">header =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<!-- `ggplot` graphics again provides a simple way of producing some attractive and helpful visualisations. -->
<!-- ```{r out.width = '49%', fig.show = 'hold', fig.align = "none"} -->
<!--    library(ggplot2) -->
<!--    ggplot(d, aes(Age, Readatt)) + geom_point() + -->
<!--       facet_grid(Ethnicity ~ Sex) -->
<!--    ggplot(d, aes(Age, Readatt, col = Sex)) + geom_point() + -->
<!--       facet_wrap(~ School) -->
<!-- ``` -->
<!-- We need to think carefully about how the *errors* should be modelled.  For the moment, we will include only `Age` in the fixed effects, as this is the variable which clearly influences reading ability strongly.  A random effect for each pupil, which allows them to display greater or lesser individual ability, is a good starting point.  A residual plot helps us to assess the adequacy of this model, in an informal manner.  Some non-random patterns suggest that we need to improve the model. -->
<!-- ```{r out.width = '49%', fig.align = 'center'} -->
<!--    library(lme4) -->
<!--    model1 <- lmer(Readatt ~ Age + (1 | School/Pupil), data = d) -->
<!--    plot(model1) -->
<!-- ``` -->
<!-- Another plot may help.  This one shsows the trajectory of each individual over time.  An interesting feature is a suggestion that these trajectories 'fan out' a little over time.  This may suggest that pupils who are good readers at an early stage improve their reading ability over time at a greater rate than those who are poorer readers.  This sounds plausible. -->
<!-- ```{r out.width = '70%', fig.align = 'center'} -->
<!--    ggplot(d, aes(Age, Readatt, group = Pupil)) + geom_line() + -->
<!--           facet_wrap(vars(School)) -->
<!-- ``` -->
<!-- We can incorporate this into a model by describing these trajectories through straight lines (plus random error) whose slopes are described by random effects.  The `lme` syntax enables this to be specified easily.  The residual plot nolonger shows non-random features and a formal test confirms that the simple random effects model is inadequate, in comparison with the model which allows random slopes. -->
<!-- ```{r out.width = '49%', fig.align = 'center'} -->
<!-- model2 <- lmer(Readatt ~ Age + (Age | School/Pupil), data = d) -->
<!-- plot(model2) -->
<!-- ``` -->
<!-- The residual plot has improved. We might also confirm the suitability of the random slopes model by performing a more formal model comparison. -->
<!-- ```{r} -->
<!-- anova(model1, model2) -->
<!-- ``` -->
<!-- Now that our model has a good random effects structure, we can examine the fixed effects in greater detail.  The summary gives no evidence of an ethnicity effect, but does show a sex effect with girls producing a better average performance, in addition to the age effect which we already know is present. -->
<!-- ```{r} -->
<!--    model3 <- lmer(Readatt ~ Age + Sex + Ethnicity + (Age | School/Pupil), -->
<!--                  data = d) -->
<!--    summary(model3)$coefficients -->
<!-- ``` -->
<!-- It would be wise for us to examine whether interactions might be present.  That is left as an exercise. -->
<!-- As a further exercise, check what conclusions are reached if the random effects structure is simply ignored. -->
</div>
            </section>

          </div>
        </div>
      </div>
<a href="repeated-measurements.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="non-linear-mixed-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["book.pdf", "book.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
