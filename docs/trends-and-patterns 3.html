<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Trends and patterns | Statistical Modelling</title>
  <meta name="description" content="A conceptual, visual and practical introduction to statistical modelling" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Trends and patterns | Statistical Modelling" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A conceptual, visual and practical introduction to statistical modelling" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Trends and patterns | Statistical Modelling" />
  
  <meta name="twitter:description" content="A conceptual, visual and practical introduction to statistical modelling" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-visualisation.html"/>
<link rel="next" href="inference.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/rglWebGL-binding-1.2.8/rglWebGL.js"></script>
<link href="libs/rglwidgetClass-1.2.8/rgl.css" rel="stylesheet" />
<script src="libs/rglwidgetClass-1.2.8/rglClass.min.js"></script>
<script src="libs/CanvasMatrix4-1.2.8/CanvasMatrix.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.1/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.1/leaflet-providers-plugin.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A visual and conceptual introduction to statistical modelling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface: what’s the problem?</a></li>
<li class="chapter" data-level="" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html"><i class="fa fa-check"></i>Getting started with R</a></li>
<li class="part"><span><b>I Introduction</b></span></li>
<li class="chapter" data-level="1" data-path="where-data.html"><a href="where-data.html"><i class="fa fa-check"></i><b>1</b> Where do data come from?</a>
<ul>
<li class="chapter" data-level="1.1" data-path="where-data.html"><a href="where-data.html#examples-data"><i class="fa fa-check"></i><b>1.1</b> Some examples of data</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="where-data.html"><a href="where-data.html#co2-and-global-warming"><i class="fa fa-check"></i><b>1.1.1</b> CO2 and global warming</a></li>
<li class="chapter" data-level="1.1.2" data-path="where-data.html"><a href="where-data.html#the-first-tuberculosis-trial"><i class="fa fa-check"></i><b>1.1.2</b> The first tuberculosis trial</a></li>
<li class="chapter" data-level="1.1.3" data-path="where-data.html"><a href="where-data.html#the-birds-and-the-bees-how-to-tell-the-sex-of-a-herring-gull"><i class="fa fa-check"></i><b>1.1.3</b> The birds and the bees: how to tell the sex of a herring gull</a></li>
<li class="chapter" data-level="1.1.4" data-path="where-data.html"><a href="where-data.html#tracking-the-covid-pandemic"><i class="fa fa-check"></i><b>1.1.4</b> Tracking the covid pandemic</a></li>
<li class="chapter" data-level="1.1.5" data-path="where-data.html"><a href="where-data.html#more-complex-data-objects"><i class="fa fa-check"></i><b>1.1.5</b> More complex data objects</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="where-data.html"><a href="where-data.html#some-broad-issues"><i class="fa fa-check"></i><b>1.2</b> Some broad issues</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="where-data.html"><a href="where-data.html#whats-the-problem"><i class="fa fa-check"></i><b>1.2.1</b> What’s the problem?</a></li>
<li class="chapter" data-level="1.2.2" data-path="where-data.html"><a href="where-data.html#whats-the-plan"><i class="fa fa-check"></i><b>1.2.2</b> What’s the plan?</a></li>
<li class="chapter" data-level="1.2.3" data-path="where-data.html"><a href="where-data.html#where-do-the-data-come-from"><i class="fa fa-check"></i><b>1.2.3</b> Where do the data come from?</a></li>
<li class="chapter" data-level="1.2.4" data-path="where-data.html"><a href="where-data.html#who-do-you-trust"><i class="fa fa-check"></i><b>1.2.4</b> Who do you trust?</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="where-data.html"><a href="where-data.html#what-could-possibly-go-wrong"><i class="fa fa-check"></i><b>1.3</b> What could possibly go wrong?</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="where-data.html"><a href="where-data.html#us-presidential-elections-1936-and-1948"><i class="fa fa-check"></i><b>1.3.1</b> US presidential elections, 1936 and 1948</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="where-data.html"><a href="where-data.html#further-reading"><i class="fa fa-check"></i><b>1.4</b> Further reading</a></li>
<li class="chapter" data-level="1.5" data-path="where-data.html"><a href="where-data.html#exercises"><i class="fa fa-check"></i><b>1.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="where-data.html"><a href="where-data.html#an-investigation-of-short-term-memory"><i class="fa fa-check"></i><b>1.5.1</b> An investigation of short-term memory</a></li>
<li class="chapter" data-level="1.5.2" data-path="where-data.html"><a href="where-data.html#a-survey-of-dental-health"><i class="fa fa-check"></i><b>1.5.2</b> A survey of dental health</a></li>
<li class="chapter" data-level="1.5.3" data-path="where-data.html"><a href="where-data.html#hearings-aid-and-dementia"><i class="fa fa-check"></i><b>1.5.3</b> Hearings aid and dementia</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="R-introduction.html"><a href="R-introduction.html"><i class="fa fa-check"></i><b>2</b> A gentle introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="R-introduction.html"><a href="R-introduction.html#r-fuss"><i class="fa fa-check"></i><b>2.1</b> R: what’s all the fuss about?</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="R-introduction.html"><a href="R-introduction.html#history"><i class="fa fa-check"></i><b>2.1.1</b> History</a></li>
<li class="chapter" data-level="2.1.2" data-path="R-introduction.html"><a href="R-introduction.html#why-should-i-be-interested"><i class="fa fa-check"></i><b>2.1.2</b> Why should I be interested?</a></li>
<li class="chapter" data-level="2.1.3" data-path="R-introduction.html"><a href="R-introduction.html#whats-the-down-side"><i class="fa fa-check"></i><b>2.1.3</b> What’s the down side?</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="R-introduction.html"><a href="R-introduction.html#taste-of-r"><i class="fa fa-check"></i><b>2.2</b> A taste of R</a></li>
<li class="chapter" data-level="2.3" data-path="R-introduction.html"><a href="R-introduction.html#a-summary-of-key-concepts-in-r"><i class="fa fa-check"></i><b>2.3</b> A summary of key concepts in R</a></li>
<li class="chapter" data-level="2.4" data-path="R-introduction.html"><a href="R-introduction.html#reading-data"><i class="fa fa-check"></i><b>2.4</b> Reading data into R</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="R-introduction.html"><a href="R-introduction.html#accessing-the-data-used-in-this-book"><i class="fa fa-check"></i><b>2.4.1</b> Accessing the data used in this book</a></li>
<li class="chapter" data-level="2.4.2" data-path="R-introduction.html"><a href="R-introduction.html#functions-for-reading-data"><i class="fa fa-check"></i><b>2.4.2</b> Functions for reading data</a></li>
<li class="chapter" data-level="2.4.3" data-path="R-introduction.html"><a href="R-introduction.html#reading-data-example"><i class="fa fa-check"></i><b>2.4.3</b> An example: reading an <em>Excel</em> spreadsheet</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="R-introduction.html"><a href="R-introduction.html#a-further-example-the-scottish-independence-referendum"><i class="fa fa-check"></i><b>2.5</b> A further example: the Scottish independence referendum</a></li>
<li class="chapter" data-level="2.6" data-path="R-introduction.html"><a href="R-introduction.html#further-reading-1"><i class="fa fa-check"></i><b>2.6</b> Further reading</a></li>
<li class="chapter" data-level="2.7" data-path="R-introduction.html"><a href="R-introduction.html#exercises-1"><i class="fa fa-check"></i><b>2.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="R-introduction.html"><a href="R-introduction.html#scottish-referendum-data"><i class="fa fa-check"></i><b>2.7.1</b> Scottish Referendum data</a></li>
<li class="chapter" data-level="2.7.2" data-path="R-introduction.html"><a href="R-introduction.html#aircraft-designs"><i class="fa fa-check"></i><b>2.7.2</b> Aircraft designs</a></li>
<li class="chapter" data-level="2.7.3" data-path="R-introduction.html"><a href="R-introduction.html#centenarians"><i class="fa fa-check"></i><b>2.7.3</b> Centenarians</a></li>
<li class="chapter" data-level="2.7.4" data-path="R-introduction.html"><a href="R-introduction.html#justification-of-the-log-transformation-for-the-rodent-data"><i class="fa fa-check"></i><b>2.7.4</b> Justification of the log transformation for the rodent data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>3</b> Data wrangling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-wrangling.html"><a href="data-wrangling.html#reorganising-data"><i class="fa fa-check"></i><b>3.1</b> Reorganising data</a></li>
<li class="chapter" data-level="3.2" data-path="data-wrangling.html"><a href="data-wrangling.html#collating-data-from-different-sources"><i class="fa fa-check"></i><b>3.2</b> Collating data from different sources</a></li>
<li class="chapter" data-level="3.3" data-path="data-wrangling.html"><a href="data-wrangling.html#tidy-data"><i class="fa fa-check"></i><b>3.3</b> Tidy data</a></li>
<li class="chapter" data-level="3.4" data-path="data-wrangling.html"><a href="data-wrangling.html#further-reading-2"><i class="fa fa-check"></i><b>3.4</b> Further reading</a></li>
<li class="chapter" data-level="3.5" data-path="data-wrangling.html"><a href="data-wrangling.html#exercises-2"><i class="fa fa-check"></i><b>3.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="data-wrangling.html"><a href="data-wrangling.html#data-wrangling-exercise-UN-demography"><i class="fa fa-check"></i><b>3.5.1</b> UN demography data</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Exploring data</b></span></li>
<li class="chapter" data-level="4" data-path="data-visualisation.html"><a href="data-visualisation.html"><i class="fa fa-check"></i><b>4</b> Data Visualisation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-visualisation.html"><a href="data-visualisation.html#thousand-words"><i class="fa fa-check"></i><b>4.1</b> Graphics: a picture is worth a thousand words</a></li>
<li class="chapter" data-level="4.2" data-path="data-visualisation.html"><a href="data-visualisation.html#ggplot-graphics"><i class="fa fa-check"></i><b>4.2</b> <code>ggplot</code> graphics</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="data-visualisation.html"><a href="data-visualisation.html#ggplot-graphics-basics"><i class="fa fa-check"></i><b>4.2.1</b> The basics</a></li>
<li class="chapter" data-level="4.2.2" data-path="data-visualisation.html"><a href="data-visualisation.html#facets"><i class="fa fa-check"></i><b>4.2.2</b> Facets</a></li>
<li class="chapter" data-level="4.2.3" data-path="data-visualisation.html"><a href="data-visualisation.html#going-deeper"><i class="fa fa-check"></i><b>4.2.3</b> Going deeper</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="data-visualisation.html"><a href="data-visualisation.html#what-are-we-looking-for"><i class="fa fa-check"></i><b>4.3</b> What are we looking for?</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="data-visualisation.html"><a href="data-visualisation.html#continuous-scales"><i class="fa fa-check"></i><b>4.3.1</b> Continuous scales</a></li>
<li class="chapter" data-level="4.3.2" data-path="data-visualisation.html"><a href="data-visualisation.html#discrete-scales"><i class="fa fa-check"></i><b>4.3.2</b> Discrete scales</a></li>
<li class="chapter" data-level="4.3.3" data-path="data-visualisation.html"><a href="data-visualisation.html#categorical-data"><i class="fa fa-check"></i><b>4.3.3</b> Categorical data</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data-visualisation.html"><a href="data-visualisation.html#gaining-an-overview-of-datasets"><i class="fa fa-check"></i><b>4.4</b> Gaining an overview of datasets</a></li>
<li class="chapter" data-level="4.5" data-path="data-visualisation.html"><a href="data-visualisation.html#plots-for-more-complex-data-structures"><i class="fa fa-check"></i><b>4.5</b> Plots for more complex data structures</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="data-visualisation.html"><a href="data-visualisation.html#d-data"><i class="fa fa-check"></i><b>4.5.1</b> 3D data</a></li>
<li class="chapter" data-level="4.5.2" data-path="data-visualisation.html"><a href="data-visualisation.html#circular-spherical-and-compositional-data"><i class="fa fa-check"></i><b>4.5.2</b> Circular, spherical and compositional data</a></li>
<li class="chapter" data-level="4.5.3" data-path="data-visualisation.html"><a href="data-visualisation.html#other-data-structures"><i class="fa fa-check"></i><b>4.5.3</b> Other data structures</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="data-visualisation.html"><a href="data-visualisation.html#going-further"><i class="fa fa-check"></i><b>4.6</b> Going further</a></li>
<li class="chapter" data-level="4.7" data-path="data-visualisation.html"><a href="data-visualisation.html#exercises-3"><i class="fa fa-check"></i><b>4.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="data-visualisation.html"><a href="data-visualisation.html#rodent-mass-and-speed"><i class="fa fa-check"></i><b>4.7.1</b> Rodent mass and speed</a></li>
<li class="chapter" data-level="4.7.2" data-path="data-visualisation.html"><a href="data-visualisation.html#uk-covid-19-deaths"><i class="fa fa-check"></i><b>4.7.2</b> UK covid-19 deaths</a></li>
<li class="chapter" data-level="4.7.3" data-path="data-visualisation.html"><a href="data-visualisation.html#scottish-referendum"><i class="fa fa-check"></i><b>4.7.3</b> Scottish referendum</a></li>
<li class="chapter" data-level="4.7.4" data-path="data-visualisation.html"><a href="data-visualisation.html#centenarians-in-scotland"><i class="fa fa-check"></i><b>4.7.4</b> Centenarians in Scotland</a></li>
<li class="chapter" data-level="4.7.5" data-path="data-visualisation.html"><a href="data-visualisation.html#flour-beetles"><i class="fa fa-check"></i><b>4.7.5</b> Flour beetles</a></li>
<li class="chapter" data-level="4.7.6" data-path="data-visualisation.html"><a href="data-visualisation.html#clyde-estuary-water-quality"><i class="fa fa-check"></i><b>4.7.6</b> Clyde Estuary water quality</a></li>
<li class="chapter" data-level="4.7.7" data-path="data-visualisation.html"><a href="data-visualisation.html#crabs-multivariate"><i class="fa fa-check"></i><b>4.7.7</b> Crabs (<em>multivariate</em>)</a></li>
<li class="chapter" data-level="4.7.8" data-path="data-visualisation.html"><a href="data-visualisation.html#topographic-data"><i class="fa fa-check"></i><b>4.7.8</b> Topographic data</a></li>
<li class="chapter" data-level="4.7.9" data-path="data-visualisation.html"><a href="data-visualisation.html#global-energy-use"><i class="fa fa-check"></i><b>4.7.9</b> Global energy use</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="trends-and-patterns.html"><a href="trends-and-patterns.html"><i class="fa fa-check"></i><b>5</b> Trends and patterns</a>
<ul>
<li class="chapter" data-level="5.1" data-path="trends-and-patterns.html"><a href="trends-and-patterns.html#density-estimation"><i class="fa fa-check"></i><b>5.1</b> Density estimation</a></li>
<li class="chapter" data-level="5.2" data-path="trends-and-patterns.html"><a href="trends-and-patterns.html#flexible-regression"><i class="fa fa-check"></i><b>5.2</b> Flexible regression</a></li>
<li class="chapter" data-level="5.3" data-path="trends-and-patterns.html"><a href="trends-and-patterns.html#further-reading-3"><i class="fa fa-check"></i><b>5.3</b> Further reading</a></li>
<li class="chapter" data-level="5.4" data-path="trends-and-patterns.html"><a href="trends-and-patterns.html#exercises-4"><i class="fa fa-check"></i><b>5.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="trends-and-patterns.html"><a href="trends-and-patterns.html#exercise-conservation-density-displays"><i class="fa fa-check"></i><b>5.4.1</b> Does conservation work?</a></li>
<li class="chapter" data-level="5.4.2" data-path="trends-and-patterns.html"><a href="trends-and-patterns.html#the-spatial-distribution-of-laryngeal-cancer-smoothing"><i class="fa fa-check"></i><b>5.4.2</b> The spatial distribution of laryngeal cancer (<em>smoothing</em>)</a></li>
<li class="chapter" data-level="5.4.3" data-path="trends-and-patterns.html"><a href="trends-and-patterns.html#aircraft-data"><i class="fa fa-check"></i><b>5.4.3</b> Aircraft data</a></li>
<li class="chapter" data-level="5.4.4" data-path="trends-and-patterns.html"><a href="trends-and-patterns.html#radiocarbon-data"><i class="fa fa-check"></i><b>5.4.4</b> Radiocarbon data</a></li>
<li class="chapter" data-level="5.4.5" data-path="trends-and-patterns.html"><a href="trends-and-patterns.html#follicle-data"><i class="fa fa-check"></i><b>5.4.5</b> Follicle data</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Statistical Inference</b></span></li>
<li class="chapter" data-level="6" data-path="inference.html"><a href="inference.html"><i class="fa fa-check"></i><b>6</b> Inference: turning data into evidence</a>
<ul>
<li class="chapter" data-level="6.1" data-path="inference.html"><a href="inference.html#where-do-data-come-from-samples-and-populations"><i class="fa fa-check"></i><b>6.1</b> Where do data come from? Samples and populations</a></li>
<li class="chapter" data-level="6.2" data-path="inference.html"><a href="inference.html#quantifying-uncertainty-standard-error"><i class="fa fa-check"></i><b>6.2</b> Quantifying uncertainty: standard error</a></li>
<li class="chapter" data-level="6.3" data-path="inference.html"><a href="inference.html#quantifying-uncertainty-confidence-intervals"><i class="fa fa-check"></i><b>6.3</b> Quantifying uncertainty: confidence intervals</a></li>
<li class="chapter" data-level="6.4" data-path="inference.html"><a href="inference.html#hypothesis-tests"><i class="fa fa-check"></i><b>6.4</b> Hypothesis tests</a></li>
<li class="chapter" data-level="6.5" data-path="inference.html"><a href="inference.html#variability-bands-for-flexible-regression"><i class="fa fa-check"></i><b>6.5</b> Variability bands for flexible regression</a></li>
<li class="chapter" data-level="6.6" data-path="inference.html"><a href="inference.html#further-reading-4"><i class="fa fa-check"></i><b>6.6</b> Further reading</a></li>
<li class="chapter" data-level="6.7" data-path="inference.html"><a href="inference.html#exercises-5"><i class="fa fa-check"></i><b>6.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="inference.html"><a href="inference.html#standard-errors"><i class="fa fa-check"></i><b>6.7.1</b> Standard errors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="other-approaches-to-inference.html"><a href="other-approaches-to-inference.html"><i class="fa fa-check"></i><b>7</b> Other approaches to inference</a>
<ul>
<li class="chapter" data-level="7.1" data-path="other-approaches-to-inference.html"><a href="other-approaches-to-inference.html#computational-inference"><i class="fa fa-check"></i><b>7.1</b> Computational inference</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="other-approaches-to-inference.html"><a href="other-approaches-to-inference.html#simulation-methods"><i class="fa fa-check"></i><b>7.1.1</b> Simulation methods</a></li>
<li class="chapter" data-level="7.1.2" data-path="other-approaches-to-inference.html"><a href="other-approaches-to-inference.html#randomisation-tests"><i class="fa fa-check"></i><b>7.1.2</b> Randomisation tests</a></li>
<li class="chapter" data-level="7.1.3" data-path="other-approaches-to-inference.html"><a href="other-approaches-to-inference.html#the-bootstrap"><i class="fa fa-check"></i><b>7.1.3</b> The bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="other-approaches-to-inference.html"><a href="other-approaches-to-inference.html#bayesian-inference"><i class="fa fa-check"></i><b>7.2</b> Bayesian inference</a></li>
<li class="chapter" data-level="7.3" data-path="other-approaches-to-inference.html"><a href="other-approaches-to-inference.html#exercises-6"><i class="fa fa-check"></i><b>7.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="other-approaches-to-inference.html"><a href="other-approaches-to-inference.html#coverage-property-of-bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>7.3.1</b> Coverage property of bootstrap confidence intervals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="inference-with-categorical-data.html"><a href="inference-with-categorical-data.html"><i class="fa fa-check"></i><b>8</b> Inference with categorical data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="inference-with-categorical-data.html"><a href="inference-with-categorical-data.html#simple-proportions"><i class="fa fa-check"></i><b>8.1</b> Simple proportions</a></li>
<li class="chapter" data-level="8.2" data-path="inference-with-categorical-data.html"><a href="inference-with-categorical-data.html#comparing-proportions"><i class="fa fa-check"></i><b>8.2</b> Comparing proportions</a></li>
<li class="chapter" data-level="8.3" data-path="inference-with-categorical-data.html"><a href="inference-with-categorical-data.html#contingency-tables"><i class="fa fa-check"></i><b>8.3</b> Contingency tables</a></li>
<li class="chapter" data-level="8.4" data-path="inference-with-categorical-data.html"><a href="inference-with-categorical-data.html#exercises-7"><i class="fa fa-check"></i><b>8.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="inference-with-categorical-data.html"><a href="inference-with-categorical-data.html#opinion-polls"><i class="fa fa-check"></i><b>8.4.1</b> Opinion polls</a></li>
<li class="chapter" data-level="8.4.2" data-path="inference-with-categorical-data.html"><a href="inference-with-categorical-data.html#respiratory-disease-in-infancy"><i class="fa fa-check"></i><b>8.4.2</b> Respiratory disease in infancy</a></li>
<li class="chapter" data-level="8.4.3" data-path="inference-with-categorical-data.html"><a href="inference-with-categorical-data.html#smoking-and-lung-cancer"><i class="fa fa-check"></i><b>8.4.3</b> Smoking and lung cancer</a></li>
<li class="chapter" data-level="8.4.4" data-path="inference-with-categorical-data.html"><a href="inference-with-categorical-data.html#confidence-intervals-and-p-values"><i class="fa fa-check"></i><b>8.4.4</b> Confidence intervals and p-values</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Statistical Models</b></span></li>
<li class="chapter" data-level="9" data-path="linear-models.html"><a href="linear-models.html"><i class="fa fa-check"></i><b>9</b> Linear models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="linear-models.html"><a href="linear-models.html#simple-regression"><i class="fa fa-check"></i><b>9.1</b> One covariate: linear models in miniature</a></li>
<li class="chapter" data-level="9.2" data-path="linear-models.html"><a href="linear-models.html#formulating-and-fitting-linear-models"><i class="fa fa-check"></i><b>9.2</b> Formulating and fitting linear models</a></li>
<li class="chapter" data-level="9.3" data-path="linear-models.html"><a href="linear-models.html#model-checking"><i class="fa fa-check"></i><b>9.3</b> Model checking</a></li>
<li class="chapter" data-level="9.4" data-path="linear-models.html"><a href="linear-models.html#inference-1"><i class="fa fa-check"></i><b>9.4</b> Inference</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="linear-models.html"><a href="linear-models.html#confidence-intervals"><i class="fa fa-check"></i><b>9.4.1</b> Confidence intervals</a></li>
<li class="chapter" data-level="9.4.2" data-path="linear-models.html"><a href="linear-models.html#hypothesis-tests-1"><i class="fa fa-check"></i><b>9.4.2</b> Hypothesis tests</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="linear-models.html"><a href="linear-models.html#two-covariates-black-cherry-trees"><i class="fa fa-check"></i><b>9.5</b> Two covariates: Black Cherry Trees</a></li>
<li class="chapter" data-level="9.6" data-path="linear-models.html"><a href="linear-models.html#comparing-groups-analysis-of-variance"><i class="fa fa-check"></i><b>9.6</b> Comparing groups: analysis of variance</a></li>
<li class="chapter" data-level="9.7" data-path="linear-models.html"><a href="linear-models.html#comparing-regression-lines-analysis-of-covariance"><i class="fa fa-check"></i><b>9.7</b> Comparing regression lines: analysis of covariance</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="linear-models.html"><a href="linear-models.html#trout"><i class="fa fa-check"></i><b>9.7.1</b> Trout</a></li>
<li class="chapter" data-level="9.7.2" data-path="linear-models.html"><a href="linear-models.html#respiratory-distress-syndrome"><i class="fa fa-check"></i><b>9.7.2</b> Respiratory distress syndrome</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="linear-models.html"><a href="linear-models.html#general-thoughts-on-models"><i class="fa fa-check"></i><b>9.8</b> General thoughts on models</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="linear-models.html"><a href="linear-models.html#what-are-models-for"><i class="fa fa-check"></i><b>9.8.1</b> What are models for?</a></li>
<li class="chapter" data-level="9.8.2" data-path="linear-models.html"><a href="linear-models.html#model-selection"><i class="fa fa-check"></i><b>9.8.2</b> Model selection</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="linear-models.html"><a href="linear-models.html#exercises-8"><i class="fa fa-check"></i><b>9.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="9.9.1" data-path="linear-models.html"><a href="linear-models.html#giving-in-the-church-of-england"><i class="fa fa-check"></i><b>9.9.1</b> Giving in the Church of England</a></li>
<li class="chapter" data-level="9.9.2" data-path="linear-models.html"><a href="linear-models.html#black-cherry-trees"><i class="fa fa-check"></i><b>9.9.2</b> Black Cherry trees</a></li>
<li class="chapter" data-level="9.9.3" data-path="linear-models.html"><a href="linear-models.html#cats"><i class="fa fa-check"></i><b>9.9.3</b> Cats</a></li>
<li class="chapter" data-level="9.9.4" data-path="linear-models.html"><a href="linear-models.html#respiratory-distress-syndrome-1"><i class="fa fa-check"></i><b>9.9.4</b> Respiratory distress syndrome</a></li>
<li class="chapter" data-level="9.9.5" data-path="linear-models.html"><a href="linear-models.html#the-clyde-data"><i class="fa fa-check"></i><b>9.9.5</b> The Clyde data</a></li>
<li class="chapter" data-level="9.9.6" data-path="linear-models.html"><a href="linear-models.html#water-quality-in-loch-leven"><i class="fa fa-check"></i><b>9.9.6</b> Water quality in Loch Leven</a></li>
<li class="chapter" data-level="9.9.7" data-path="linear-models.html"><a href="linear-models.html#so_2-over-europe"><i class="fa fa-check"></i><b>9.9.7</b> SO<span class="math inline">\(_2\)</span> over Europe</a></li>
<li class="chapter" data-level="9.9.8" data-path="linear-models.html"><a href="linear-models.html#maximal-heart-rate-and-age"><i class="fa fa-check"></i><b>9.9.8</b> Maximal heart rate and age</a></li>
<li class="chapter" data-level="9.9.9" data-path="linear-models.html"><a href="linear-models.html#the-effects-of-conservation"><i class="fa fa-check"></i><b>9.9.9</b> The effects of conservation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html"><i class="fa fa-check"></i><b>10</b> Generalised linear models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#logistic-regression"><i class="fa fa-check"></i><b>10.1</b> Binomial data: logistic regression</a></li>
<li class="chapter" data-level="10.2" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#the-concept-of-likelihood"><i class="fa fa-check"></i><b>10.2</b> The concept of likelihood</a></li>
<li class="chapter" data-level="10.3" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#poisson-regression"><i class="fa fa-check"></i><b>10.3</b> Count data: Poisson regression</a></li>
<li class="chapter" data-level="10.4" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#general-glms"><i class="fa fa-check"></i><b>10.4</b> A general formulation of GLMs</a></li>
<li class="chapter" data-level="10.5" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#further-examples"><i class="fa fa-check"></i><b>10.5</b> Further examples</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#two-covariates-vasoconstriction-of-the-digits"><i class="fa fa-check"></i><b>10.5.1</b> Two covariates: vasoconstriction of the digits</a></li>
<li class="chapter" data-level="10.5.2" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#doctors-and-smoking"><i class="fa fa-check"></i><b>10.5.2</b> Doctors and smoking</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#exercises-9"><i class="fa fa-check"></i><b>10.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#bissell-data"><i class="fa fa-check"></i><b>10.6.1</b> Bissell data</a></li>
<li class="chapter" data-level="10.6.2" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#vasoconstriction-data"><i class="fa fa-check"></i><b>10.6.2</b> Vasoconstriction data</a></li>
<li class="chapter" data-level="10.6.3" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#the-framingham-heart-study"><i class="fa fa-check"></i><b>10.6.3</b> The Framingham heart study</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="models-with-random-effects.html"><a href="models-with-random-effects.html"><i class="fa fa-check"></i><b>11</b> Models with random effects</a>
<ul>
<li class="chapter" data-level="11.1" data-path="models-with-random-effects.html"><a href="models-with-random-effects.html#a-problem-with-paste"><i class="fa fa-check"></i><b>11.1</b> A problem with paste</a></li>
<li class="chapter" data-level="11.2" data-path="models-with-random-effects.html"><a href="models-with-random-effects.html#repeated-measurements"><i class="fa fa-check"></i><b>11.2</b> Repeated measurements</a></li>
<li class="chapter" data-level="11.3" data-path="models-with-random-effects.html"><a href="models-with-random-effects.html#a-case-study-reading-attainment"><i class="fa fa-check"></i><b>11.3</b> A case study: reading attainment</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="flexible-models.html"><a href="flexible-models.html"><i class="fa fa-check"></i><b>12</b> Flexible models</a>
<ul>
<li class="chapter" data-level="12.1" data-path="flexible-models.html"><a href="flexible-models.html#flexible-methods"><i class="fa fa-check"></i><b>12.1</b> Methods for constructing flexible models</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="flexible-models.html"><a href="flexible-models.html#fitting-models-locally"><i class="fa fa-check"></i><b>12.1.1</b> Fitting models locally</a></li>
<li class="chapter" data-level="12.1.2" data-path="flexible-models.html"><a href="flexible-models.html#splines"><i class="fa fa-check"></i><b>12.1.2</b> Splines</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="flexible-models.html"><a href="flexible-models.html#inference-with-simple-flexible-models"><i class="fa fa-check"></i><b>12.2</b> Inference with simple flexible models</a></li>
<li class="chapter" data-level="12.3" data-path="flexible-models.html"><a href="flexible-models.html#a-simple-additive-model"><i class="fa fa-check"></i><b>12.3</b> A simple additive model</a></li>
<li class="chapter" data-level="12.4" data-path="flexible-models.html"><a href="flexible-models.html#inference-with-additive-models"><i class="fa fa-check"></i><b>12.4</b> Inference with additive models</a></li>
<li class="chapter" data-level="12.5" data-path="flexible-models.html"><a href="flexible-models.html#further-reading-5"><i class="fa fa-check"></i><b>12.5</b> Further reading</a></li>
<li class="chapter" data-level="12.6" data-path="flexible-models.html"><a href="flexible-models.html#exercises-10"><i class="fa fa-check"></i><b>12.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="flexible-models.html"><a href="flexible-models.html#fitting-a-p-spline-model"><i class="fa fa-check"></i><b>12.6.1</b> Fitting a p-spline model</a></li>
<li class="chapter" data-level="12.6.2" data-path="flexible-models.html"><a href="flexible-models.html#the-backfitting-algorithm"><i class="fa fa-check"></i><b>12.6.2</b> The backfitting algorithm</a></li>
<li class="chapter" data-level="12.6.3" data-path="flexible-models.html"><a href="flexible-models.html#water-quality-in-the-clyde-estuary"><i class="fa fa-check"></i><b>12.6.3</b> Water quality in the Clyde estuary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="models-for-time.html"><a href="models-for-time.html"><i class="fa fa-check"></i><b>13</b> Models for time</a>
<ul>
<li class="chapter" data-level="13.1" data-path="models-for-time.html"><a href="models-for-time.html#time-series-data"><i class="fa fa-check"></i><b>13.1</b> Time series data</a></li>
<li class="chapter" data-level="13.2" data-path="models-for-time.html"><a href="models-for-time.html#visualisation"><i class="fa fa-check"></i><b>13.2</b> Visualisation</a></li>
<li class="chapter" data-level="13.3" data-path="models-for-time.html"><a href="models-for-time.html#models"><i class="fa fa-check"></i><b>13.3</b> Models</a></li>
<li class="chapter" data-level="13.4" data-path="models-for-time.html"><a href="models-for-time.html#further-reading-6"><i class="fa fa-check"></i><b>13.4</b> Further reading</a></li>
<li class="chapter" data-level="13.5" data-path="models-for-time.html"><a href="models-for-time.html#exercises-11"><i class="fa fa-check"></i><b>13.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="models-for-time.html"><a href="models-for-time.html#simulating-time-series"><i class="fa fa-check"></i><b>13.5.1</b> Simulating time series</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="models-for-space.html"><a href="models-for-space.html"><i class="fa fa-check"></i><b>14</b> Models for space</a>
<ul>
<li class="chapter" data-level="14.1" data-path="models-for-space.html"><a href="models-for-space.html#visualising-spatial-data"><i class="fa fa-check"></i><b>14.1</b> Visualising spatial data</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="models-for-space.html"><a href="models-for-space.html#the-maps-package"><i class="fa fa-check"></i><b>14.1.1</b> The <code>maps</code> package</a></li>
<li class="chapter" data-level="14.1.2" data-path="models-for-space.html"><a href="models-for-space.html#leaflet-and-mapview-interactive-maps"><i class="fa fa-check"></i><b>14.1.2</b> <code>leaflet</code> and <code>mapview</code>: interactive maps</a></li>
<li class="chapter" data-level="14.1.3" data-path="models-for-space.html"><a href="models-for-space.html#ggplot-and-ggmap"><i class="fa fa-check"></i><b>14.1.3</b> <code>ggplot</code> and <code>ggmap</code></a></li>
<li class="chapter" data-level="14.1.4" data-path="models-for-space.html"><a href="models-for-space.html#tmap"><i class="fa fa-check"></i><b>14.1.4</b> <code>tmap</code></a></li>
<li class="chapter" data-level="14.1.5" data-path="models-for-space.html"><a href="models-for-space.html#spatstat-for-spatial-point-patterns"><i class="fa fa-check"></i><b>14.1.5</b> <code>spatstat</code> for spatial point patterns</a></li>
<li class="chapter" data-level="14.1.6" data-path="models-for-space.html"><a href="models-for-space.html#areal-data"><i class="fa fa-check"></i><b>14.1.6</b> Areal data</a></li>
<li class="chapter" data-level="14.1.7" data-path="models-for-space.html"><a href="models-for-space.html#image-data"><i class="fa fa-check"></i><b>14.1.7</b> Image data</a></li>
<li class="chapter" data-level="14.1.8" data-path="models-for-space.html"><a href="models-for-space.html#spatiotemporal-animation"><i class="fa fa-check"></i><b>14.1.8</b> Spatiotemporal animation</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="models-for-space.html"><a href="models-for-space.html#models-for-point-pattern-data"><i class="fa fa-check"></i><b>14.2</b> Models for point pattern data</a></li>
<li class="chapter" data-level="14.3" data-path="models-for-space.html"><a href="models-for-space.html#geostatistical-models"><i class="fa fa-check"></i><b>14.3</b> Geostatistical models</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="models-for-space.html"><a href="models-for-space.html#gaussian-processes"><i class="fa fa-check"></i><b>14.3.1</b> Gaussian processes</a></li>
<li class="chapter" data-level="14.3.2" data-path="models-for-space.html"><a href="models-for-space.html#geostatistical-models-1"><i class="fa fa-check"></i><b>14.3.2</b> Geostatistical models</a></li>
<li class="chapter" data-level="14.3.3" data-path="models-for-space.html"><a href="models-for-space.html#so2-a-model-based-on-smoothing"><i class="fa fa-check"></i><b>14.3.3</b> SO2: a model based on smoothing</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="models-for-space.html"><a href="models-for-space.html#models-for-areal-data"><i class="fa fa-check"></i><b>14.4</b> Models for areal data</a></li>
<li class="chapter" data-level="14.5" data-path="models-for-space.html"><a href="models-for-space.html#further-reading-7"><i class="fa fa-check"></i><b>14.5</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="experimental-design-revisited.html"><a href="experimental-design-revisited.html"><i class="fa fa-check"></i><b>15</b> Experimental design revisited</a>
<ul>
<li class="chapter" data-level="15.1" data-path="experimental-design-revisited.html"><a href="experimental-design-revisited.html#power"><i class="fa fa-check"></i><b>15.1</b> Power</a></li>
<li class="chapter" data-level="15.2" data-path="experimental-design-revisited.html"><a href="experimental-design-revisited.html#completely-randomised-design-comparing-several-treatments"><i class="fa fa-check"></i><b>15.2</b> Completely randomised design: comparing several treatments</a></li>
<li class="chapter" data-level="15.3" data-path="experimental-design-revisited.html"><a href="experimental-design-revisited.html#randomised-blocks-the-parable-of-the-sower"><i class="fa fa-check"></i><b>15.3</b> Randomised blocks: the parable of the sower</a></li>
<li class="chapter" data-level="15.4" data-path="experimental-design-revisited.html"><a href="experimental-design-revisited.html#factorial-designs-poisons-and-treatments"><i class="fa fa-check"></i><b>15.4</b> Factorial designs: poisons and treatments</a></li>
<li class="chapter" data-level="15.5" data-path="experimental-design-revisited.html"><a href="experimental-design-revisited.html#principles-of-experimental-design"><i class="fa fa-check"></i><b>15.5</b> Principles of experimental design</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="experimental-design-revisited.html"><a href="experimental-design-revisited.html#control"><i class="fa fa-check"></i><b>15.5.1</b> Control</a></li>
<li class="chapter" data-level="15.5.2" data-path="experimental-design-revisited.html"><a href="experimental-design-revisited.html#replicate"><i class="fa fa-check"></i><b>15.5.2</b> Replicate</a></li>
<li class="chapter" data-level="15.5.3" data-path="experimental-design-revisited.html"><a href="experimental-design-revisited.html#randomise"><i class="fa fa-check"></i><b>15.5.3</b> Randomise</a></li>
<li class="chapter" data-level="15.5.4" data-path="experimental-design-revisited.html"><a href="experimental-design-revisited.html#replication-and-pseudo-replication"><i class="fa fa-check"></i><b>15.5.4</b> Replication and Pseudo-Replication</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="experimental-design-revisited.html"><a href="experimental-design-revisited.html#exercises-12"><i class="fa fa-check"></i><b>15.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="experimental-design-revisited.html"><a href="experimental-design-revisited.html#student-cost-of-living"><i class="fa fa-check"></i><b>15.6.1</b> Student cost of living</a></li>
<li class="chapter" data-level="15.6.2" data-path="experimental-design-revisited.html"><a href="experimental-design-revisited.html#us-presidential-election-1936"><i class="fa fa-check"></i><b>15.6.2</b> US presidential election 1936</a></li>
<li class="chapter" data-level="15.6.3" data-path="experimental-design-revisited.html"><a href="experimental-design-revisited.html#the-parable-of-the-sower"><i class="fa fa-check"></i><b>15.6.3</b> The parable of the sower</a></li>
<li class="chapter" data-level="15.6.4" data-path="experimental-design-revisited.html"><a href="experimental-design-revisited.html#mururoa"><i class="fa fa-check"></i><b>15.6.4</b> Mururoa</a></li>
<li class="chapter" data-level="15.6.5" data-path="experimental-design-revisited.html"><a href="experimental-design-revisited.html#a-scottish-firth"><i class="fa fa-check"></i><b>15.6.5</b> A Scottish firth</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>V Statistical Models in Practice</b></span></li>
<li class="chapter" data-level="16" data-path="case-studies-of-statistical-modelling.html"><a href="case-studies-of-statistical-modelling.html"><i class="fa fa-check"></i><b>16</b> Case studies of statistical modelling</a>
<ul>
<li class="chapter" data-level="16.1" data-path="case-studies-of-statistical-modelling.html"><a href="case-studies-of-statistical-modelling.html#covid-19-initial-surveillance"><i class="fa fa-check"></i><b>16.1</b> Covid-19 initial surveillance</a></li>
<li class="chapter" data-level="16.2" data-path="case-studies-of-statistical-modelling.html"><a href="case-studies-of-statistical-modelling.html#uk-parliamentary-election-2024"><i class="fa fa-check"></i><b>16.2</b> UK parliamentary election 2024</a></li>
</ul></li>
<li class="part"><span><b>VI Other topics</b></span></li>
<li class="chapter" data-level="17" data-path="more-on-r.html"><a href="more-on-r.html"><i class="fa fa-check"></i><b>17</b> More on R</a>
<ul>
<li class="chapter" data-level="17.1" data-path="more-on-r.html"><a href="more-on-r.html#repetition"><i class="fa fa-check"></i><b>17.1</b> Repetition</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="more-on-r.html"><a href="more-on-r.html#standard-loops"><i class="fa fa-check"></i><b>17.1.1</b> Standard loops</a></li>
<li class="chapter" data-level="17.1.2" data-path="more-on-r.html"><a href="more-on-r.html#the-apply-family"><i class="fa fa-check"></i><b>17.1.2</b> The ‘apply’ family</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="more-on-r.html"><a href="more-on-r.html#writing-your-own-functions"><i class="fa fa-check"></i><b>17.2</b> Writing your own functions</a></li>
<li class="chapter" data-level="17.3" data-path="more-on-r.html"><a href="more-on-r.html#conditional-statements-and-while-loops"><i class="fa fa-check"></i><b>17.3</b> Conditional statements and <code>while</code> loops</a></li>
<li class="chapter" data-level="17.4" data-path="more-on-r.html"><a href="more-on-r.html#further-reading-8"><i class="fa fa-check"></i><b>17.4</b> Further reading</a></li>
<li class="chapter" data-level="17.5" data-path="more-on-r.html"><a href="more-on-r.html#exercises-13"><i class="fa fa-check"></i><b>17.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="more-on-r.html"><a href="more-on-r.html#a-simple-function"><i class="fa fa-check"></i><b>17.5.1</b> A simple function</a></li>
<li class="chapter" data-level="17.5.2" data-path="more-on-r.html"><a href="more-on-r.html#a-simple-function-thresholds"><i class="fa fa-check"></i><b>17.5.2</b> A simple function: thresholds</a></li>
<li class="chapter" data-level="17.5.3" data-path="more-on-r.html"><a href="more-on-r.html#improving-the-sim.max-function"><i class="fa fa-check"></i><b>17.5.3</b> Improving the sim.max function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Modelling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="trends-and-patterns" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> Trends and patterns<a href="trends-and-patterns.html#trends-and-patterns" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>It sometimes happens that there are trends patterns within a dataset but that these are obscured by a large degree of variability (noise). With large datasets, trends and patterns are hidden by ‘overplotting’ when every data point is displayed. The methods of this chapter aim to highlight underlying trends and patterns in a flexible manner, without imposing any assumptions on the nature of these trends and patterns apart from ‘smoothness’.</p>
<div id="density-estimation" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Density estimation<a href="trends-and-patterns.html#density-estimation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In statistical modelling, principal interest often lies in mean values or model parameters. However, there are some situations where the shape of the variation is itself the focus of attention. Here is an example on the development of aircraft technology.</p>
<blockquote>
<hr />
<p><strong>Example: The development of aircraft technology</strong><br />
How did aircraft technology develop during the 20th century? <span class="citation">Jane’s (<a href="#ref-janes_1978_book">1978</a>)</span> documents aircraft design for the first three quarters of the century. <span class="citation">Saviotti and Bowman (<a href="#ref-saviotti_1984_proc">1984</a>)</span> developed methods to track the evolution of these designs, using simple physical characteristics:</p>
<ul>
<li>total engine power (kW);</li>
<li>wing span (m);</li>
<li>length (m);</li>
<li>maximum take-off weight (kg);</li>
<li>maximum speed (km/h);</li>
<li>range (km).</li>
</ul>
<p>The data are available in the <code>aircraft</code> dataframe in the <code>sm</code> package. The year (<code>Yr) of the first appearance of each design is also provided, along with a broad categoriation (</code>Period`) into three periods (1 - 1914-1935, before the Second World War; 2 - 1936-1955, across the Second World War and its immediate aftermath; 3 - 1956-1984, the post-war period)</p>
<hr />
</blockquote>
<p>A brief look at the data suggests that the six measurements on each aircraft should be expressed on the log scale to reduce skewness. The code below uses the <code>across</code> function inside <code>mutate</code> to apply the log function to all the data in the specified columns.</p>
<p>The left hand plot below shows a histogram of the <code>Speed</code> variable for Period 3, which corresponds to the years after the second World War. The pattern of variability shown in the histogram suggests that there may be multiple modes, although it is difficult to judge between systematic shape and the inevitable detailed variation.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="trends-and-patterns.html#cb82-1" tabindex="-1"></a><span class="fu">library</span>(sm)</span>
<span id="cb82-2"><a href="trends-and-patterns.html#cb82-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb82-3"><a href="trends-and-patterns.html#cb82-3" tabindex="-1"></a>aircraft_log <span class="ot">&lt;-</span> aircraft <span class="sc">%&gt;%</span></span>
<span id="cb82-4"><a href="trends-and-patterns.html#cb82-4" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">8</span>, log), <span class="at">Period =</span> <span class="fu">factor</span>(Period))</span>
<span id="cb82-5"><a href="trends-and-patterns.html#cb82-5" tabindex="-1"></a>aircraft_log_3 <span class="ot">&lt;-</span> aircraft_log <span class="sc">%&gt;%</span></span>
<span id="cb82-6"><a href="trends-and-patterns.html#cb82-6" tabindex="-1"></a>   <span class="fu">filter</span>(Period <span class="sc">==</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="book_files/figure-html/speed_histograms-1.png" width="49%" /><img src="book_files/figure-html/speed_histograms-2.png" width="49%" /></p>
<p>The right hand plot above shows a histogram of the same data with minor changes in the settings: the intervals used for the histogram ‘bins’ have been specified through <code>brks &lt;- seq(5.2, 8.2, 0.1)</code> and then passed to the histogram geometry by <code>geom_histogram(breaks = brks)</code>. The width of the bins is very similar and the positions have simply been moved slightly to align with neat positions on the axis. The effect of this minor change on the detailed shape of the histogram seems surprisingly large. Other additions to this plot help in understanding why. A <em>rugplot</em> has been added at the bottom of the histogram by adding <code>geom_rug(sides = 'b')</code> to the <code>ggplot</code> layers. The gridlines placed over the plot (code not shown) highlight the fact that each observation has an associated ‘box’ placed over the interval in which the observation lies. As the placing of these intervals (or ‘bins’) changes, the boxes shift abruptly as observations fall in or out of different bins. This is a little unsatisfactory. From another perspective, it also loses a little information in the data as we throw away the precise location of each observation and use simply the location of the bin in which it lies.</p>
<p>One way of addressing this is to use boxes whose centres lie directly over each observation. A further modification is to replace the sharp edges of the box with a smooth shape (referred to as a <em>kernel function</em>) which will blend the information across the dataset to create a smooth pattern. The left hand plot below illustrates this (code not displayed) using a small sub-sample of the data so that the effects of each observation can be seen. When the kernel functions over the observations are added together, a smooth pattern emerges. This is referred to as a <em>density estimate</em> as it reflects the density of data across different locations on the axis. The right hand plot apples this to the full sample, through the <code>geom_density()</code> layer, resulting in a smooth representation of the underlying pattern.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="trends-and-patterns.html#cb83-1" tabindex="-1"></a>aircraft_log_3 <span class="sc">%&gt;%</span></span>
<span id="cb83-2"><a href="trends-and-patterns.html#cb83-2" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(Speed)) <span class="sc">+</span> <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb83-3"><a href="trends-and-patterns.html#cb83-3" tabindex="-1"></a>      <span class="fu">xlim</span>(<span class="fl">4.5</span>, <span class="fl">8.5</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&#39;log(Speed)&#39;</span>) <span class="sc">+</span> <span class="fu">geom_rug</span>(<span class="at">sides =</span> <span class="st">&#39;b&#39;</span>)</span></code></pre></div>
<p><img src="book_files/figure-html/speed_density_estimate-1.png" width="49%" /><img src="book_files/figure-html/speed_density_estimate-2.png" width="49%" /></p>
<!-- The histogram is a very familiar object.  It can be written as -->
<!-- $$ -->
<!--             \tilde{f}(y) = \sum_{i=1}^n I(y - \tilde{y}_i; h) , -->
<!-- $$ -->
<!-- where $\{y_1,\dots,y_n\}$ denote the observed data, $\tilde{y}_i$ denotes the centre of the interval in which $y_i$ falls and $I(z; h)$ is the indicator function of the interval $[-h, h]$. -->
<!-- (Notice that further scaling would be required to ensure that $\tilde{f}$ -->
<!-- integrates to $1$.)   -->
<!-- The form of the construction of $\tilde{f}$ highlights some features which are open to criticism if we view the histogram as an estimator of the underlying density function.  Firstly the histogram is not smooth, when we expect that the underlying density usually will be.  Secondly, some information is lost when we replace each observation $y_i$ by the bin mid-point $\tilde{y}_i$.  Both of the issues can be addressed by using a density estimator in the form -->
<!-- $$ -->
<!--      \hat{f}(y) = \frac{1}{n} \sum_{i=1}^n w(y-y_i;h) , -->
<!-- $$ -->
<!-- where  $w$ is  a probability density, called here a \textit{kernel function}, whose variance is controlled by the \textit{smoothing parameter} $h$.  The middle panel in the plots below shows the effects of doing this with the aircraft data.  Large changes in the value of the smoothing parameter have large effects on the smoothness of the resulting estimates, as the left and right hand plots below illustrate. -->
<p>There remains the issue of choosing a bandwidth to control the smoothness of the density estimate, through the breadth of the kernel function. If this is not specified, <code>geom_density</code> tries to make a good choice, but it can be valuable to look at the effects of applying different levels of smoothing. This question is the early manifestation of an issue which will reappear often in later discussions of model building, namely how complex should a model be. At this stage, in the simple setting of exploring data visually, the issue is not a pressing one. Indeed it is perfectly reasonable to view the data at different levels of smoothness to inspect the patterns which emerge at different scales. Approaches to decisions on complexity will be deferred to Chapter <a href="flexible-models.html#flexible-methods">12.1</a> in the context of more extensive model building.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="trends-and-patterns.html#cb84-1" tabindex="-1"></a>aircraft_log_3 <span class="sc">%&gt;%</span></span>
<span id="cb84-2"><a href="trends-and-patterns.html#cb84-2" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(Speed)) <span class="sc">+</span></span>
<span id="cb84-3"><a href="trends-and-patterns.html#cb84-3" tabindex="-1"></a>      <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> <span class="st">&quot;0.2&quot;</span>), <span class="at">bw =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb84-4"><a href="trends-and-patterns.html#cb84-4" tabindex="-1"></a>      <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> <span class="st">&quot;0.1&quot;</span>), <span class="at">bw =</span> <span class="fl">0.1</span>)  <span class="sc">+</span></span>
<span id="cb84-5"><a href="trends-and-patterns.html#cb84-5" tabindex="-1"></a>      <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> <span class="st">&quot;0.5&quot;</span>), <span class="at">bw =</span> <span class="fl">0.5</span>)  <span class="sc">+</span></span>
<span id="cb84-6"><a href="trends-and-patterns.html#cb84-6" tabindex="-1"></a>      <span class="fu">xlim</span>(<span class="fl">4.5</span>, <span class="fl">8.5</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&#39;log(Speed)&#39;</span>) <span class="sc">+</span> <span class="fu">geom_rug</span>(<span class="at">sides =</span> <span class="st">&#39;b&#39;</span>) <span class="sc">+</span></span>
<span id="cb84-7"><a href="trends-and-patterns.html#cb84-7" tabindex="-1"></a>      <span class="fu">scale_linetype_manual</span>(<span class="at">name =</span> <span class="st">&quot;bandwidth&quot;</span>,</span>
<span id="cb84-8"><a href="trends-and-patterns.html#cb84-8" tabindex="-1"></a>             <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;0.2&quot;</span> <span class="ot">=</span> <span class="st">&quot;solid&quot;</span>, <span class="st">&quot;0.1&quot;</span> <span class="ot">=</span> <span class="st">&quot;dashed&quot;</span>, <span class="st">&quot;0.5&quot;</span> <span class="ot">=</span> <span class="st">&quot;dotted&quot;</span>))</span></code></pre></div>
<p><img src="book_files/figure-html/aircraft_multiscale-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>An interactive display which allows animation across different levels of smoothing is available in <code>sm.density</code> function from the <code>sm</code> package.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="trends-and-patterns.html#cb85-1" tabindex="-1"></a><span class="fu">sm.density</span>(aircraft_log_3<span class="sc">$</span>Speed, <span class="at">xlab =</span> <span class="st">&quot;log(Speed)&quot;</span>, <span class="at">panel =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>One advantage of density estimates is that it is a simple matter to superimpose these to allow different groups to be compared. Here the groups for the three different time periods are plotted using colour fill (<code>fill</code>) and transparency (controlled by <code>alpha</code> which lies between 0 and 1) to enhance the comparison. There is a systematic movement to higher speeds from period 1 and 2 while in period 3 further increases may be specialising into particular designs, reflected in the multiple modes.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="trends-and-patterns.html#cb86-1" tabindex="-1"></a>aircraft_log <span class="sc">%&gt;%</span></span>
<span id="cb86-2"><a href="trends-and-patterns.html#cb86-2" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(Speed, <span class="at">col =</span> Period, <span class="at">fill =</span> Period)) <span class="sc">+</span></span>
<span id="cb86-3"><a href="trends-and-patterns.html#cb86-3" tabindex="-1"></a>      <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&#39;log(Speed)&#39;</span>)</span></code></pre></div>
<p><img src="book_files/figure-html/density_comparison_1d-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>There are other ways in which density estimates can be displayed. The plots below use density ridges <span class="citation">(<a href="#ref-wilke_2023_Rpackage">Wilke 2023</a>)</span> and violin plots <span class="citation">(<a href="#ref-hintze_1998_amerstat">Hintze and Nelson 1998</a>)</span> to display the information in innovative ways. The <code>sina</code> plot from the <code>ggforce</code> package uses <code>jitter</code> to separate the observations vertically, with the width of jitter controlled by the denisty estimate. This provides a display which achieves an attractive combination of raw data and underlying trend.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="trends-and-patterns.html#cb87-1" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb87-2"><a href="trends-and-patterns.html#cb87-2" tabindex="-1"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb87-3"><a href="trends-and-patterns.html#cb87-3" tabindex="-1"></a><span class="fu">ggplot</span>(aircraft_log, <span class="fu">aes</span>(Speed, Period)) <span class="sc">+</span></span>
<span id="cb87-4"><a href="trends-and-patterns.html#cb87-4" tabindex="-1"></a>   <span class="fu">geom_density_ridges</span>() <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&#39;log(Speed)&#39;</span>)</span>
<span id="cb87-5"><a href="trends-and-patterns.html#cb87-5" tabindex="-1"></a><span class="fu">ggplot</span>(aircraft_log, <span class="fu">aes</span>(Speed, Period)) <span class="sc">+</span></span>
<span id="cb87-6"><a href="trends-and-patterns.html#cb87-6" tabindex="-1"></a>   <span class="fu">geom_violin</span>() <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&#39;log(Speed)&#39;</span>)</span>
<span id="cb87-7"><a href="trends-and-patterns.html#cb87-7" tabindex="-1"></a><span class="fu">ggplot</span>(aircraft_log, <span class="fu">aes</span>(Speed, Period)) <span class="sc">+</span></span>
<span id="cb87-8"><a href="trends-and-patterns.html#cb87-8" tabindex="-1"></a>   <span class="fu">geom_sina</span>() <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&#39;log(Speed)&#39;</span>)</span></code></pre></div>
<p><img src="book_files/figure-html/density_displays-1.png" width="33%" /><img src="book_files/figure-html/density_displays-2.png" width="33%" /><img src="book_files/figure-html/density_displays-3.png" width="33%" /></p>
<p>The idea of density estimation extends very naturally to a wide variety of other types of data and sample spaces. For example, in the case of two-dimensional data on continuous scales, a smooth two-dimensional kernel function is placed over each observation and these are accumulated to provide a smooth two-dimensional density estimate. The plots below show <code>Speed</code> and <code>Span</code> from period 3 of the <code>aircraft</code> as a scattterplot and two forms of density estimate displays.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="trends-and-patterns.html#cb88-1" tabindex="-1"></a><span class="fu">ggplot</span>(aircraft_log_3, <span class="fu">aes</span>(Speed, Span)) <span class="sc">+</span></span>
<span id="cb88-2"><a href="trends-and-patterns.html#cb88-2" tabindex="-1"></a>   <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;log(Speed)&#39;</span>, <span class="at">y =</span><span class="st">&#39;log(Span)&#39;</span>)</span>
<span id="cb88-3"><a href="trends-and-patterns.html#cb88-3" tabindex="-1"></a><span class="fu">ggplot</span>(aircraft_log_3, <span class="fu">aes</span>(Speed, Span)) <span class="sc">+</span></span>
<span id="cb88-4"><a href="trends-and-patterns.html#cb88-4" tabindex="-1"></a>   <span class="fu">geom_density_2d_filled</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;log(Speed)&#39;</span>, <span class="at">y =</span><span class="st">&#39;log(Span)&#39;</span>)</span>
<span id="cb88-5"><a href="trends-and-patterns.html#cb88-5" tabindex="-1"></a>aircraft_log_3 <span class="sc">%&gt;%</span> <span class="fu">select</span>(Speed, Span) <span class="sc">%&gt;%</span></span>
<span id="cb88-6"><a href="trends-and-patterns.html#cb88-6" tabindex="-1"></a>   <span class="fu">smoothScatter</span>(<span class="at">bandwidth =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>),</span>
<span id="cb88-7"><a href="trends-and-patterns.html#cb88-7" tabindex="-1"></a>                 <span class="at">xlab =</span> <span class="st">&#39;log(Speed)&#39;</span>, <span class="at">ylab =</span><span class="st">&#39;log(Span)&#39;</span>)</span></code></pre></div>
<p><img src="book_files/figure-html/density_2d-1.png" width="33%" /><img src="book_files/figure-html/density_2d-2.png" width="33%" /><img src="book_files/figure-html/density_2d-3.png" width="33%" /></p>
<p>As in the one-dimensional case, the <code>sm.density</code> function from the <code>sm</code> package allows the effect of different bandwidths to be explored dynamically.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="trends-and-patterns.html#cb89-1" tabindex="-1"></a>aircraft_log_3 <span class="sc">%&gt;%</span> <span class="fu">select</span>(Speed, Span) <span class="sc">%&gt;%</span></span>
<span id="cb89-2"><a href="trends-and-patterns.html#cb89-2" tabindex="-1"></a>   <span class="fu">sm.density</span>(<span class="at">panel =</span> <span class="cn">TRUE</span>, <span class="at">panel.plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Finally, here is a comparison of the patterns of Speed and Span across the three periods, showing the evolution of these aspects of the designs.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="trends-and-patterns.html#cb90-1" tabindex="-1"></a><span class="fu">ggplot</span>(aircraft_log, <span class="fu">aes</span>(Speed, Span)) <span class="sc">+</span></span>
<span id="cb90-2"><a href="trends-and-patterns.html#cb90-2" tabindex="-1"></a>   <span class="fu">geom_density_2d_filled</span>() <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&#39;log(Speed)&#39;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&#39;log(Span)&#39;</span>) <span class="sc">+</span></span>
<span id="cb90-3"><a href="trends-and-patterns.html#cb90-3" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span> Period)</span></code></pre></div>
<p><img src="book_files/figure-html/2d_facets-1.png" width="90%" style="display: block; margin: auto;" /></p>
<!-- For example, a two-dimensional density estimate can be constructed from bivariate data $\{(y_{1i}, y_{2i}): i = 1, \ldots, n\}$ by employing a two-dimensional kernel function in the form -->
<!-- $$ -->
<!--    \hat{f}(y_1, y_2) = \frac{1}{n} \sum_{i=1}^n  -->
<!--                        w(y_1-y_{1i};h_1) \, -->
<!--                        w(y_1-y_{2i};h_2) . -->
<!-- $$ -->
<!-- Notice that there are now two smoothing parameters, $(h_1,h_2)$.  A more general two-dimensional kernel function could be used, but the simple product form is very convenient and usually very effective. -->
<!-- ```{r child = 'chapters/trends_and_patterns/density_estimation_properties.Rmd'} -->
<!-- ``` -->
</div>
<div id="flexible-regression" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Flexible regression<a href="trends-and-patterns.html#flexible-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<hr />
<p><strong>Example: the North Atlantic Oscillation</strong><br />
The North Atlantic Oscillation is an important atmospheric indicator which is linked to weather patterns. It is based on the difference in atmospheric pressure at sea level between Iceland and Portugal. Historical data on Winter NAO are available from the Natioanl Center for Atmospheric Research in the USA. A <a href="https://climatedataguide.ucar.edu/climate-data/hurrell-north-atlantic-oscillation-nao-index-station-based">description</a> of the dataset is available.</p>
<hr />
</blockquote>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="trends-and-patterns.html#cb91-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb91-2"><a href="trends-and-patterns.html#cb91-2" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="fu">rp.datalink</span>(<span class="st">&quot;NAO&quot;</span>)</span>
<span id="cb91-3"><a href="trends-and-patterns.html#cb91-3" tabindex="-1"></a>NAO  <span class="ot">&lt;-</span> <span class="fu">read.table</span>(path, <span class="at">header =</span> <span class="cn">FALSE</span>, <span class="at">skip =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb91-4"><a href="trends-and-patterns.html#cb91-4" tabindex="-1"></a>   <span class="fu">select</span>(<span class="at">Year =</span> <span class="dv">1</span>, <span class="at">NAO =</span> <span class="dv">2</span>)</span>
<span id="cb91-5"><a href="trends-and-patterns.html#cb91-5" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(NAO, <span class="fu">aes</span>(Year, NAO)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb91-6"><a href="trends-and-patterns.html#cb91-6" tabindex="-1"></a>p</span>
<span id="cb91-7"><a href="trends-and-patterns.html#cb91-7" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span>
<span id="cb91-8"><a href="trends-and-patterns.html#cb91-8" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="book_files/figure-html/NAO_flexible-1.png" width="33%" /><img src="book_files/figure-html/NAO_flexible-2.png" width="33%" /><img src="book_files/figure-html/NAO_flexible-3.png" width="33%" /></p>
<p>The plots above show the data and then a simple linear regression line as a means of summarising trend. The third plot shows a curve which seeks to track the trend in the data over time in a more flexible manner. This is donw through kernel functions of the type used in density estimation. At any time point of interest, these are used to construct a weighted mean, where the weights diminish with the distance of each observation from the point of interest. (In fact, it turns out to be more effective to fit a straight line model with these weights and to report where this line sits at the point of interest.) The plot above was constructed by using a <code>geom_smooth</code> layer. This uses a locally weighted linear method known as <code>loess</code> whose smoothness is controlled by a <code>span</code> argument.</p>
<p>The flexible curve suggests more movement in the Winter NAO over time. However, we need to investigate whether this might be simply due to random variation or whether there is real evidence of decline. Discussion of this important issue will begin in Chapter <a href="inference.html#inference">6</a>. (This is the reason for setting <code>se = FALSE</code> above, for the moment.)</p>
<blockquote>
<hr />
<p><strong>Example: Trawling near the Great Barrier Reef</strong><br />
Data are available from a survey of the fauna on the sea bed lying between the coast of northern Queensland and the Great Barrier Reef. The sampling region covered a zone which was closed to commercial fishing, as well as neighbouring zones where fishing was permitted.</p>
<p>The variables are:</p>
<ul>
<li><code>Zone</code> an indicator for the closed (1) and open (0) zones</li>
<li><code>Year</code> an indicator of 1992 (0) or 1993 (1)</li>
<li><code>Latitude</code> latitude of the sampling position</li>
<li><code>Longitude</code> longitude of the sampling position</li>
<li><code>Depth</code> bottom depth</li>
<li><code>Score1</code> catch score 1</li>
<li><code>Score2</code> catch score 2</li>
</ul>
<p>Interest lies in which of the explanatory variables affects the principal catch score (<code>Score1</code>). The data <code>are available in the</code>trawl<code>dataframe in the</code>sm` package.</p>
<hr />
</blockquote>
<p>A plot of <code>Score1</code> against <code>Longitude</code> suggests a linear relationship, as a first approximation. However, there is no compelling reason that the trend should be linear anda more flexible curve highlights a different pattern. The <code>Longitude</code> variable is essentially a proxy for ‘distance offshore’ in this region and it may be that the mean score remains high for some distance offshore and then decreases rapidly. That has biological plausibility.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="trends-and-patterns.html#cb92-1" tabindex="-1"></a><span class="fu">library</span>(sm)</span>
<span id="cb92-2"><a href="trends-and-patterns.html#cb92-2" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(trawl, <span class="fu">aes</span>(Longitude, Score1)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb92-3"><a href="trends-and-patterns.html#cb92-3" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span>
<span id="cb92-4"><a href="trends-and-patterns.html#cb92-4" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="book_files/figure-html/flex_reg_longitude-1.png" width="49%" /><img src="book_files/figure-html/flex_reg_longitude-2.png" width="49%" /></p>
<p>You can experiment with this kind of model interactively by issing the instruction
<code>sm.regression((trawl$Longitude, trawl$Score1, panel = TRUE)</code>
This requires the <code>rpanel</code> and <code>tkrplot</code> packages to be installed.</p>
<p>The idea of creating flexible patterns by considering the data locally extends to other settings. In particular, this can be done with two covariates simultaneously. The code below uses the <code>sm.regression</code> function from the <code>sm</code> package to create a flexible surface which gives a description of how the mean catch score change across longitude and latitude simultaneously.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="trends-and-patterns.html#cb93-1" tabindex="-1"></a>trawl1   <span class="ot">&lt;-</span> <span class="fu">filter</span>(trawl, Year <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> Zone <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb93-2"><a href="trends-and-patterns.html#cb93-2" tabindex="-1"></a>Position <span class="ot">&lt;-</span> <span class="fu">cbind</span>(trawl1<span class="sc">$</span>Latitude, <span class="sc">-</span>trawl1<span class="sc">$</span>Longitude)</span>
<span id="cb93-3"><a href="trends-and-patterns.html#cb93-3" tabindex="-1"></a><span class="fu">sm.regression</span>(Position, trawl1<span class="sc">$</span>Score1,</span>
<span id="cb93-4"><a href="trends-and-patterns.html#cb93-4" tabindex="-1"></a>              <span class="at">xlab =</span> <span class="st">&quot;-Latitude&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Longitude&quot;</span>, <span class="at">zlab =</span> <span class="st">&quot;Score&quot;</span>)</span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-480-1.png" width="75%" style="display: block; margin: auto;" /></p>
<!-- Notice the use of the same smoothing parameter in each dimension through the `structure.2d="common"` parameter. (This has been removed.) -->
<p>As a final example, we will revisit the <code>rodent</code> dataset was introduced in Section <a href="R-introduction.html#taste-of-r">2.2</a>. In fact this is only part of a larger dataset on mammals, available in <code>mammal_speed</code>. Interestingly, the positive connection between mass and speed for rodents does not carry through for all mammals. For the heaviest mammals, speed stabilises and then tails off as mass increases. At what mass is speed heaviest, on average? A smooth curve description of the underlying relationship allows us to quantify this, without making any detailed assumptions on what the shape of this relationship should be. For the moment, we can simply inspect the plot to see that the maximum occurs at a mass around 4.5 on the log scale, and so <code>exp(4.5) = 90</code> on the mass scale.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="trends-and-patterns.html#cb94-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb94-2"><a href="trends-and-patterns.html#cb94-2" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="fu">rp.datalink</span>(<span class="st">&quot;mammal_speed&quot;</span>)</span>
<span id="cb94-3"><a href="trends-and-patterns.html#cb94-3" tabindex="-1"></a><span class="fu">load</span>(path)</span>
<span id="cb94-4"><a href="trends-and-patterns.html#cb94-4" tabindex="-1"></a></span>
<span id="cb94-5"><a href="trends-and-patterns.html#cb94-5" tabindex="-1"></a><span class="fu">ggplot</span>(mammalSpeed, <span class="fu">aes</span>(<span class="fu">log</span>(Mass), <span class="fu">log</span>(Speed))) <span class="sc">+</span></span>
<span id="cb94-6"><a href="trends-and-patterns.html#cb94-6" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> Family)) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="book_files/figure-html/mammalSpeed-1.png" width="70%" style="display: block; margin: auto;" /></p>
<!-- When the data sometimes have a shape which is not easily described by a simple parametric functional form, a *nonparametric* model is required.  This can be written as -->
<!-- $$ -->
<!--       y_i = m(x_i) + \varepsilon_i, -->
<!-- $$ -->
<!-- where the data $(x_i,y_i)$ are described by a smooth curve $m$ plus independent errors $\varepsilon_i$. -->
<!-- In order to build on the methods described for density estimation, we will begin by considering *local linear regression*.  This involves solving the least squares problem -->
<!-- $$ -->
<!--         \min_{\alpha, \beta} \sum_{i=1}^n -->
<!--                 \{y_i - \alpha - \beta (x_i - x)\}^2 \, w(x_i-x\,;h) -->
<!-- $$ -->
<!-- and taking as the estimate at $x$ the value of $\hat{\alpha}$, as this defines the position of the local regression line at the point $x$.  This has an appealing simplicity and it can be generalised quite easily to other situations. -->
<!-- There are many other ways of approaching the problem of estimating $m$.  For example, we might use a set of functions which provide a set of local building blocks.  B-splines, which are made up on polynomial pieces, provide a convenient and efficient option.  A curve estimate can then be produced by fitting the regression -->
<!-- $$ -->
<!--      Y_i = \beta_0 + \beta_1 b_1(x_i) + \beta_p b_2(x_i) + \ldots + \beta_p -->
<!--               b_p(x_i) + \varepsilon_i , -->
<!-- $$ -->
<!-- where the $b_i$ are the local b-spline functions. This approach will form the basis of more general *additive models* to be discussed later. -->
<!-- ## Some simple properties -->
<!-- One inevitable consequence of smoothing is that the estimate we produce will be biased when the underlying trend is curved.  That is apparent if, for example, a very large smoothing parameter is used. -->
<!-- The solution of the least-squares problem which defines a local linear estimator is available from standard linear model theory, incorporating the weights as an additional feature.  The curve estimator can then be expressed as -->
<!-- $$ -->
<!--         \hat{m} = S y , -->
<!-- $$ -->
<!-- where $S$ is a large matrix of constants, derived from the $x_i$'s and the weight function $w$.  The matrix $S$ is referred to as the *smoothing matrix*. -->
<!-- A precise definition can be given to this using vector-matrix notation, -->
<!-- where $\hat{m}$ denotes the vector of estimates at a set of evaluation -->
<!-- points of interest, $S$ denotes a *smoothing matrix* whose rows -->
<!-- consist of the weights appropriate to estimation at each evaluation -->
<!-- point, and $y$ denotes the observed responses in vector form. -->
<!-- However, if you are not familiar with matrix notation simply regard -->
<!-- $S$ as a *smoothing operator* which produces a fitted smooth -->
<!-- curve $\hat{m}$ from the data $y$. -->
<!-- The residual sum-of-squares is simply -->
<!-- $$ -->
<!--         \mbox{RSS} = \sum \{y_i - \hat{m}(x_i)\}^2 . -->
<!-- $$ -->
<!-- The $RSS$ is a measure of how well the model fits the data and this can also be used to provide an estimate of the variance $\sigma^2$ of the errors $\varepsilon_i$.  We can work by analogy with what happens with the usual linear model where *degrees of freedom* play an important role.  An approximate version of these can be constructed for nonparametric models as -->
<!-- $$ -->
<!--           \mbox{df} = \mbox{tr}{S} -->
<!-- $$ -->
<!-- leading to the estimator of the error variance -->
<!-- $$ -->
<!--         \hat{\sigma}^2 = \mbox{RSS} / \mbox{df} . -->
<!-- $$ -->
<!-- ## How much to smooth? -->
<!-- One of the key questions with nonparametric models is how much smoothing to apply to the data.  For exploratory work, it can often be helpful simply to experiment with different degrees of smoothing.  One appealing way to do that is to specify how many *degrees of freedom* are appropriate.  We will defer the technical discussion of how the degrees of freedom are calculated but it can be thought of an analogous to the number of parameters in a standard model.  This puts things on a natural scale.  We can do that by -->
<!-- ```{r flexreg_trawl, eval = FALSE} -->
<!--       sm.regression(trawl$Longitude, trawl$Score1, df = 4) -->
<!-- ``` -->
<!-- However, in more complicated situations that can be difficult and it is helpful to have an automatic way of producing a suitable level of smoothing.  There are several ways to do this, some of which are carefully tailored to particular models.  Here we will outline a method called *cross-validation* which, although it has some difficulties, has the advantage that the generality of its definition allows it to be applied to quite a wide variety of settings. -->
<!-- In the present setting, the idea is to choose $h$ to minimise -->
<!-- $$ -->
<!--       \sum_{i=1}^n \{y_i - \hat{m}_{-i}(x_i)\}^2 . -->
<!-- $$ -->
<!-- The subscript $-i$ denotes that the estimate of the smooth curve estimate $\hat{m}$ at $x_i$ is constructed from the remainder of the data, excluding $x_i$.  The aim then is to evaluate the level of smoothing through the extent to which each observation is predicted from the smooth curve produced by the rest of the data.  The degrees of freedom which minimises the expression above should provide a suitable level of smoothing. -->
<!-- ## Smoothing in two dimensions -->
<!-- It can often be of interest to smooth over two covariates simultaneously, for example when dealing with a response variable defined over geographical co-ordinates.  The local linear approach is particularly easy to extend to this setting.  If the observed data are denoted by -->
<!-- $\{x_{1i}, x_{2i}, y_i; i=1, \dots, n\}$, then for estimation at the point $(x_1,x_2)$ the -->
<!-- weighted least squares formulation is -->
<!-- $$ -->
<!--         \min_{\alpha, \beta, \gamma} \sum_{i=1}^n -->
<!--                 \{y_i - \alpha - \beta (x_{1i} - x_1) - -->
<!--                                         \gamma (x_{2i} - x_2) \}^2 -->
<!--                 \, w(x_{1i}-x_1;h_1)  \, w(x_{2i}-x_2;h_2) . -->
<!-- $$ -->
<!-- The value of the fitted surface at $(x_1,x_2)$ is simply $\hat{\alpha}$.  This is illustrated below with one year of Reef data from the closed zone. -->
<!-- ## Smoothing non-normal data -->
<!-- A natural extension to non-normal data is to apply weights to the log-likelihood rather than the sum-of-squares as -->
<!-- $$ -->
<!--          \sum_i \ell_i(\alpha,\beta) \, w(x_i-x;h) , -->
<!-- $$ -->
<!-- where $\ell_i(\alpha,\beta)$ is the contribution to the usual log-likelihood from the $i$th observation.  For example, in the case of logistic regression for binary responses, we have the model -->
<!-- $$ -->
<!--   \log\left(\frac{p_i}{1-p_i}\right) -->
<!--               = \alpha+ \beta x_i \qquad (i=1,\ldots,n) -->
<!-- $$ -->
<!-- and then the likelihood contributions -->
<!-- $$ -->
<!--   \ell_i(\alpha,\beta) = y_i\,\log\left(\frac{p_i}{1-p_i}\right)+\log(1-p_i) . -->
<!-- $$ -->
<!-- Here $p_i$ denotes the probability of a $1$ at design point $x_i$, and as usual the logit link function is assumed to relate $p_i$ to a linear predictor in $x_i$.  Maximisation of the weighted likelihood with respect to $(\alpha, \beta)$ provides local estimates $(\hat\alpha, \hat\beta)$ and by solving the model definition for $p$ we obtain a fitted value -->
<!-- $$ -->
<!--    \hat{m}(x) =\frac{\exp(\hat\alpha+\hat\beta x)} -->
<!--                  {1+\exp(\hat\alpha+\hat\beta x)} . -->
<!-- $$ -->
<!-- This sounds a bit complicated but it is really just fitting a glm locally by using weights to pay attention only to data points which are near the point of interest $x$.  The procedure will be illustrated with the worm data described in -->
<!-- the lecture. -->
<!-- ```{r echo = FALSE, out.width = '50%'} -->
<!-- par(mar = c(3, 3, 1, 1), mgp = c(1.2, 0.2, 0), tcl = -0.2) -->
<!-- with(worm, { -->
<!-- Males   <- sm.binomial(Age[Sex == 1], Infection[Sex == 1], h = 10, -->
<!--               display = "none") -->
<!-- agem    <- Males$eval.points -->
<!-- Females <- sm.binomial(Age[Sex == 2], Infection[Sex == 2], h = 10, -->
<!--               eval.points = agem, display = "none") -->
<!-- estm <- Males$estimate -->
<!-- sem  <- Males$se -->
<!-- estf <- Females$estimate -->
<!-- sef  <- Females$se -->
<!-- plot(Age, Infection, ylab = "Proportion infected", type= "n") -->
<!-- av <- (log(estm/(1-estm)) + log(estf/(1-estf)))/2 -->
<!-- se <- sqrt(sem^2 + sef^2) -->
<!-- upper <- 1/(1+exp(-(av + se))) -->
<!-- lower <- 1/(1+exp(-(av - se))) -->
<!-- polygon(c(agem, rev(agem)), c(upper, rev(lower)), -->
<!--       col = "cyan", border = FALSE) -->
<!-- lines(agem, estm) -->
<!-- lines(agem, estf, lty = 3) -->
<!-- }) -->
<!-- ``` -->
</div>
<div id="further-reading-3" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Further reading<a href="trends-and-patterns.html#further-reading-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Bowman, A.W. and Azzalini, A. (1996).
OUP: Oxford.</p>
<p>Green, P.J. and Silverman, B.W. (1994).
.
Chapman &amp; Hall: London.</p>
<p>Hastie, T. and Tibshirani, R. (1990).
. Chapman &amp; Hall: London.</p>
<p>Ruppert, D., Wand, M.P. and Carroll, R.J. (2003).
.
CUP: Cambridge.</p>
<p>Wood, S. (2017) <em>Generalized Additive Models: an introduction with R.</em>
CRC Press.</p>
</div>
<div id="exercises-4" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Exercises<a href="trends-and-patterns.html#exercises-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="exercise-conservation-density-displays" class="section level3 hasAnchor" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Does conservation work?<a href="trends-and-patterns.html#exercise-conservation-density-displays" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A recent paper in <em>Science</em> by <span class="citation">Langhammer et al. (<a href="#ref-langhammer_2024_science">2024</a>)</span> reviewed a large number of studies of conservation projects in order to evaluate what benefit these have brought. To allow comparisons among projects which have operated over different timescales, the principal response variable was the rate of improvement in the relevant outcome. This was expressed in a standardised ‘effect size’ scale. Links are available for the <a href="https://data.kent.ac.uk/146/6/Data%20from%20Langhammer%20et%20al.csv?download=1">data</a> and a <a href="https://data.kent.ac.uk/146/5/Read%20me%20R2.txt?download=1">description</a> of the recorded variables.</p>
<ul>
<li>Read the data. The response variables of interest is in column 11. Rename this as ‘Effect size’.</li>
<li>Construct a suitable plot to show how <code>Effect size</code> varies across the different types of <code>Intervention</code> considered. In particular, consider plots based on density estimation (<code>geom_violin</code>, <code>geom_sina</code>). What plot would you recommend?</li>
</ul>
</div>
<div id="the-spatial-distribution-of-laryngeal-cancer-smoothing" class="section level3 hasAnchor" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> The spatial distribution of laryngeal cancer (<em>smoothing</em>)<a href="trends-and-patterns.html#the-spatial-distribution-of-laryngeal-cancer-smoothing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>lcancer</code> dataframe in the <code>sm</code> package contains data which record the spatial positions of cases of laryngeal cancer in the North-West of England between 1974 and 1983, together with the positions of a number of lung cancer patients who were used as controls. The data have been adjusted to preserve anonymity. See the help file for details. It may be more convenient to divide the <code>Easting</code> and <code>northing</code> variables by 10000 to provide neater scales for plotting.</p>
<ul>
<li>Use the <code>cbind</code> function to create a matrix which has two columns containing the <code>Easting</code> and <code>Northing</code> values for the cases alone, and another to do the same thing for the controls. (You may need to consult the help file for <code>cbind</code>.)</li>
<li>Draw a density estimate for the cases by passing the first matrix to the sm.density function, with <code>display = "image"</code>. Experiment with different values of the argument <code>h</code> which controls the degree of smoothing. This needs to be a vector of length two as there are two variables present. The value <code>h = rep(0.12, 2)</code> should work reasonably well but experiment with others.</li>
<li>Superimpose a density estimate for the controls by calling <code>sm.density</code> with the second matrix, with <code>display = "slice"</code> and with the additional argument <code>add = TRUE</code> to superimpose contours on the plot.</li>
<li>Consider what the comparison of these two density estimates tells you.</li>
</ul>
</div>
<div id="aircraft-data" class="section level3 hasAnchor" number="5.4.3">
<h3><span class="header-section-number">5.4.3</span> Aircraft data<a href="trends-and-patterns.html#aircraft-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the lecture notes, a density estimate of log(Speed) and log(Span) from the <code>aircraft</code> data , for the third time period, was found to be trimodal. Produce density estimates for the first two time periods and explore whether multimodality is also present there. (Hint: you may wish to consider whether <code>facet_wrap</code> might help.)</p>
<!-- ## Variability bands -->
<!-- Verify the result discussed in the lecture notes that -->
<!-- $$ -->
<!--     Var \left\{\sqrt{\hat{f}(y)} \right\} \approx \frac{1}{4} \frac{1}{nh} \, \alpha(w) . -->
<!-- $$ -->
<!-- ```{r eval = solutions, echo = FALSE} -->
<!-- txt <- " -->
<!-- *Solution* -->
<!-- When $t$ is the square root transformation, $t'(x) = 1 / (2 \\sqrt{x})$.  Also, the first term in the Taylor series approximation to $E\\left\\{\\hat{f}(y) \\right\\}$ is $f(y)$. So -->
<!-- $$ -->
<!--       Var \\left\\{\\sqrt{\\hat{f}(y)} \\right\\} \\approx \\frac{1}{nh} f(y) \\alpha(w) \\, -->
<!--                            \\left\\{ \\frac{1}{2 \\sqrt{f(y)}} \\right\\}^2 -->
<!--                            = \\frac{1}{4} \\frac{1}{nh} \\alpha(w) . -->
<!-- $$ -->
<!-- " -->
<!-- ``` -->
<!--  -->
<!-- ## Circular data -->
<!-- If you were given a sample of circular data, consisting of angles (in radians) between $0$ and $2\pi$ (where, of course, these two end points are coincident), how could you construct a smooth density estimate by choice of an appropriate kernel function?  (Hint: the von Mises distribution provides a natural model for a distribution on a circle.) -->
<!-- ```{r eval = solutions, echo = FALSE} -->
<!-- txt <- " -->
<!-- *Solution* -->
<!-- A weight function for circular data is provided by the von Mises density funtion -->
<!-- $$ -->
<!--       w(y - y_i; h) = \\frac{1}{2 \\pi I_0(h)} \\exp(h \\cos(y - y_i)) , -->
<!-- $$ -->
<!-- where the observations $y_i$ lie in the range $[0, 2 \\pi]$. -->
<!-- The following code should compute this, where `y` represents the evaluation point and `yvec` the vector of observations: -->
<!-- " -->
<!-- ``` -->
<!--  -->
<!-- ```{r eval = FALSE, echo = solutions} -->
<!-- mean(exp(h * cos(y - yvec)) / (2 * pi * besselI(h, 0))) -->
<!-- ``` -->
<!-- Can you write some code in R which will construct a density estimate from a sample of circular data. (Hint: you might find the R function `besselI` useful.) -->
</div>
<div id="radiocarbon-data" class="section level3 hasAnchor" number="5.4.4">
<h3><span class="header-section-number">5.4.4</span> Radiocarbon data<a href="trends-and-patterns.html#radiocarbon-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This dataset refers to the calibration required with radiocarbon dating. The datset <code>radioc</code> is available in the <code>sm</code> package and details can be obtained by issuing the instruction <code>?radioc</code>.</p>
<ol style="list-style-type: decimal">
<li>Create a subset of the data which corresponds to <code>Cal.age</code> between 2000 and 3000 years. Experiment with values of the smoothing parameter <code>h</code>, or equivalently the degrees of freedom parameter <code>df</code>. (Ignore the <code>Precision</code> information at this stage.)</li>
<li>What happens as <span class="math inline">\(h\)</span> becomes very large (or df becomes very small)?</li>
<li>What level of smoothing would you chose to provide a good description of the calibration curve?</li>
<li>What level of smoothing does the crossvalidation method suggest?</li>
</ol>
</div>
<div id="follicle-data" class="section level3 hasAnchor" number="5.4.5">
<h3><span class="header-section-number">5.4.5</span> Follicle data<a href="trends-and-patterns.html#follicle-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>follicle</code> dataset is available in the <code>sm</code> package. This records information on the number of ovarian follicles counted from sectioned ovaries of women of various ages. See <code>?follicle</code> for some details.</p>
<p>A <em>variability band</em> for the regression curve indicates the precision in the estimation of the curve at different locations. This can be constructed simply by adding the argument <code>display = "se"</code> to the <code>sm.regression</code> function call. Use this to identify features of the data which cause the changes in the width of the curve. Construct a density estimate to show how the density of the age information changes.</p>
<!-- ```{r child = 'chapters/trends_and_patterns/exercises/hyde.Rmd'} -->
<!-- ``` -->

</div>
</div>
</div>



</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-hintze_1998_amerstat" class="csl-entry">
Hintze, Jerry L, and Ray D Nelson. 1998. <span>“Violin Plots: A Box Plot-Density Trace Synergism.”</span> <em>American Statistician</em> 52 (2): 181–84.
</div>
<div id="ref-janes_1978_book" class="csl-entry">
Jane’s. 1978. <em>Jane’s Encyclopedia of Aviation</em>. London: Jane’s.
</div>
<div id="ref-langhammer_2024_science" class="csl-entry">
Langhammer, Penny F, Joseph W Bull, Jake E Bicknell, Joseph L Oakley, Mary H Brown, Michael W Bruford, Stuart HM Butchart, et al. 2024. <span>“The Positive Impact of Conservation Action.”</span> <em>Science</em> 384 (6694): 453–58.
</div>
<div id="ref-saviotti_1984_proc" class="csl-entry">
Saviotti, P P, and A W Bowman. 1984. <span>“Indicators of Output of Technology.”</span> In <em>Proceedings of the ICSSR/SSRC Workshop on Science and Technology in the 1980’s</em>, edited by M Gibbons et al., 117–47. Brighton: Harvester Press.
</div>
<div id="ref-wilke_2023_Rpackage" class="csl-entry">
Wilke, Claus O. 2023. <em>Ggridges: Ridgeline Plots in ’Ggplot2’</em>. <a href="https://CRAN.R-project.org/package=ggridges">https://CRAN.R-project.org/package=ggridges</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-visualisation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="inference.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["book.pdf", "book.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
