<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.5 Variability bands for flexible regression | Statistical Modelling</title>
  <meta name="description" content="A conceptual, visual and practical introduction to statistical modelling" />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="2.5 Variability bands for flexible regression | Statistical Modelling" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A conceptual, visual and practical introduction to statistical modelling" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.5 Variability bands for flexible regression | Statistical Modelling" />
  
  <meta name="twitter:description" content="A conceptual, visual and practical introduction to statistical modelling" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="hypothesis-tests.html"/>
<link rel="next" href="further-reading-1.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A visual and conceptual introduction to statistical modelling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface: what’s the problem?</a></li>
<li class="chapter" data-level="1" data-path="where-data.html"><a href="where-data.html"><i class="fa fa-check"></i><b>1</b> Where do data come from?</a>
<ul>
<li class="chapter" data-level="1.1" data-path="examples-data.html"><a href="examples-data.html"><i class="fa fa-check"></i><b>1.1</b> Some examples of data</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="examples-data.html"><a href="examples-data.html#co2-and-global-warming"><i class="fa fa-check"></i><b>1.1.1</b> CO2 and global warming</a></li>
<li class="chapter" data-level="1.1.2" data-path="examples-data.html"><a href="examples-data.html#the-first-tuberculosis-trial"><i class="fa fa-check"></i><b>1.1.2</b> The first tuberculosis trial</a></li>
<li class="chapter" data-level="1.1.3" data-path="examples-data.html"><a href="examples-data.html#the-birds-and-the-bees-how-to-tell-the-sex-of-a-herring-gull"><i class="fa fa-check"></i><b>1.1.3</b> The birds and the bees: how to tell the sex of a herring gull</a></li>
<li class="chapter" data-level="1.1.4" data-path="examples-data.html"><a href="examples-data.html#tracking-the-covid-pandemic"><i class="fa fa-check"></i><b>1.1.4</b> Tracking the covid pandemic</a></li>
<li class="chapter" data-level="1.1.5" data-path="examples-data.html"><a href="examples-data.html#more-complex-data-objects"><i class="fa fa-check"></i><b>1.1.5</b> More complex data objects</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="some-broad-issues.html"><a href="some-broad-issues.html"><i class="fa fa-check"></i><b>1.2</b> Some broad issues</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="some-broad-issues.html"><a href="some-broad-issues.html#whats-the-problem"><i class="fa fa-check"></i><b>1.2.1</b> What’s the problem?</a></li>
<li class="chapter" data-level="1.2.2" data-path="some-broad-issues.html"><a href="some-broad-issues.html#whats-the-plan"><i class="fa fa-check"></i><b>1.2.2</b> What’s the plan?</a></li>
<li class="chapter" data-level="1.2.3" data-path="some-broad-issues.html"><a href="some-broad-issues.html#where-data-subsection"><i class="fa fa-check"></i><b>1.2.3</b> Where do the data come from?</a></li>
<li class="chapter" data-level="1.2.4" data-path="some-broad-issues.html"><a href="some-broad-issues.html#who-do-you-trust"><i class="fa fa-check"></i><b>1.2.4</b> Who do you trust?</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="what-could-possibly-go-wrong.html"><a href="what-could-possibly-go-wrong.html"><i class="fa fa-check"></i><b>1.3</b> What could possibly go wrong?</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="what-could-possibly-go-wrong.html"><a href="what-could-possibly-go-wrong.html#us-presidential-elections-1936-and-1948"><i class="fa fa-check"></i><b>1.3.1</b> US presidential elections, 1936 and 1948</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="further-reading.html"><a href="further-reading.html"><i class="fa fa-check"></i><b>1.4</b> Further reading</a></li>
<li class="chapter" data-level="1.5" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>1.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="exercises.html"><a href="exercises.html#an-investigation-of-short-term-memory"><i class="fa fa-check"></i><b>1.5.1</b> An investigation of short-term memory</a></li>
<li class="chapter" data-level="1.5.2" data-path="exercises.html"><a href="exercises.html#a-survey-of-dental-health"><i class="fa fa-check"></i><b>1.5.2</b> A survey of dental health</a></li>
<li class="chapter" data-level="1.5.3" data-path="exercises.html"><a href="exercises.html#hearings-aid-and-dementia"><i class="fa fa-check"></i><b>1.5.3</b> Hearings aid and dementia</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Statistical Inference</b></span></li>
<li class="chapter" data-level="2" data-path="inference.html"><a href="inference.html"><i class="fa fa-check"></i><b>2</b> Inference: turning data into evidence</a>
<ul>
<li class="chapter" data-level="2.1" data-path="samples-and-populations.html"><a href="samples-and-populations.html"><i class="fa fa-check"></i><b>2.1</b> Samples and populations</a></li>
<li class="chapter" data-level="2.2" data-path="quantifying-uncertainty-standard-error.html"><a href="quantifying-uncertainty-standard-error.html"><i class="fa fa-check"></i><b>2.2</b> Quantifying uncertainty: standard error</a></li>
<li class="chapter" data-level="2.3" data-path="confidence-intervals.html"><a href="confidence-intervals.html"><i class="fa fa-check"></i><b>2.3</b> Confidence intervals</a></li>
<li class="chapter" data-level="2.4" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html"><i class="fa fa-check"></i><b>2.4</b> Hypothesis tests</a></li>
<li class="chapter" data-level="2.5" data-path="variability-bands-for-flexible-regression.html"><a href="variability-bands-for-flexible-regression.html"><i class="fa fa-check"></i><b>2.5</b> Variability bands for flexible regression</a></li>
<li class="chapter" data-level="2.6" data-path="further-reading-1.html"><a href="further-reading-1.html"><i class="fa fa-check"></i><b>2.6</b> Further reading</a></li>
<li class="chapter" data-level="2.7" data-path="quantifying-uncertainty-exercises.html"><a href="quantifying-uncertainty-exercises.html"><i class="fa fa-check"></i><b>2.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="quantifying-uncertainty-exercises.html"><a href="quantifying-uncertainty-exercises.html#standard-errors"><i class="fa fa-check"></i><b>2.7.1</b> Standard errors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="other-approaches-to-inference.html"><a href="other-approaches-to-inference.html"><i class="fa fa-check"></i><b>3</b> Other approaches to inference</a>
<ul>
<li class="chapter" data-level="3.1" data-path="computational-inference.html"><a href="computational-inference.html"><i class="fa fa-check"></i><b>3.1</b> Computational inference</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="computational-inference.html"><a href="computational-inference.html#simulation-methods"><i class="fa fa-check"></i><b>3.1.1</b> Simulation methods</a></li>
<li class="chapter" data-level="3.1.2" data-path="computational-inference.html"><a href="computational-inference.html#randomisation-tests"><i class="fa fa-check"></i><b>3.1.2</b> Randomisation tests</a></li>
<li class="chapter" data-level="3.1.3" data-path="computational-inference.html"><a href="computational-inference.html#the-bootstrap"><i class="fa fa-check"></i><b>3.1.3</b> The bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="bayesian-inference.html"><a href="bayesian-inference.html"><i class="fa fa-check"></i><b>3.2</b> Bayesian inference</a></li>
<li class="chapter" data-level="3.3" data-path="exercises-1.html"><a href="exercises-1.html"><i class="fa fa-check"></i><b>3.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="exercises-1.html"><a href="exercises-1.html#coverage-property-of-bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>3.3.1</b> Coverage property of bootstrap confidence intervals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="inference-with-categorical-data.html"><a href="inference-with-categorical-data.html"><i class="fa fa-check"></i><b>4</b> Inference with categorical data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="simple-proportions.html"><a href="simple-proportions.html"><i class="fa fa-check"></i><b>4.1</b> Simple proportions</a></li>
<li class="chapter" data-level="4.2" data-path="comparing-proportions.html"><a href="comparing-proportions.html"><i class="fa fa-check"></i><b>4.2</b> Comparing proportions</a></li>
<li class="chapter" data-level="4.3" data-path="contingency-tables.html"><a href="contingency-tables.html"><i class="fa fa-check"></i><b>4.3</b> Contingency tables</a></li>
<li class="chapter" data-level="4.4" data-path="exercises-2.html"><a href="exercises-2.html"><i class="fa fa-check"></i><b>4.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="exercises-2.html"><a href="exercises-2.html#opinion-polls"><i class="fa fa-check"></i><b>4.4.1</b> Opinion polls</a></li>
<li class="chapter" data-level="4.4.2" data-path="exercises-2.html"><a href="exercises-2.html#respiratory-disease-in-infancy"><i class="fa fa-check"></i><b>4.4.2</b> Respiratory disease in infancy</a></li>
<li class="chapter" data-level="4.4.3" data-path="exercises-2.html"><a href="exercises-2.html#smoking-and-lung-cancer"><i class="fa fa-check"></i><b>4.4.3</b> Smoking and lung cancer</a></li>
<li class="chapter" data-level="4.4.4" data-path="exercises-2.html"><a href="exercises-2.html#confidence-intervals-and-p-values"><i class="fa fa-check"></i><b>4.4.4</b> Confidence intervals and p-values</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Modelling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="variability-bands-for-flexible-regression" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Variability bands for flexible regression<a href="variability-bands-for-flexible-regression.html#variability-bands-for-flexible-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In earlier work the idea of a flexible regression curve was introduced as a means of highlighting the underlying trend in simple regression data. It is very helpful to quantify the uncertainty in these curves so that we can begin to assess which features may be simply due to random variation and which may indicate real underlying patterns. We can use our new tools to help us.</p>
<p>The curve estimate is simply a linear combination of the data values <span class="math inline">\(y\)</span> and this makes it very easy to produce standard errors which quantify the variability of the curve at any value of <span class="math inline">\(x\)</span>. Unfortunately, we can’t easily produce confidence intervals for the curve because the process of ‘smoothing’ introduces some bias. However, by adding and subtracting two standard errors at each point on the curve we can produce <em>variability bands</em> which express the variation in the curve estimate. This can be implemented in R by adding the argument <code>display  = 'se'</code> to the <code>sm.regression</code> call.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="variability-bands-for-flexible-regression.html#cb8-1" tabindex="-1"></a><span class="fu">library</span>(sm)</span>
<span id="cb8-2"><a href="variability-bands-for-flexible-regression.html#cb8-2" tabindex="-1"></a><span class="fu">sm.regression</span>(trawl<span class="sc">$</span>Longitude, trawl<span class="sc">$</span>Score1, <span class="at">display =</span> <span class="st">&quot;se&quot;</span>)</span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-82-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Sometime we want to compare curves, at least informally, and we can use the standard errors from each curve to do that. At any point <span class="math inline">\(x\)</span>, the standard error of the difference between the curves is <span class="math inline">\(se_d(x) = \sqrt{se_1(x)^2 + se_2(x)^2}\)</span>, where <span class="math inline">\(se_1(x)\)</span> and <span class="math inline">\(se_2(x)\)</span> denote the standard errors of each curve at that point. A neat trick is to plot a band whose width is <span class="math inline">\(2 se_d(x)\)</span>. By centering this band at the average of the two curves we can see where they are more than two standard errors apart. We can see this with the Reef data separated into two groups corresponding to open and closed fishing zones, by running the prepared script <code>sm.script(trwlband)</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="variability-bands-for-flexible-regression.html#cb9-1" tabindex="-1"></a>  <span class="fu">sm.script</span>(trwlcomp)</span>
<span id="cb9-2"><a href="variability-bands-for-flexible-regression.html#cb9-2" tabindex="-1"></a>  <span class="fu">sm.script</span>(trwlband)</span></code></pre></div>
<pre><code>## Test of equality :  h =  0.1    p-value =  0.5691</code></pre>
<p><img src="book_files/figure-html/unnamed-chunk-83-1.png" width="49%" /><img src="book_files/figure-html/unnamed-chunk-83-2.png" width="49%" /></p>
<p>This code actually implements a global test of the hypothesis that the two underlying curves are identical. The p-value shows that there is no evidence that the curves are different.</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="hypothesis-tests.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="further-reading-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["book.pdf", "book.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
