<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.1 Time series data | Statistical Modelling</title>
  <meta name="description" content="A conceptual, visual and practical introduction to statistical modelling" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="2.1 Time series data | Statistical Modelling" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A conceptual, visual and practical introduction to statistical modelling" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.1 Time series data | Statistical Modelling" />
  
  <meta name="twitter:description" content="A conceptual, visual and practical introduction to statistical modelling" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="models-for-time.html"/>
<link rel="next" href="visualisation.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A visual and conceptual introduction to statistical modelling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface: what’s the problem?</a></li>
<li class="chapter" data-level="1" data-path="models-with-random-effects.html"><a href="models-with-random-effects.html"><i class="fa fa-check"></i><b>1</b> Models with random effects</a>
<ul>
<li class="chapter" data-level="1.1" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>1.1</b> Examples</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="examples.html"><a href="examples.html#the-sleep-deprivation-study"><i class="fa fa-check"></i><b>1.1.1</b> The sleep deprivation study</a></li>
<li class="chapter" data-level="1.1.2" data-path="examples.html"><a href="examples.html#the-strength-of-paste"><i class="fa fa-check"></i><b>1.1.2</b> The strength of paste</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="formulating-and-fitting-mixed-effects-models.html"><a href="formulating-and-fitting-mixed-effects-models.html"><i class="fa fa-check"></i><b>1.2</b> Formulating and fitting mixed effects models</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="formulating-and-fitting-mixed-effects-models.html"><a href="formulating-and-fitting-mixed-effects-models.html#the-sleep-deprivation-study-1"><i class="fa fa-check"></i><b>1.2.1</b> The sleep deprivation study</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="inference-with-mixed-models.html"><a href="inference-with-mixed-models.html"><i class="fa fa-check"></i><b>1.3</b> Inference with mixed models</a></li>
<li class="chapter" data-level="1.4" data-path="repeated-measurements.html"><a href="repeated-measurements.html"><i class="fa fa-check"></i><b>1.4</b> Repeated measurements</a></li>
<li class="chapter" data-level="1.5" data-path="case-studies-of-mixed-models.html"><a href="case-studies-of-mixed-models.html"><i class="fa fa-check"></i><b>1.5</b> Case studies of mixed models</a></li>
<li class="chapter" data-level="1.6" data-path="non-linear-mixed-models.html"><a href="non-linear-mixed-models.html"><i class="fa fa-check"></i><b>1.6</b> Non-linear mixed models</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="non-linear-mixed-models.html"><a href="non-linear-mixed-models.html#indomethacin-kinetics"><i class="fa fa-check"></i><b>1.6.1</b> Indomethacin kinetics</a></li>
<li class="chapter" data-level="1.6.2" data-path="non-linear-mixed-models.html"><a href="non-linear-mixed-models.html#growth-of-soyabean-plants"><i class="fa fa-check"></i><b>1.6.2</b> Growth of Soyabean plants</a></li>
<li class="chapter" data-level="1.6.3" data-path="non-linear-mixed-models.html"><a href="non-linear-mixed-models.html#phenobarbital-kinetics"><i class="fa fa-check"></i><b>1.6.3</b> Phenobarbital kinetics</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="generalised-linear-mixed-models.html"><a href="generalised-linear-mixed-models.html"><i class="fa fa-check"></i><b>1.7</b> Generalised linear mixed models</a></li>
<li class="chapter" data-level="1.8" data-path="further-reading.html"><a href="further-reading.html"><i class="fa fa-check"></i><b>1.8</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="models-for-time.html"><a href="models-for-time.html"><i class="fa fa-check"></i><b>2</b> Models for time</a>
<ul>
<li class="chapter" data-level="2.1" data-path="time-series-data.html"><a href="time-series-data.html"><i class="fa fa-check"></i><b>2.1</b> Time series data</a></li>
<li class="chapter" data-level="2.2" data-path="visualisation.html"><a href="visualisation.html"><i class="fa fa-check"></i><b>2.2</b> Visualisation</a></li>
<li class="chapter" data-level="2.3" data-path="models.html"><a href="models.html"><i class="fa fa-check"></i><b>2.3</b> Models</a></li>
<li class="chapter" data-level="2.4" data-path="further-reading-1.html"><a href="further-reading-1.html"><i class="fa fa-check"></i><b>2.4</b> Further reading</a></li>
<li class="chapter" data-level="2.5" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>2.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="exercises.html"><a href="exercises.html#simulating-time-series"><i class="fa fa-check"></i><b>2.5.1</b> Simulating time series</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Modelling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="time-series-data" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Time series data<a href="time-series-data.html#time-series-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>At 1345m above sea level, Ben Nevis is the highest mountain in the UK and the weather at the summit can be very severe. In the 19th century, a remarkable effort was made to document conditions at the summit. Following a public appeal, an observatory was set up on the summit to allow a small group of meteorologists to make recordings. This was done hourly from 1883 to 1904, producing one of the most remarkable weather datasets from the Victorian era. <span class="citation">Hawkins et al. (<a href="#ref-hawkins_2019_geoscience">2019</a>)</span> describe a recent citizen science project which has made the data available in digital form. The data are available from the <a href="https://archive.ceda.ac.uk">CEDA Archive</a> which contains a very large collection of environmental data from atmospheric and earth observation research.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="time-series-data.html#cb57-1" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="fu">rp.datalink</span>(<span class="st">&quot;Ben_Nevis&quot;</span>)</span>
<span id="cb57-2"><a href="time-series-data.html#cb57-2" tabindex="-1"></a>Ben_Nevis <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(path) <span class="sc">%&gt;%</span></span>
<span id="cb57-3"><a href="time-series-data.html#cb57-3" tabindex="-1"></a>   <span class="fu">rename</span>(<span class="at">Tmin =</span> <span class="dv">5</span>, <span class="at">Tmax =</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb57-4"><a href="time-series-data.html#cb57-4" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(Year, Month, Day), <span class="at">format =</span> <span class="st">&quot;%Y %m %d&quot;</span>))</span>
<span id="cb57-5"><a href="time-series-data.html#cb57-5" tabindex="-1"></a><span class="fu">ggplot</span>(Ben_Nevis, <span class="fu">aes</span>(Date, Tmax)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">20</span>, <span class="dv">20</span>)</span>
<span id="cb57-6"><a href="time-series-data.html#cb57-6" tabindex="-1"></a><span class="fu">ggplot</span>(Ben_Nevis, <span class="fu">aes</span>(Date, Tmin)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">20</span>, <span class="dv">20</span>)</span></code></pre></div>
<p><img src="book_files/figure-html/ben_nevis-1.png" width="49%" /><img src="book_files/figure-html/ben_nevis-2.png" width="49%" /></p>
<p>In time series data, we are often interested in whether there is trend or seasonal effects and what these look like. We may also be interested in the influence of covariates. These may apply to the whole time series, such as characteristics of the location at which different time series are recorded, or they may themselves be time series running in parallel.</p>
<p>A statistical feature which makes time series distinctive is that there is often <em>autocorrelation</em>, meaning that the variation or random component of successive points tend to be linked to the variation at adjacent points. The autocorrelation function, or partial autocorrelation function, quantifies this.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="time-series-data.html#cb58-1" tabindex="-1"></a><span class="fu">acf</span>(Ben_Nevis<span class="sc">$</span>Tmax)</span>
<span id="cb58-2"><a href="time-series-data.html#cb58-2" tabindex="-1"></a><span class="fu">pacf</span>(Ben_Nevis<span class="sc">$</span>Tmax)</span></code></pre></div>
<p><img src="book_files/figure-html/acf_Ben_Nevis-1.png" width="49%" /><img src="book_files/figure-html/acf_Ben_Nevis-2.png" width="49%" /></p>
<p>Some of the apparent autocorrelation is driven by the seasonal trend, so we need a model which can fit this kind of systematic component. Nonetheless, autocorrelation may remain so we need to consider this feature when building a statistical model.</p>
<p><em>Exercise</em>: Winter NAO is a time series. Is there evidence of autocorrelation?</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="time-series-data.html#cb59-1" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="fu">rp.datalink</span>(<span class="st">&#39;NAO&#39;</span>)</span>
<span id="cb59-2"><a href="time-series-data.html#cb59-2" tabindex="-1"></a>NAO  <span class="ot">&lt;-</span> <span class="fu">read.table</span>(path, <span class="at">header =</span> <span class="cn">FALSE</span>, <span class="at">skip =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-3"><a href="time-series-data.html#cb59-3" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">Year =</span> <span class="dv">1</span>, <span class="at">NAO =</span> <span class="dv">2</span>)</span>
<span id="cb59-4"><a href="time-series-data.html#cb59-4" tabindex="-1"></a><span class="fu">ggplot</span>(NAO, <span class="fu">aes</span>(Year, NAO)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="book_files/figure-html/acf_NAO-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-hawkins_2019_geoscience" class="csl-entry">
Hawkins, Ed, Stephen Burt, Philip Brohan, Michael Lockwood, Harriett Richardson, Marjory Roy, and Simon Thomas. 2019. <span>“Hourly Weather Observations from the Scottish Highlands (1883–1904) Rescued by Volunteer Citizen Scientists.”</span> <em>Geoscience Data Journal</em> 6 (2): 160–73. <a href="https://doi.org/10.1002/gdj3.79">https://doi.org/10.1002/gdj3.79</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="models-for-time.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="visualisation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["book.pdf", "book.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
