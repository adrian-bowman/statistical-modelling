<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1.1 Computational inference | Statistical Modelling</title>
  <meta name="description" content="A conceptual, visual and practical introduction to statistical modelling" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="1.1 Computational inference | Statistical Modelling" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A conceptual, visual and practical introduction to statistical modelling" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1.1 Computational inference | Statistical Modelling" />
  
  <meta name="twitter:description" content="A conceptual, visual and practical introduction to statistical modelling" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="other-approaches-to-inference.html"/>
<link rel="next" href="bayesian-inference.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.1/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.1/leaflet-providers-plugin.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A visual and conceptual introduction to statistical modelling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface: whatâ€™s the problem?</a></li>
<li class="chapter" data-level="1" data-path="other-approaches-to-inference.html"><a href="other-approaches-to-inference.html"><i class="fa fa-check"></i><b>1</b> Other approaches to inference</a>
<ul>
<li class="chapter" data-level="1.1" data-path="computational-inference.html"><a href="computational-inference.html"><i class="fa fa-check"></i><b>1.1</b> Computational inference</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="computational-inference.html"><a href="computational-inference.html#simulation-methods"><i class="fa fa-check"></i><b>1.1.1</b> Simulation methods</a></li>
<li class="chapter" data-level="1.1.2" data-path="computational-inference.html"><a href="computational-inference.html#randomisation-tests"><i class="fa fa-check"></i><b>1.1.2</b> Randomisation tests</a></li>
<li class="chapter" data-level="1.1.3" data-path="computational-inference.html"><a href="computational-inference.html#the-bootstrap"><i class="fa fa-check"></i><b>1.1.3</b> The bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="bayesian-inference.html"><a href="bayesian-inference.html"><i class="fa fa-check"></i><b>1.2</b> Bayesian inference</a></li>
<li class="chapter" data-level="1.3" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>1.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="exercises.html"><a href="exercises.html#coverage-property-of-bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>1.3.1</b> Coverage property of bootstrap confidence intervals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="models-for-space.html"><a href="models-for-space.html"><i class="fa fa-check"></i><b>2</b> Models for space</a>
<ul>
<li class="chapter" data-level="2.1" data-path="visualising-spatial-data.html"><a href="visualising-spatial-data.html"><i class="fa fa-check"></i><b>2.1</b> Visualising spatial data</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="visualising-spatial-data.html"><a href="visualising-spatial-data.html#the-maps-package"><i class="fa fa-check"></i><b>2.1.1</b> The <code>maps</code> package</a></li>
<li class="chapter" data-level="2.1.2" data-path="visualising-spatial-data.html"><a href="visualising-spatial-data.html#leaflet-and-mapview-interactive-maps"><i class="fa fa-check"></i><b>2.1.2</b> <code>leaflet</code> and <code>mapview</code>: interactive maps</a></li>
<li class="chapter" data-level="2.1.3" data-path="visualising-spatial-data.html"><a href="visualising-spatial-data.html#ggplot-and-ggmap"><i class="fa fa-check"></i><b>2.1.3</b> <code>ggplot</code> and <code>ggmap</code></a></li>
<li class="chapter" data-level="2.1.4" data-path="visualising-spatial-data.html"><a href="visualising-spatial-data.html#tmap"><i class="fa fa-check"></i><b>2.1.4</b> <code>tmap</code></a></li>
<li class="chapter" data-level="2.1.5" data-path="visualising-spatial-data.html"><a href="visualising-spatial-data.html#spatstat-for-spatial-point-patterns"><i class="fa fa-check"></i><b>2.1.5</b> <code>spatstat</code> for spatial point patterns</a></li>
<li class="chapter" data-level="2.1.6" data-path="visualising-spatial-data.html"><a href="visualising-spatial-data.html#areal-data"><i class="fa fa-check"></i><b>2.1.6</b> Areal data</a></li>
<li class="chapter" data-level="2.1.7" data-path="visualising-spatial-data.html"><a href="visualising-spatial-data.html#image-data"><i class="fa fa-check"></i><b>2.1.7</b> Image data</a></li>
<li class="chapter" data-level="2.1.8" data-path="visualising-spatial-data.html"><a href="visualising-spatial-data.html#spatiotemporal-animation"><i class="fa fa-check"></i><b>2.1.8</b> Spatiotemporal animation</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="models-for-point-pattern-data.html"><a href="models-for-point-pattern-data.html"><i class="fa fa-check"></i><b>2.2</b> Models for point pattern data</a></li>
<li class="chapter" data-level="2.3" data-path="geostatistical-models.html"><a href="geostatistical-models.html"><i class="fa fa-check"></i><b>2.3</b> Geostatistical models</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="geostatistical-models.html"><a href="geostatistical-models.html#gaussian-processes"><i class="fa fa-check"></i><b>2.3.1</b> Gaussian processes</a></li>
<li class="chapter" data-level="2.3.2" data-path="geostatistical-models.html"><a href="geostatistical-models.html#geostatistical-models-1"><i class="fa fa-check"></i><b>2.3.2</b> Geostatistical models</a></li>
<li class="chapter" data-level="2.3.3" data-path="geostatistical-models.html"><a href="geostatistical-models.html#so2-a-model-based-on-smoothing"><i class="fa fa-check"></i><b>2.3.3</b> SO2: a model based on smoothing</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="models-for-areal-data.html"><a href="models-for-areal-data.html"><i class="fa fa-check"></i><b>2.4</b> Models for areal data</a></li>
<li class="chapter" data-level="2.5" data-path="further-reading.html"><a href="further-reading.html"><i class="fa fa-check"></i><b>2.5</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Modelling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="computational-inference" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> Computational inference<a href="computational-inference.html#computational-inference" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The problems we have discussed so far have been very simple once where theory can be worked out analytically to provide simple formulate and procedures. With more complex data structures, that can become much more difficult so this section will discuss some ways of approaching inference by computational means. The underlying principles are essentially the same but the method of implementation is different.</p>
<div id="simulation-methods" class="section level3 hasAnchor" number="1.1.1">
<h3><span class="header-section-number">1.1.1</span> Simulation methods<a href="computational-inference.html#simulation-methods" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are some circumstances where the model whose suitability we wish to assess is completely known, without any dependence on unknown parameters. A simple example arises from spatial point patterns where we may wish to assess the evidence that the point pattern is generated by a process which is not simply uniform. The plot below shows data on large (breast height diameter &gt;= 50cm) longleaf pine trees in a 200m x 200m sqaure of forest.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="computational-inference.html#cb1-1" tabindex="-1"></a><span class="fu">library</span>(spatstat)</span>
<span id="cb1-2"><a href="computational-inference.html#cb1-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> longleaf<span class="sc">$</span>x[longleaf<span class="sc">$</span>marks <span class="sc">&gt;=</span><span class="dv">50</span>]</span>
<span id="cb1-3"><a href="computational-inference.html#cb1-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> longleaf<span class="sc">$</span>y[longleaf<span class="sc">$</span>marks <span class="sc">&gt;=</span><span class="dv">50</span>]</span>
<span id="cb1-4"><a href="computational-inference.html#cb1-4" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-5"><a href="computational-inference.html#cb1-5" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(x, y)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-14-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>We can generate our own trees patterns in a uniform random manner simply by locating each tree at an x and y position each of which is generated uniformly in the range (0, 200). here are some examples of patterns generated in this way.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="computational-inference.html#cb2-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb2-2"><a href="computational-inference.html#cb2-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb2-3"><a href="computational-inference.html#cb2-3" tabindex="-1"></a>   plt <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">200</span>), <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">200</span>))) <span class="sc">+</span></span>
<span id="cb2-4"><a href="computational-inference.html#cb2-4" tabindex="-1"></a>            <span class="fu">geom_point</span>()</span>
<span id="cb2-5"><a href="computational-inference.html#cb2-5" tabindex="-1"></a>  <span class="fu">print</span>(plt)</span>
<span id="cb2-6"><a href="computational-inference.html#cb2-6" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-15-1.png" width="32%" /><img src="book_files/figure-html/unnamed-chunk-15-2.png" width="32%" /><img src="book_files/figure-html/unnamed-chunk-15-3.png" width="32%" /></p>
<p>How should we compare the observed pattern with the randomly generated ones? A simple way of doing this is to measure for each tree the distance to its nearest neighbour. If the pattern exhibits clustering, then these distances should be small, while if the pattern is uniform they will tend to be larger. We might then use as our test statistic the average of the distances to each nearest neighbour. We can generate the distribution of this average distance in the case where the locations are uniformly distributed simply by repeatedly simulating locations and retaining the average nearest neighbour distance for each one. The <code>nndist</code> function from the <code>spatstat</code> package can help us with the nearest neighbour distances.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="computational-inference.html#cb3-1" tabindex="-1"></a>nsim  <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb3-2"><a href="computational-inference.html#cb3-2" tabindex="-1"></a>tstat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, nsim)</span>
<span id="cb3-3"><a href="computational-inference.html#cb3-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim) {</span>
<span id="cb3-4"><a href="computational-inference.html#cb3-4" tabindex="-1"></a>  pp <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">200</span>), <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">200</span>))</span>
<span id="cb3-5"><a href="computational-inference.html#cb3-5" tabindex="-1"></a>  tstat[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">nndist</span>(pp[ , <span class="dv">1</span>], pp[ , <span class="dv">2</span>]))</span>
<span id="cb3-6"><a href="computational-inference.html#cb3-6" tabindex="-1"></a>}</span>
<span id="cb3-7"><a href="computational-inference.html#cb3-7" tabindex="-1"></a>tstat.obs <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">nndist</span>(x, y))</span>
<span id="cb3-8"><a href="computational-inference.html#cb3-8" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(tstat)) <span class="sc">+</span> <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb3-9"><a href="computational-inference.html#cb3-9" tabindex="-1"></a>   <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> tstat.obs, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb3-10"><a href="computational-inference.html#cb3-10" tabindex="-1"></a><span class="fu">length</span>(tstat[tstat <span class="sc">&lt;</span> tstat.obs]) <span class="sc">/</span> nsim</span></code></pre></div>
<pre><code>## [1] 0.328</code></pre>
<p><img src="book_files/figure-html/unnamed-chunk-16-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>The histogram shows the distribution (subject to the variation present through simulation) of the average nearest neighbour distance when of atoms really are uniform. The red line shows the average neighbour distance for the observed data. Informally, but clearly, we can see that from this perspective the observed data is entirely consistent with the assumption of uniformity. An empirical p-value can be computed simply from the proportion of simulated values which fall below the observed one (as we look for evidence against uniformity in small nearest neighbour distances).</p>
</div>
<div id="randomisation-tests" class="section level3 hasAnchor" number="1.1.2">
<h3><span class="header-section-number">1.1.2</span> Randomisation tests<a href="computational-inference.html#randomisation-tests" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Randomisation is very important principle in designing experiments as it helps to overcome issues of bias. We will consider this in detail elsewhere. Randomisation can also be used as the basis for analysis when we are reluctant to make the normality and independence assumptions which underlie standard methods. The dataset below provides a very simple example of this it refers to an experiment to assess the possibly different effects of two fertilisers applied to tomato plants growing in a row. (This example comes from the book <em>Statistics for Experimenters</em> by Box, Hunter and Hunter.)</p>
<pre><code>      Row position     1     2     3     4     5     6     7     8     9    10    11
      Fertiliser       A     A     B     B     A     B     B     B     A     A     B
      Yield (pounds) 29.9  11.4  26.6  23.7  25.3  28.5  14.2  17.9  16.5  21.1  24.3</code></pre>
<p>If the positions the fertilisers in the row have been randomised, and if the two fertilisers A and B are in fact equivalent in the effects, then the labels attached to the observations are immaterial. There is no connection between the labels and the outcomes. This allows us to calculate the distribution of the difference between the mean yields of A and B which is generated by the randomisation procedure. The histogram below shows this. For convenience (indeed, laziness!) it has been constructed from random permutations rather than the systematic list of all possible randomisations.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="computational-inference.html#cb6-1" tabindex="-1"></a>fertiliser <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>)</span>
<span id="cb6-2"><a href="computational-inference.html#cb6-2" tabindex="-1"></a>yield      <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">29.9</span>, <span class="fl">11.4</span>, <span class="fl">26.6</span>, <span class="fl">23.7</span>, <span class="fl">25.3</span>, <span class="fl">28.5</span>, <span class="fl">14.2</span>, <span class="fl">17.9</span>, <span class="fl">16.5</span>, <span class="fl">21.1</span>, <span class="fl">24.3</span>)</span>
<span id="cb6-3"><a href="computational-inference.html#cb6-3" tabindex="-1"></a>nperm      <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb6-4"><a href="computational-inference.html#cb6-4" tabindex="-1"></a>tstat      <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, nperm)</span>
<span id="cb6-5"><a href="computational-inference.html#cb6-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nperm) {</span>
<span id="cb6-6"><a href="computational-inference.html#cb6-6" tabindex="-1"></a>  smp      <span class="ot">&lt;-</span> <span class="fu">sample</span>(fertiliser)</span>
<span id="cb6-7"><a href="computational-inference.html#cb6-7" tabindex="-1"></a>  tstat[i] <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">tapply</span>(yield, smp, mean))</span>
<span id="cb6-8"><a href="computational-inference.html#cb6-8" tabindex="-1"></a>}</span>
<span id="cb6-9"><a href="computational-inference.html#cb6-9" tabindex="-1"></a>tstat.obs <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">tapply</span>(yield, fertiliser, mean))</span>
<span id="cb6-10"><a href="computational-inference.html#cb6-10" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(tstat)) <span class="sc">+</span> <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb6-11"><a href="computational-inference.html#cb6-11" tabindex="-1"></a>   <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> tstat.obs, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-17-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>There are several new functions used in the <code>R</code> code here (<code>c</code>, <code>diff</code>, <code>tapply</code>). You will hopefully feel ready to explore these through the help system by this stage. The end result is a histogram which represents the distribution, induced by randomisation, of the mean sample difference between A and B when the two treatments have identical effects. When we compare this with the observed mean difference it is clear that the two are compatible. So there is no evidence that A and B have different effects. If required, a p-value could be obtained by the means discussed in the simulation test section above. However, the conclusion is already clear.</p>
</div>
<div id="the-bootstrap" class="section level3 hasAnchor" number="1.1.3">
<h3><span class="header-section-number">1.1.3</span> The bootstrap<a href="computational-inference.html#the-bootstrap" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We generally regard observed data as having been generated by some underlying distribution. If we construct an estimator of some quantity of interest, such as a population mean, then we need to know how accurate estimate is as a guide to the true value. The simple but surprising idea behind the bootstrap is that we mimic the variation of the sample around the distribution by the variation of resampled datasets around our original sample. When the bootstrap was first proposed in the 1970s, it took people by surprise but in fact it can be shown to be well founded theoretically.</p>
<p>Suppose we are dealing with a distribution which has long tails. In other words, we may find that outliers (unusually large or small observations) are often present in sample datasets. Methods based on the assumption of a normal distribution will be strongly affected by this. A simple device is to compute a <em>trimmed mean</em>. This simply computes the main of the remaining data after a proportion of the highest and lowest observations has been removed. This is an attractive way of defending against the effect of long tails, but how do we quantify the uncertainty of our sample estimator as a guide to the true trimmed mean of the underlying distribution?</p>
<p>The bootstrap takes the observed sample and resamples the data with replacement. A trimmed mean is calculated on each resample. In the simplest approach to construction of a confidence interval, this is generated simply through percentiles of the trimmed means generated by resampling. The example below shows the mechanics of this, using a simple normal random sample to represent the observed data.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="computational-inference.html#cb7-1" tabindex="-1"></a>x      <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">25</span>)</span>
<span id="cb7-2"><a href="computational-inference.html#cb7-2" tabindex="-1"></a>tm.obs <span class="ot">&lt;-</span> <span class="fu">mean</span>(x, <span class="at">trim =</span> <span class="fl">0.1</span>)</span>
<span id="cb7-3"><a href="computational-inference.html#cb7-3" tabindex="-1"></a></span>
<span id="cb7-4"><a href="computational-inference.html#cb7-4" tabindex="-1"></a>nboot  <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb7-5"><a href="computational-inference.html#cb7-5" tabindex="-1"></a>tmdiff <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, nboot)</span>
<span id="cb7-6"><a href="computational-inference.html#cb7-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nboot)</span>
<span id="cb7-7"><a href="computational-inference.html#cb7-7" tabindex="-1"></a>   tmdiff[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">sample</span>(x, <span class="at">replace =</span> <span class="cn">TRUE</span>), <span class="at">trim =</span> <span class="fl">0.1</span>) <span class="sc">-</span> tm.obs</span>
<span id="cb7-8"><a href="computational-inference.html#cb7-8" tabindex="-1"></a>tm.obs <span class="sc">-</span> <span class="fu">quantile</span>(tmdiff, <span class="fu">c</span>(<span class="fl">0.975</span>, <span class="fl">0.025</span>))</span></code></pre></div>
<pre><code>##      97.5%       2.5% 
## -0.2880666  0.5207074</code></pre>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="other-approaches-to-inference.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bayesian-inference.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["book.pdf", "book.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
