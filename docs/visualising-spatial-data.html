<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>17.1 Visualising spatial data | Statistical Modelling</title>
  <meta name="description" content="A conceptual, visual and practical introduction to statistical modelling" />
  <meta name="generator" content="bookdown 0.46 and GitBook 2.6.7" />

  <meta property="og:title" content="17.1 Visualising spatial data | Statistical Modelling" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A conceptual, visual and practical introduction to statistical modelling" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="17.1 Visualising spatial data | Statistical Modelling" />
  
  <meta name="twitter:description" content="A conceptual, visual and practical introduction to statistical modelling" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="models-for-space.html"/>
<link rel="next" href="models-for-point-pattern-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/rglWebGL-binding-1.3.31/rglWebGL.js"></script>
<link href="libs/rglwidgetClass-1.3.31/rgl.css" rel="stylesheet" />
<script src="libs/rglwidgetClass-1.3.31/rglClass.min.js"></script>
<script src="libs/CanvasMatrix4-1.3.31/CanvasMatrix.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>
<link href="libs/htmltools-fill-0.5.9/fill.css" rel="stylesheet" />
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.3/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.3/leaflet-providers-plugin.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A visual and conceptual introduction to statistical modelling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface: what’s the problem?</a></li>
<li class="chapter" data-level="" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html"><i class="fa fa-check"></i>Getting started with R</a></li>
<li class="part"><span><b>I Introduction</b></span></li>
<li class="chapter" data-level="1" data-path="where-data.html"><a href="where-data.html"><i class="fa fa-check"></i><b>1</b> Where do data come from?</a>
<ul>
<li class="chapter" data-level="1.1" data-path="examples-data.html"><a href="examples-data.html"><i class="fa fa-check"></i><b>1.1</b> Some examples of data</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="examples-data.html"><a href="examples-data.html#co2-and-global-warming"><i class="fa fa-check"></i><b>1.1.1</b> CO2 and global warming</a></li>
<li class="chapter" data-level="1.1.2" data-path="examples-data.html"><a href="examples-data.html#the-first-tuberculosis-trial"><i class="fa fa-check"></i><b>1.1.2</b> The first tuberculosis trial</a></li>
<li class="chapter" data-level="1.1.3" data-path="examples-data.html"><a href="examples-data.html#the-birds-and-the-bees-how-to-tell-the-sex-of-a-herring-gull"><i class="fa fa-check"></i><b>1.1.3</b> The birds and the bees: how to tell the sex of a herring gull</a></li>
<li class="chapter" data-level="1.1.4" data-path="examples-data.html"><a href="examples-data.html#tracking-the-covid-pandemic"><i class="fa fa-check"></i><b>1.1.4</b> Tracking the covid pandemic</a></li>
<li class="chapter" data-level="1.1.5" data-path="examples-data.html"><a href="examples-data.html#more-complex-data-objects"><i class="fa fa-check"></i><b>1.1.5</b> More complex data objects</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="some-broad-issues.html"><a href="some-broad-issues.html"><i class="fa fa-check"></i><b>1.2</b> Some broad issues</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="some-broad-issues.html"><a href="some-broad-issues.html#whats-the-problem"><i class="fa fa-check"></i><b>1.2.1</b> What’s the problem?</a></li>
<li class="chapter" data-level="1.2.2" data-path="some-broad-issues.html"><a href="some-broad-issues.html#whats-the-plan"><i class="fa fa-check"></i><b>1.2.2</b> What’s the plan?</a></li>
<li class="chapter" data-level="1.2.3" data-path="some-broad-issues.html"><a href="some-broad-issues.html#where-data-subsection"><i class="fa fa-check"></i><b>1.2.3</b> Where do the data come from?</a></li>
<li class="chapter" data-level="1.2.4" data-path="some-broad-issues.html"><a href="some-broad-issues.html#who-do-you-trust"><i class="fa fa-check"></i><b>1.2.4</b> Who do you trust?</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="what-could-possibly-go-wrong.html"><a href="what-could-possibly-go-wrong.html"><i class="fa fa-check"></i><b>1.3</b> What could possibly go wrong?</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="what-could-possibly-go-wrong.html"><a href="what-could-possibly-go-wrong.html#us-presidential-elections-1936-and-1948"><i class="fa fa-check"></i><b>1.3.1</b> US presidential elections, 1936 and 1948</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="further-reading.html"><a href="further-reading.html"><i class="fa fa-check"></i><b>1.4</b> Further reading</a></li>
<li class="chapter" data-level="1.5" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>1.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="exercises.html"><a href="exercises.html#an-investigation-of-short-term-memory"><i class="fa fa-check"></i><b>1.5.1</b> An investigation of short-term memory</a></li>
<li class="chapter" data-level="1.5.2" data-path="exercises.html"><a href="exercises.html#a-survey-of-dental-health"><i class="fa fa-check"></i><b>1.5.2</b> A survey of dental health</a></li>
<li class="chapter" data-level="1.5.3" data-path="exercises.html"><a href="exercises.html#hearings-aid-and-dementia"><i class="fa fa-check"></i><b>1.5.3</b> Hearings aid and dementia</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="R-introduction.html"><a href="R-introduction.html"><i class="fa fa-check"></i><b>2</b> A gentle introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="r-fuss.html"><a href="r-fuss.html"><i class="fa fa-check"></i><b>2.1</b> R: what’s all the fuss about?</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="r-fuss.html"><a href="r-fuss.html#history"><i class="fa fa-check"></i><b>2.1.1</b> History</a></li>
<li class="chapter" data-level="2.1.2" data-path="r-fuss.html"><a href="r-fuss.html#why-should-i-be-interested"><i class="fa fa-check"></i><b>2.1.2</b> Why should I be interested?</a></li>
<li class="chapter" data-level="2.1.3" data-path="r-fuss.html"><a href="r-fuss.html#whats-the-down-side"><i class="fa fa-check"></i><b>2.1.3</b> What’s the down side?</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="taste-of-r.html"><a href="taste-of-r.html"><i class="fa fa-check"></i><b>2.2</b> A taste of R</a></li>
<li class="chapter" data-level="2.3" data-path="a-summary-of-key-concepts-in-r.html"><a href="a-summary-of-key-concepts-in-r.html"><i class="fa fa-check"></i><b>2.3</b> A summary of key concepts in R</a></li>
<li class="chapter" data-level="2.4" data-path="reading-data.html"><a href="reading-data.html"><i class="fa fa-check"></i><b>2.4</b> Reading data into R</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="reading-data.html"><a href="reading-data.html#accessing-the-data-used-in-this-book"><i class="fa fa-check"></i><b>2.4.1</b> Accessing the data used in this book</a></li>
<li class="chapter" data-level="2.4.2" data-path="reading-data.html"><a href="reading-data.html#functions-for-reading-data"><i class="fa fa-check"></i><b>2.4.2</b> Functions for reading data</a></li>
<li class="chapter" data-level="2.4.3" data-path="reading-data.html"><a href="reading-data.html#reading-data-example"><i class="fa fa-check"></i><b>2.4.3</b> An example: reading an <em>Excel</em> spreadsheet</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="a-further-example-the-scottish-independence-referendum.html"><a href="a-further-example-the-scottish-independence-referendum.html"><i class="fa fa-check"></i><b>2.5</b> A further example: the Scottish independence referendum</a></li>
<li class="chapter" data-level="2.6" data-path="further-reading-1.html"><a href="further-reading-1.html"><i class="fa fa-check"></i><b>2.6</b> Further reading</a></li>
<li class="chapter" data-level="2.7" data-path="exercises-1.html"><a href="exercises-1.html"><i class="fa fa-check"></i><b>2.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="exercises-1.html"><a href="exercises-1.html#scottish-referendum-data"><i class="fa fa-check"></i><b>2.7.1</b> Scottish Referendum data</a></li>
<li class="chapter" data-level="2.7.2" data-path="exercises-1.html"><a href="exercises-1.html#aircraft-designs"><i class="fa fa-check"></i><b>2.7.2</b> Aircraft designs</a></li>
<li class="chapter" data-level="2.7.3" data-path="exercises-1.html"><a href="exercises-1.html#centenarians"><i class="fa fa-check"></i><b>2.7.3</b> Centenarians</a></li>
<li class="chapter" data-level="2.7.4" data-path="exercises-1.html"><a href="exercises-1.html#justification-of-the-log-transformation-for-the-rodent-data"><i class="fa fa-check"></i><b>2.7.4</b> Justification of the log transformation for the rodent data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>3</b> Data wrangling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="reorganising-data.html"><a href="reorganising-data.html"><i class="fa fa-check"></i><b>3.1</b> Reorganising data</a></li>
<li class="chapter" data-level="3.2" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>3.2</b> Making life easier: the <code>dplyr</code> package</a></li>
<li class="chapter" data-level="3.3" data-path="collating-data-from-different-sources.html"><a href="collating-data-from-different-sources.html"><i class="fa fa-check"></i><b>3.3</b> Collating data from different sources</a></li>
<li class="chapter" data-level="3.4" data-path="tidy-data.html"><a href="tidy-data.html"><i class="fa fa-check"></i><b>3.4</b> Tidy data</a></li>
<li class="chapter" data-level="3.5" data-path="further-reading-2.html"><a href="further-reading-2.html"><i class="fa fa-check"></i><b>3.5</b> Further reading</a></li>
<li class="chapter" data-level="3.6" data-path="exercises-2.html"><a href="exercises-2.html"><i class="fa fa-check"></i><b>3.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="exercises-2.html"><a href="exercises-2.html#data-wrangling-exercise-UN-demography"><i class="fa fa-check"></i><b>3.6.1</b> UN demography data</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Exploring data</b></span></li>
<li class="chapter" data-level="4" data-path="data-visualisation.html"><a href="data-visualisation.html"><i class="fa fa-check"></i><b>4</b> Data Visualisation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="thousand-words.html"><a href="thousand-words.html"><i class="fa fa-check"></i><b>4.1</b> Graphics: a picture is worth a thousand words</a></li>
<li class="chapter" data-level="4.2" data-path="ggplot-graphics.html"><a href="ggplot-graphics.html"><i class="fa fa-check"></i><b>4.2</b> <code>ggplot</code> graphics</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="ggplot-graphics.html"><a href="ggplot-graphics.html#ggplot-graphics-basics"><i class="fa fa-check"></i><b>4.2.1</b> The basics</a></li>
<li class="chapter" data-level="4.2.2" data-path="ggplot-graphics.html"><a href="ggplot-graphics.html#ggplot-facets"><i class="fa fa-check"></i><b>4.2.2</b> Facets</a></li>
<li class="chapter" data-level="4.2.3" data-path="ggplot-graphics.html"><a href="ggplot-graphics.html#going-deeper"><i class="fa fa-check"></i><b>4.2.3</b> Going deeper</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="what-are-we-looking-for.html"><a href="what-are-we-looking-for.html"><i class="fa fa-check"></i><b>4.3</b> What are we looking for?</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="what-are-we-looking-for.html"><a href="what-are-we-looking-for.html#continuous-scales"><i class="fa fa-check"></i><b>4.3.1</b> Continuous scales</a></li>
<li class="chapter" data-level="4.3.2" data-path="what-are-we-looking-for.html"><a href="what-are-we-looking-for.html#discrete-scales"><i class="fa fa-check"></i><b>4.3.2</b> Discrete scales</a></li>
<li class="chapter" data-level="4.3.3" data-path="what-are-we-looking-for.html"><a href="what-are-we-looking-for.html#categorical-data"><i class="fa fa-check"></i><b>4.3.3</b> Categorical data</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="gaining-an-overview-of-datasets.html"><a href="gaining-an-overview-of-datasets.html"><i class="fa fa-check"></i><b>4.4</b> Gaining an overview of datasets</a></li>
<li class="chapter" data-level="4.5" data-path="plots-for-more-complex-data-structures.html"><a href="plots-for-more-complex-data-structures.html"><i class="fa fa-check"></i><b>4.5</b> Plots for more complex data structures</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="plots-for-more-complex-data-structures.html"><a href="plots-for-more-complex-data-structures.html#d-data"><i class="fa fa-check"></i><b>4.5.1</b> 3D data</a></li>
<li class="chapter" data-level="4.5.2" data-path="plots-for-more-complex-data-structures.html"><a href="plots-for-more-complex-data-structures.html#circular-spherical-and-compositional-data"><i class="fa fa-check"></i><b>4.5.2</b> Circular, spherical and compositional data</a></li>
<li class="chapter" data-level="4.5.3" data-path="plots-for-more-complex-data-structures.html"><a href="plots-for-more-complex-data-structures.html#other-data-structures"><i class="fa fa-check"></i><b>4.5.3</b> Other data structures</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="going-further.html"><a href="going-further.html"><i class="fa fa-check"></i><b>4.6</b> Going further</a></li>
<li class="chapter" data-level="4.7" data-path="exercises-3.html"><a href="exercises-3.html"><i class="fa fa-check"></i><b>4.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="exercises-3.html"><a href="exercises-3.html#rodent-mass-and-speed"><i class="fa fa-check"></i><b>4.7.1</b> Rodent mass and speed</a></li>
<li class="chapter" data-level="4.7.2" data-path="exercises-3.html"><a href="exercises-3.html#uk-covid-19-deaths"><i class="fa fa-check"></i><b>4.7.2</b> UK covid-19 deaths</a></li>
<li class="chapter" data-level="4.7.3" data-path="exercises-3.html"><a href="exercises-3.html#scottish-referendum"><i class="fa fa-check"></i><b>4.7.3</b> Scottish referendum</a></li>
<li class="chapter" data-level="4.7.4" data-path="exercises-3.html"><a href="exercises-3.html#centenarians-in-scotland"><i class="fa fa-check"></i><b>4.7.4</b> Centenarians in Scotland</a></li>
<li class="chapter" data-level="4.7.5" data-path="exercises-3.html"><a href="exercises-3.html#flour-beetles"><i class="fa fa-check"></i><b>4.7.5</b> Flour beetles</a></li>
<li class="chapter" data-level="4.7.6" data-path="exercises-3.html"><a href="exercises-3.html#clyde-estuary-water-quality"><i class="fa fa-check"></i><b>4.7.6</b> Clyde Estuary water quality</a></li>
<li class="chapter" data-level="4.7.7" data-path="exercises-3.html"><a href="exercises-3.html#crabs-multivariate"><i class="fa fa-check"></i><b>4.7.7</b> Crabs (<em>multivariate</em>)</a></li>
<li class="chapter" data-level="4.7.8" data-path="exercises-3.html"><a href="exercises-3.html#topographic-data"><i class="fa fa-check"></i><b>4.7.8</b> Topographic data</a></li>
<li class="chapter" data-level="4.7.9" data-path="exercises-3.html"><a href="exercises-3.html#global-energy-use"><i class="fa fa-check"></i><b>4.7.9</b> Global energy use</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="trends-and-patterns.html"><a href="trends-and-patterns.html"><i class="fa fa-check"></i><b>5</b> Trends and patterns</a>
<ul>
<li class="chapter" data-level="5.1" data-path="density-estimation.html"><a href="density-estimation.html"><i class="fa fa-check"></i><b>5.1</b> Density estimation</a></li>
<li class="chapter" data-level="5.2" data-path="flexible-regression.html"><a href="flexible-regression.html"><i class="fa fa-check"></i><b>5.2</b> Flexible regression</a></li>
<li class="chapter" data-level="5.3" data-path="further-reading-3.html"><a href="further-reading-3.html"><i class="fa fa-check"></i><b>5.3</b> Further reading</a></li>
<li class="chapter" data-level="5.4" data-path="exercises-4.html"><a href="exercises-4.html"><i class="fa fa-check"></i><b>5.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="exercises-4.html"><a href="exercises-4.html#exercise-conservation-density-displays"><i class="fa fa-check"></i><b>5.4.1</b> Does conservation work?</a></li>
<li class="chapter" data-level="5.4.2" data-path="exercises-4.html"><a href="exercises-4.html#the-spatial-distribution-of-laryngeal-cancer-smoothing"><i class="fa fa-check"></i><b>5.4.2</b> The spatial distribution of laryngeal cancer (<em>smoothing</em>)</a></li>
<li class="chapter" data-level="5.4.3" data-path="exercises-4.html"><a href="exercises-4.html#aircraft-data"><i class="fa fa-check"></i><b>5.4.3</b> Aircraft data</a></li>
<li class="chapter" data-level="5.4.4" data-path="exercises-4.html"><a href="exercises-4.html#radiocarbon-data"><i class="fa fa-check"></i><b>5.4.4</b> Radiocarbon data</a></li>
<li class="chapter" data-level="5.4.5" data-path="exercises-4.html"><a href="exercises-4.html#follicle-data"><i class="fa fa-check"></i><b>5.4.5</b> Follicle data</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Turning data into evidence</b></span></li>
<li class="chapter" data-level="6" data-path="inference.html"><a href="inference.html"><i class="fa fa-check"></i><b>6</b> Inference on means</a>
<ul>
<li class="chapter" data-level="6.1" data-path="samples-and-populations.html"><a href="samples-and-populations.html"><i class="fa fa-check"></i><b>6.1</b> Samples and populations</a></li>
<li class="chapter" data-level="6.2" data-path="standard-error.html"><a href="standard-error.html"><i class="fa fa-check"></i><b>6.2</b> Quantifying uncertainty: standard error</a></li>
<li class="chapter" data-level="6.3" data-path="confidence-intervals.html"><a href="confidence-intervals.html"><i class="fa fa-check"></i><b>6.3</b> Confidence intervals</a></li>
<li class="chapter" data-level="6.4" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html"><i class="fa fa-check"></i><b>6.4</b> Hypothesis tests</a></li>
<li class="chapter" data-level="6.5" data-path="comparing-two-means.html"><a href="comparing-two-means.html"><i class="fa fa-check"></i><b>6.5</b> Comparing two means</a></li>
<li class="chapter" data-level="6.6" data-path="going-further-and-deeper.html"><a href="going-further-and-deeper.html"><i class="fa fa-check"></i><b>6.6</b> Going further and deeper</a></li>
<li class="chapter" data-level="6.7" data-path="quantifying-uncertainty-exercises.html"><a href="quantifying-uncertainty-exercises.html"><i class="fa fa-check"></i><b>6.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="quantifying-uncertainty-exercises.html"><a href="quantifying-uncertainty-exercises.html#standard-errors"><i class="fa fa-check"></i><b>6.7.1</b> Standard errors</a></li>
<li class="chapter" data-level="6.7.2" data-path="quantifying-uncertainty-exercises.html"><a href="quantifying-uncertainty-exercises.html#what-does-confidence-mean"><i class="fa fa-check"></i><b>6.7.2</b> What does ‘confidence’ mean?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="inference-with-categorical-data.html"><a href="inference-with-categorical-data.html"><i class="fa fa-check"></i><b>7</b> Inference with categorical data</a>
<ul>
<li class="chapter" data-level="7.1" data-path="simple-proportions.html"><a href="simple-proportions.html"><i class="fa fa-check"></i><b>7.1</b> Simple proportions</a></li>
<li class="chapter" data-level="7.2" data-path="comparing-proportions.html"><a href="comparing-proportions.html"><i class="fa fa-check"></i><b>7.2</b> Comparing proportions</a></li>
<li class="chapter" data-level="7.3" data-path="contingency-tables.html"><a href="contingency-tables.html"><i class="fa fa-check"></i><b>7.3</b> Contingency tables</a></li>
<li class="chapter" data-level="7.4" data-path="exercises-5.html"><a href="exercises-5.html"><i class="fa fa-check"></i><b>7.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="exercises-5.html"><a href="exercises-5.html#opinion-polls"><i class="fa fa-check"></i><b>7.4.1</b> Opinion polls</a></li>
<li class="chapter" data-level="7.4.2" data-path="exercises-5.html"><a href="exercises-5.html#respiratory-disease-in-infancy"><i class="fa fa-check"></i><b>7.4.2</b> Respiratory disease in infancy</a></li>
<li class="chapter" data-level="7.4.3" data-path="exercises-5.html"><a href="exercises-5.html#smoking-and-lung-cancer"><i class="fa fa-check"></i><b>7.4.3</b> Smoking and lung cancer</a></li>
<li class="chapter" data-level="7.4.4" data-path="exercises-5.html"><a href="exercises-5.html#confidence-intervals-and-p-values"><i class="fa fa-check"></i><b>7.4.4</b> Confidence intervals and p-values</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="likelihood-a-powerful-principle.html"><a href="likelihood-a-powerful-principle.html"><i class="fa fa-check"></i><b>8</b> Likelihood: a powerful principle</a>
<ul>
<li class="chapter" data-level="8.1" data-path="the-idea.html"><a href="the-idea.html"><i class="fa fa-check"></i><b>8.1</b> The idea</a></li>
<li class="chapter" data-level="8.2" data-path="inference-1.html"><a href="inference-1.html"><i class="fa fa-check"></i><b>8.2</b> Inference</a></li>
<li class="chapter" data-level="8.3" data-path="an-example.html"><a href="an-example.html"><i class="fa fa-check"></i><b>8.3</b> An example</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="other-approaches-to-inference.html"><a href="other-approaches-to-inference.html"><i class="fa fa-check"></i><b>9</b> Other approaches to inference</a>
<ul>
<li class="chapter" data-level="9.1" data-path="computational-inference.html"><a href="computational-inference.html"><i class="fa fa-check"></i><b>9.1</b> Computational inference</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="computational-inference.html"><a href="computational-inference.html#simulation-methods"><i class="fa fa-check"></i><b>9.1.1</b> Simulation methods</a></li>
<li class="chapter" data-level="9.1.2" data-path="computational-inference.html"><a href="computational-inference.html#randomisation-tests"><i class="fa fa-check"></i><b>9.1.2</b> Randomisation tests</a></li>
<li class="chapter" data-level="9.1.3" data-path="computational-inference.html"><a href="computational-inference.html#the-bootstrap"><i class="fa fa-check"></i><b>9.1.3</b> The bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="bayesian-inference.html"><a href="bayesian-inference.html"><i class="fa fa-check"></i><b>9.2</b> Bayesian inference</a></li>
<li class="chapter" data-level="9.3" data-path="exercises-6.html"><a href="exercises-6.html"><i class="fa fa-check"></i><b>9.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="exercises-6.html"><a href="exercises-6.html#coverage-property-of-bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>9.3.1</b> Coverage property of bootstrap confidence intervals</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Statistical Models</b></span></li>
<li class="chapter" data-level="10" data-path="linear-models.html"><a href="linear-models.html"><i class="fa fa-check"></i><b>10</b> Linear models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="simple-regression-rodents-revisited.html"><a href="simple-regression-rodents-revisited.html"><i class="fa fa-check"></i><b>10.1</b> Simple regression: rodents revisited</a></li>
<li class="chapter" data-level="10.2" data-path="linear-models-with-multiple-covariates.html"><a href="linear-models-with-multiple-covariates.html"><i class="fa fa-check"></i><b>10.2</b> Linear models with multiple covariates</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="linear-models-with-multiple-covariates.html"><a href="linear-models-with-multiple-covariates.html#model-formulation"><i class="fa fa-check"></i><b>10.2.1</b> Model formulation</a></li>
<li class="chapter" data-level="10.2.2" data-path="linear-models-with-multiple-covariates.html"><a href="linear-models-with-multiple-covariates.html#model-fitting"><i class="fa fa-check"></i><b>10.2.2</b> Model fitting</a></li>
<li class="chapter" data-level="10.2.3" data-path="linear-models-with-multiple-covariates.html"><a href="linear-models-with-multiple-covariates.html#model-checking"><i class="fa fa-check"></i><b>10.2.3</b> Model checking</a></li>
<li class="chapter" data-level="10.2.4" data-path="linear-models-with-multiple-covariates.html"><a href="linear-models-with-multiple-covariates.html#inference-on-coefficients"><i class="fa fa-check"></i><b>10.2.4</b> Inference on coefficients</a></li>
<li class="chapter" data-level="10.2.5" data-path="linear-models-with-multiple-covariates.html"><a href="linear-models-with-multiple-covariates.html#comparing-models"><i class="fa fa-check"></i><b>10.2.5</b> Comparing models</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="prediction-black-cherry-trees.html"><a href="prediction-black-cherry-trees.html"><i class="fa fa-check"></i><b>10.3</b> Prediction: Black Cherry trees</a></li>
<li class="chapter" data-level="10.4" data-path="factors-and-interactions-in-linear-models.html"><a href="factors-and-interactions-in-linear-models.html"><i class="fa fa-check"></i><b>10.4</b> Factors and interactions in linear models</a></li>
<li class="chapter" data-level="10.5" data-path="transforming-the-response-variable-giving-in-the-church-of-england.html"><a href="transforming-the-response-variable-giving-in-the-church-of-england.html"><i class="fa fa-check"></i><b>10.5</b> Transforming the response variable: Giving in the Church of England</a></li>
<li class="chapter" data-level="10.6" data-path="simple-seasonal-terms.html"><a href="simple-seasonal-terms.html"><i class="fa fa-check"></i><b>10.6</b> Simple seasonal terms</a></li>
<li class="chapter" data-level="10.7" data-path="exercises-7.html"><a href="exercises-7.html"><i class="fa fa-check"></i><b>10.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="exercises-7.html"><a href="exercises-7.html#rodents"><i class="fa fa-check"></i><b>10.7.1</b> Rodents</a></li>
<li class="chapter" data-level="10.7.2" data-path="exercises-7.html"><a href="exercises-7.html#giving-in-the-church-of-england"><i class="fa fa-check"></i><b>10.7.2</b> Giving in the Church of England</a></li>
<li class="chapter" data-level="10.7.3" data-path="exercises-7.html"><a href="exercises-7.html#black-cherry-trees"><i class="fa fa-check"></i><b>10.7.3</b> Black Cherry trees</a></li>
<li class="chapter" data-level="10.7.4" data-path="exercises-7.html"><a href="exercises-7.html#cats"><i class="fa fa-check"></i><b>10.7.4</b> Cats</a></li>
<li class="chapter" data-level="10.7.5" data-path="exercises-7.html"><a href="exercises-7.html#respiratory-distress-syndrome"><i class="fa fa-check"></i><b>10.7.5</b> Respiratory distress syndrome</a></li>
<li class="chapter" data-level="10.7.6" data-path="exercises-7.html"><a href="exercises-7.html#the-clyde-data"><i class="fa fa-check"></i><b>10.7.6</b> The Clyde data</a></li>
<li class="chapter" data-level="10.7.7" data-path="exercises-7.html"><a href="exercises-7.html#water-quality-in-loch-leven"><i class="fa fa-check"></i><b>10.7.7</b> Water quality in Loch Leven</a></li>
<li class="chapter" data-level="10.7.8" data-path="exercises-7.html"><a href="exercises-7.html#so_2-over-europe"><i class="fa fa-check"></i><b>10.7.8</b> SO<span class="math inline">\(_2\)</span> over Europe</a></li>
<li class="chapter" data-level="10.7.9" data-path="exercises-7.html"><a href="exercises-7.html#maximal-heart-rate-and-age"><i class="fa fa-check"></i><b>10.7.9</b> Maximal heart rate and age</a></li>
<li class="chapter" data-level="10.7.10" data-path="exercises-7.html"><a href="exercises-7.html#the-effects-of-conservation"><i class="fa fa-check"></i><b>10.7.10</b> The effects of conservation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="issues-in-experimental-design.html"><a href="issues-in-experimental-design.html"><i class="fa fa-check"></i><b>11</b> Issues in experimental design</a>
<ul>
<li class="chapter" data-level="11.1" data-path="power.html"><a href="power.html"><i class="fa fa-check"></i><b>11.1</b> Power</a></li>
<li class="chapter" data-level="11.2" data-path="principles-of-experimental-design.html"><a href="principles-of-experimental-design.html"><i class="fa fa-check"></i><b>11.2</b> Principles of experimental design</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="principles-of-experimental-design.html"><a href="principles-of-experimental-design.html#control"><i class="fa fa-check"></i><b>11.2.1</b> Control</a></li>
<li class="chapter" data-level="11.2.2" data-path="principles-of-experimental-design.html"><a href="principles-of-experimental-design.html#replicate"><i class="fa fa-check"></i><b>11.2.2</b> Replicate</a></li>
<li class="chapter" data-level="11.2.3" data-path="principles-of-experimental-design.html"><a href="principles-of-experimental-design.html#randomise"><i class="fa fa-check"></i><b>11.2.3</b> Randomise</a></li>
<li class="chapter" data-level="11.2.4" data-path="principles-of-experimental-design.html"><a href="principles-of-experimental-design.html#replication-and-pseudo-replication"><i class="fa fa-check"></i><b>11.2.4</b> Replication and Pseudo-Replication</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="exercises-8.html"><a href="exercises-8.html"><i class="fa fa-check"></i><b>11.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="exercises-8.html"><a href="exercises-8.html#student-cost-of-living"><i class="fa fa-check"></i><b>11.3.1</b> Student cost of living</a></li>
<li class="chapter" data-level="11.3.2" data-path="exercises-8.html"><a href="exercises-8.html#us-presidential-election-1936"><i class="fa fa-check"></i><b>11.3.2</b> US presidential election 1936</a></li>
<li class="chapter" data-level="11.3.3" data-path="exercises-8.html"><a href="exercises-8.html#the-parable-of-the-sower"><i class="fa fa-check"></i><b>11.3.3</b> The parable of the sower</a></li>
<li class="chapter" data-level="11.3.4" data-path="exercises-8.html"><a href="exercises-8.html#mururoa"><i class="fa fa-check"></i><b>11.3.4</b> Mururoa</a></li>
<li class="chapter" data-level="11.3.5" data-path="exercises-8.html"><a href="exercises-8.html#a-scottish-firth"><i class="fa fa-check"></i><b>11.3.5</b> A Scottish firth</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="issues-in-building-models.html"><a href="issues-in-building-models.html"><i class="fa fa-check"></i><b>12</b> Issues in building models</a>
<ul>
<li class="chapter" data-level="12.1" data-path="what-are-models-for.html"><a href="what-are-models-for.html"><i class="fa fa-check"></i><b>12.1</b> What are models for?</a></li>
<li class="chapter" data-level="12.2" data-path="model-selection.html"><a href="model-selection.html"><i class="fa fa-check"></i><b>12.2</b> Model selection</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html"><i class="fa fa-check"></i><b>13</b> Generalised linear models</a>
<ul>
<li class="chapter" data-level="13.1" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>13.1</b> Binomial data: logistic regression</a></li>
<li class="chapter" data-level="13.2" data-path="likelihood.html"><a href="likelihood.html"><i class="fa fa-check"></i><b>13.2</b> The concept of likelihood</a></li>
<li class="chapter" data-level="13.3" data-path="poisson-regression.html"><a href="poisson-regression.html"><i class="fa fa-check"></i><b>13.3</b> Count data: Poisson regression</a></li>
<li class="chapter" data-level="13.4" data-path="general-glms.html"><a href="general-glms.html"><i class="fa fa-check"></i><b>13.4</b> A general formulation of GLMs</a></li>
<li class="chapter" data-level="13.5" data-path="further-examples.html"><a href="further-examples.html"><i class="fa fa-check"></i><b>13.5</b> Further examples</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="further-examples.html"><a href="further-examples.html#two-covariates-vasoconstriction-of-the-digits"><i class="fa fa-check"></i><b>13.5.1</b> Two covariates: vasoconstriction of the digits</a></li>
<li class="chapter" data-level="13.5.2" data-path="further-examples.html"><a href="further-examples.html#doctors-and-smoking"><i class="fa fa-check"></i><b>13.5.2</b> Doctors and smoking</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="exercises-9.html"><a href="exercises-9.html"><i class="fa fa-check"></i><b>13.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="exercises-9.html"><a href="exercises-9.html#the-glasgow-coma-scale"><i class="fa fa-check"></i><b>13.6.1</b> The Glasgow Coma Scale</a></li>
<li class="chapter" data-level="13.6.2" data-path="exercises-9.html"><a href="exercises-9.html#bissell-data"><i class="fa fa-check"></i><b>13.6.2</b> Bissell data</a></li>
<li class="chapter" data-level="13.6.3" data-path="exercises-9.html"><a href="exercises-9.html#vasoconstriction-data"><i class="fa fa-check"></i><b>13.6.3</b> Vasoconstriction data</a></li>
<li class="chapter" data-level="13.6.4" data-path="exercises-9.html"><a href="exercises-9.html#the-framingham-heart-study"><i class="fa fa-check"></i><b>13.6.4</b> The Framingham heart study</a></li>
<li class="chapter" data-level="13.6.5" data-path="exercises-9.html"><a href="exercises-9.html#the-shape-of-a-log-likelihood-function"><i class="fa fa-check"></i><b>13.6.5</b> The shape of a log-likelihood function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="models-with-random-effects.html"><a href="models-with-random-effects.html"><i class="fa fa-check"></i><b>14</b> Models with random effects</a>
<ul>
<li class="chapter" data-level="14.1" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>14.1</b> Examples</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="examples.html"><a href="examples.html#the-manufacture-of-penicillin"><i class="fa fa-check"></i><b>14.1.1</b> The manufacture of penicillin</a></li>
<li class="chapter" data-level="14.1.2" data-path="examples.html"><a href="examples.html#childhood-growth"><i class="fa fa-check"></i><b>14.1.2</b> Childhood growth</a></li>
<li class="chapter" data-level="14.1.3" data-path="examples.html"><a href="examples.html#the-strength-of-paste"><i class="fa fa-check"></i><b>14.1.3</b> The strength of paste</a></li>
<li class="chapter" data-level="14.1.4" data-path="examples.html"><a href="examples.html#common-features"><i class="fa fa-check"></i><b>14.1.4</b> Common features</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="formulating-and-fitting-mixed-effects-models.html"><a href="formulating-and-fitting-mixed-effects-models.html"><i class="fa fa-check"></i><b>14.2</b> Formulating and fitting mixed effects models</a></li>
<li class="chapter" data-level="14.3" data-path="inference-with-mixed-models.html"><a href="inference-with-mixed-models.html"><i class="fa fa-check"></i><b>14.3</b> Inference with mixed models</a></li>
<li class="chapter" data-level="14.4" data-path="further-examples-of-mixed-models.html"><a href="further-examples-of-mixed-models.html"><i class="fa fa-check"></i><b>14.4</b> Further examples of mixed models</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="further-examples-of-mixed-models.html"><a href="further-examples-of-mixed-models.html#childhood-growth-1"><i class="fa fa-check"></i><b>14.4.1</b> Childhood growth</a></li>
<li class="chapter" data-level="14.4.2" data-path="further-examples-of-mixed-models.html"><a href="further-examples-of-mixed-models.html#the-strength-of-paste-1"><i class="fa fa-check"></i><b>14.4.2</b> The strength of paste</a></li>
<li class="chapter" data-level="14.4.3" data-path="further-examples-of-mixed-models.html"><a href="further-examples-of-mixed-models.html#the-sleep-deprivation-study"><i class="fa fa-check"></i><b>14.4.3</b> The sleep deprivation study</a></li>
<li class="chapter" data-level="14.4.4" data-path="further-examples-of-mixed-models.html"><a href="further-examples-of-mixed-models.html#reading-attainment-in-primary-school"><i class="fa fa-check"></i><b>14.4.4</b> Reading attainment in primary school</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="non-linear-mixed-models.html"><a href="non-linear-mixed-models.html"><i class="fa fa-check"></i><b>14.5</b> Non-linear mixed models</a></li>
<li class="chapter" data-level="14.6" data-path="generalised-linear-mixed-models.html"><a href="generalised-linear-mixed-models.html"><i class="fa fa-check"></i><b>14.6</b> Generalised linear mixed models</a></li>
<li class="chapter" data-level="14.7" data-path="further-reading-4.html"><a href="further-reading-4.html"><i class="fa fa-check"></i><b>14.7</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="flexible-models.html"><a href="flexible-models.html"><i class="fa fa-check"></i><b>15</b> Flexible models</a>
<ul>
<li class="chapter" data-level="15.1" data-path="flexible-methods.html"><a href="flexible-methods.html"><i class="fa fa-check"></i><b>15.1</b> Methods for constructing flexible models</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="flexible-methods.html"><a href="flexible-methods.html#fitting-models-locally"><i class="fa fa-check"></i><b>15.1.1</b> Fitting models locally</a></li>
<li class="chapter" data-level="15.1.2" data-path="flexible-methods.html"><a href="flexible-methods.html#splines"><i class="fa fa-check"></i><b>15.1.2</b> Splines</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="inference-with-simple-flexible-models.html"><a href="inference-with-simple-flexible-models.html"><i class="fa fa-check"></i><b>15.2</b> Inference with simple flexible models</a></li>
<li class="chapter" data-level="15.3" data-path="a-simple-additive-model.html"><a href="a-simple-additive-model.html"><i class="fa fa-check"></i><b>15.3</b> A simple additive model</a></li>
<li class="chapter" data-level="15.4" data-path="inference-with-additive-models.html"><a href="inference-with-additive-models.html"><i class="fa fa-check"></i><b>15.4</b> Inference with additive models</a></li>
<li class="chapter" data-level="15.5" data-path="further-reading-5.html"><a href="further-reading-5.html"><i class="fa fa-check"></i><b>15.5</b> Further reading</a></li>
<li class="chapter" data-level="15.6" data-path="exercises-10.html"><a href="exercises-10.html"><i class="fa fa-check"></i><b>15.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="exercises-10.html"><a href="exercises-10.html#fitting-a-p-spline-model"><i class="fa fa-check"></i><b>15.6.1</b> Fitting a p-spline model</a></li>
<li class="chapter" data-level="15.6.2" data-path="exercises-10.html"><a href="exercises-10.html#the-backfitting-algorithm"><i class="fa fa-check"></i><b>15.6.2</b> The backfitting algorithm</a></li>
<li class="chapter" data-level="15.6.3" data-path="exercises-10.html"><a href="exercises-10.html#water-quality-in-the-clyde-estuary"><i class="fa fa-check"></i><b>15.6.3</b> Water quality in the Clyde estuary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="models-for-time.html"><a href="models-for-time.html"><i class="fa fa-check"></i><b>16</b> Models for time</a>
<ul>
<li class="chapter" data-level="16.1" data-path="time-series-data.html"><a href="time-series-data.html"><i class="fa fa-check"></i><b>16.1</b> Time series data</a></li>
<li class="chapter" data-level="16.2" data-path="visualisation.html"><a href="visualisation.html"><i class="fa fa-check"></i><b>16.2</b> Visualisation</a></li>
<li class="chapter" data-level="16.3" data-path="models.html"><a href="models.html"><i class="fa fa-check"></i><b>16.3</b> Models</a></li>
<li class="chapter" data-level="16.4" data-path="further-reading-6.html"><a href="further-reading-6.html"><i class="fa fa-check"></i><b>16.4</b> Further reading</a></li>
<li class="chapter" data-level="16.5" data-path="exercises-11.html"><a href="exercises-11.html"><i class="fa fa-check"></i><b>16.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="16.5.1" data-path="exercises-11.html"><a href="exercises-11.html#simulating-time-series"><i class="fa fa-check"></i><b>16.5.1</b> Simulating time series</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="models-for-space.html"><a href="models-for-space.html"><i class="fa fa-check"></i><b>17</b> Models for space</a>
<ul>
<li class="chapter" data-level="17.1" data-path="visualising-spatial-data.html"><a href="visualising-spatial-data.html"><i class="fa fa-check"></i><b>17.1</b> Visualising spatial data</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="visualising-spatial-data.html"><a href="visualising-spatial-data.html#the-maps-package"><i class="fa fa-check"></i><b>17.1.1</b> The <code>maps</code> package</a></li>
<li class="chapter" data-level="17.1.2" data-path="visualising-spatial-data.html"><a href="visualising-spatial-data.html#leaflet-and-mapview-interactive-maps"><i class="fa fa-check"></i><b>17.1.2</b> <code>leaflet</code> and <code>mapview</code>: interactive maps</a></li>
<li class="chapter" data-level="17.1.3" data-path="visualising-spatial-data.html"><a href="visualising-spatial-data.html#ggplot-and-ggmap"><i class="fa fa-check"></i><b>17.1.3</b> <code>ggplot</code> and <code>ggmap</code></a></li>
<li class="chapter" data-level="17.1.4" data-path="visualising-spatial-data.html"><a href="visualising-spatial-data.html#tmap"><i class="fa fa-check"></i><b>17.1.4</b> <code>tmap</code></a></li>
<li class="chapter" data-level="17.1.5" data-path="visualising-spatial-data.html"><a href="visualising-spatial-data.html#spatstat-for-spatial-point-patterns"><i class="fa fa-check"></i><b>17.1.5</b> <code>spatstat</code> for spatial point patterns</a></li>
<li class="chapter" data-level="17.1.6" data-path="visualising-spatial-data.html"><a href="visualising-spatial-data.html#areal-data"><i class="fa fa-check"></i><b>17.1.6</b> Areal data</a></li>
<li class="chapter" data-level="17.1.7" data-path="visualising-spatial-data.html"><a href="visualising-spatial-data.html#image-data"><i class="fa fa-check"></i><b>17.1.7</b> Image data</a></li>
<li class="chapter" data-level="17.1.8" data-path="visualising-spatial-data.html"><a href="visualising-spatial-data.html#spatiotemporal-animation"><i class="fa fa-check"></i><b>17.1.8</b> Spatiotemporal animation</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="models-for-point-pattern-data.html"><a href="models-for-point-pattern-data.html"><i class="fa fa-check"></i><b>17.2</b> Models for point pattern data</a></li>
<li class="chapter" data-level="17.3" data-path="geostatistical-models.html"><a href="geostatistical-models.html"><i class="fa fa-check"></i><b>17.3</b> Geostatistical models</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="geostatistical-models.html"><a href="geostatistical-models.html#gaussian-random-fields"><i class="fa fa-check"></i><b>17.3.1</b> Gaussian random fields</a></li>
<li class="chapter" data-level="17.3.2" data-path="geostatistical-models.html"><a href="geostatistical-models.html#geostatistical-models-1"><i class="fa fa-check"></i><b>17.3.2</b> Geostatistical models</a></li>
<li class="chapter" data-level="17.3.3" data-path="geostatistical-models.html"><a href="geostatistical-models.html#so2-a-model-based-on-smoothing"><i class="fa fa-check"></i><b>17.3.3</b> SO2: a model based on smoothing</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="models-for-areal-data.html"><a href="models-for-areal-data.html"><i class="fa fa-check"></i><b>17.4</b> Models for areal data</a></li>
<li class="chapter" data-level="17.5" data-path="further-reading-7.html"><a href="further-reading-7.html"><i class="fa fa-check"></i><b>17.5</b> Further reading</a></li>
</ul></li>
<li class="part"><span><b>V Statistical Models in Practice</b></span></li>
<li class="chapter" data-level="18" data-path="case-studies-of-statistical-modelling.html"><a href="case-studies-of-statistical-modelling.html"><i class="fa fa-check"></i><b>18</b> Case studies of statistical modelling</a>
<ul>
<li class="chapter" data-level="18.1" data-path="covid-19-initial-surveillance.html"><a href="covid-19-initial-surveillance.html"><i class="fa fa-check"></i><b>18.1</b> Covid-19 initial surveillance</a></li>
<li class="chapter" data-level="18.2" data-path="childrens-services-reform-in-scotland.html"><a href="childrens-services-reform-in-scotland.html"><i class="fa fa-check"></i><b>18.2</b> Children’s services reform in Scotland</a></li>
</ul></li>
<li class="part"><span><b>VI Other topics</b></span></li>
<li class="chapter" data-level="19" data-path="more-on-r.html"><a href="more-on-r.html"><i class="fa fa-check"></i><b>19</b> More on R</a>
<ul>
<li class="chapter" data-level="19.1" data-path="repetition.html"><a href="repetition.html"><i class="fa fa-check"></i><b>19.1</b> Repetition</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="repetition.html"><a href="repetition.html#standard-loops"><i class="fa fa-check"></i><b>19.1.1</b> Standard loops</a></li>
<li class="chapter" data-level="19.1.2" data-path="repetition.html"><a href="repetition.html#the-apply-family"><i class="fa fa-check"></i><b>19.1.2</b> The ‘apply’ family</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="writing-your-own-functions.html"><a href="writing-your-own-functions.html"><i class="fa fa-check"></i><b>19.2</b> Writing your own functions</a></li>
<li class="chapter" data-level="19.3" data-path="conditional-statements-and-while-loops.html"><a href="conditional-statements-and-while-loops.html"><i class="fa fa-check"></i><b>19.3</b> Conditional statements and <code>while</code> loops</a></li>
<li class="chapter" data-level="19.4" data-path="further-reading-8.html"><a href="further-reading-8.html"><i class="fa fa-check"></i><b>19.4</b> Further reading</a></li>
<li class="chapter" data-level="19.5" data-path="exercises-12.html"><a href="exercises-12.html"><i class="fa fa-check"></i><b>19.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="exercises-12.html"><a href="exercises-12.html#a-simple-function"><i class="fa fa-check"></i><b>19.5.1</b> A simple function</a></li>
<li class="chapter" data-level="19.5.2" data-path="exercises-12.html"><a href="exercises-12.html#a-simple-function-thresholds"><i class="fa fa-check"></i><b>19.5.2</b> A simple function: thresholds</a></li>
<li class="chapter" data-level="19.5.3" data-path="exercises-12.html"><a href="exercises-12.html#improving-the-sim.max-function"><i class="fa fa-check"></i><b>19.5.3</b> Improving the sim.max function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Modelling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="visualising-spatial-data" class="section level2 hasAnchor" number="17.1">
<h2><span class="header-section-number">17.1</span> Visualising spatial data<a href="visualising-spatial-data.html#visualising-spatial-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are many powerful tools for plotting spatial data and some of these are mentioned in this section. Many of these are also able to handle some of the special considerations neded for spatial data. The <em>co-ordinate reference system</em> (CRS) is one of those. Latitude and longitude are standard co-ordinates but data can often be spatially indexed in other ways, for example through Easting and Northing in a local reference system. Another issue is the use of <em>shapefiles</em> which contain the boundaries of regions of interest and other information. The <code>sf</code> package provides support for the <em>simple features</em> standard for representing spatial information.</p>
<div id="the-maps-package" class="section level3 hasAnchor" number="17.1.1">
<h3><span class="header-section-number">17.1.1</span> The <code>maps</code> package<a href="visualising-spatial-data.html#the-maps-package" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This package provides some basic tools for drawing countries and regions on standard plots. In the chapter on flexible models, data on SO<span class="math inline">\(_2\)</span> across Europe was used as an example. The code below uses the <code>map</code> function to plot the locations of othe active monitoring stations in January 1990. Notice the use of :: because the function <code>map</code> is present in both the <code>maps</code> package and the <code>tidyverse</code>.</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="visualising-spatial-data.html#cb292-1" tabindex="-1"></a><span class="fu">library</span>(rpanel)</span>
<span id="cb292-2"><a href="visualising-spatial-data.html#cb292-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb292-3"><a href="visualising-spatial-data.html#cb292-3" tabindex="-1"></a><span class="fu">library</span>(maps)</span>
<span id="cb292-4"><a href="visualising-spatial-data.html#cb292-4" tabindex="-1"></a>SO2_1990 <span class="ot">&lt;-</span> SO2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">1990</span> <span class="sc">&amp;</span> month <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb292-5"><a href="visualising-spatial-data.html#cb292-5" tabindex="-1"></a><span class="fu">with</span>(SO2, {</span>
<span id="cb292-6"><a href="visualising-spatial-data.html#cb292-6" tabindex="-1"></a>  maps<span class="sc">::</span><span class="fu">map</span>(<span class="at">xlim =</span> <span class="fu">range</span>(longitude), <span class="at">ylim =</span> <span class="fu">range</span>(latitude))</span>
<span id="cb292-7"><a href="visualising-spatial-data.html#cb292-7" tabindex="-1"></a>  <span class="fu">points</span>(longitude, latitude, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb292-8"><a href="visualising-spatial-data.html#cb292-8" tabindex="-1"></a>})</span></code></pre></div>
<p><img src="book_files/figure-html/SO2_read-1.png" alt="" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="leaflet-and-mapview-interactive-maps" class="section level3 hasAnchor" number="17.1.2">
<h3><span class="header-section-number">17.1.2</span> <code>leaflet</code> and <code>mapview</code>: interactive maps<a href="visualising-spatial-data.html#leaflet-and-mapview-interactive-maps" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One of the very good features of <code>R</code> is that it can connect to many other computing systems, making these environments available without leaving <code>R</code>. One example is the <a href="https://leafletjs.com">leaflet</a> Javascript library which provides many useful tools for the creation of interactive maps. Here is a simple example. When the code is executed in <code>R</code> it creates a map which can be scrolled and zoomed.</p>
<p>The <code>addTiles</code> function uses Open Street Map by default. Note the use of the <code>~</code> symbol in front of variable names. The <code>popup</code> argument allows us to</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="visualising-spatial-data.html#cb293-1" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb293-2"><a href="visualising-spatial-data.html#cb293-2" tabindex="-1"></a><span class="fu">leaflet</span>(SO2_1990) <span class="sc">%&gt;%</span> <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span> <span class="fu">addCircles</span>(<span class="sc">~</span>longitude, <span class="sc">~</span>latitude, </span>
<span id="cb293-3"><a href="visualising-spatial-data.html#cb293-3" tabindex="-1"></a>                  <span class="at">col =</span> <span class="st">&#39;red&#39;</span>, <span class="at">popup =</span> <span class="sc">~</span>site)</span></code></pre></div>
<div class="leaflet html-widget html-fill-item" id="htmlwidget-a4dcde73a26e1d9ce72f" style="width:70%;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-a4dcde73a26e1d9ce72f">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addCircles","args":[[47.76666666666667,43.76666666666667,49.87777777777778,52.33333333333334,46.55,46.81666666666667,49.73333333333333,49.58333333333334,54.92555555555555,52.80222222222222,47.91472222222222,49.76472222222223,48.81944444444444,54.68333333333333,53.16666666666666,52.85,51.11666666666667,50.33333333333334,49.3,48.48333333333333,48.01666666666667,50.31666666666667,56.35,54.73333333333333,61.4,59.5,39.54777777777777,37.2,40.82055555555556,42.45777777777778,62.53333333333333,59.77916666666667,60.52666666666666,66.32027777777778,45.83333333333334,48.5,47.26666666666667,46.81666666666667,43.03333333333333,55.31305555555556,52.56666666666667,54.44305555555555,50.86666666666667,50.59638888888889,54.33444444444444,57.73444444444444,56.96666666666667,38.36666666666667,46.96666666666667,51.93972222222222,45.8,46.51666666666667,56.21666666666667,46.5,41.32,52.81666666666667,52.11666666666667,53.33388888888889,51.54111111111111,58.38333333333333,58.81666666666667,65.83333333333333,69.40000000000001,62.78333333333333,61.25,54.13333333333333,51.81666666666667,41.81666666666667,38.08333333333334,68.93333333333334,57.41666666666666,63.85,56.91666666666666,56.01666666666667,58.8,67.88333333333334,48.93333333333333,50.25,43.4],[16.76666666666667,18.03333333333333,5.203611111111111,23.43333333333333,7.983055555555556,6.95,16.03333333333333,15.08333333333333,8.309722222222222,10.75944444444444,7.908611111111111,7.051944444444445,13.21916666666667,13.43333333333333,13.03333333333333,8.699999999999999,7.633333333333333,8.533333333333333,10.56666666666667,8.933333333333334,11.35,11.88333333333333,9.6,10.73333333333333,-6.666666666666667,25.9,-4.348611111111111,-3.6,0.4913888888888889,-2.503055555555556,24.22166666666667,21.37722222222222,27.68611111111111,29.40166666666667,1.266666666666667,7.133333333333334,4.083333333333333,6.183333333333334,-1.083333333333333,-3.204166666666667,0.5,-7.87,-0.03305555555555555,-3.713055555555556,-0.8075,-4.774444444444445,-2.416666666666667,23.08333333333333,19.58333333333333,-10.24444444444444,8.633333333333333,11.88333333333333,21.21666666666667,28.26666666666667,20.42,6.666666666666667,5.2,6.277222222222222,5.853611111111111,8.25,6.716666666666667,13.91666666666667,24.6,8.883333333333333,11.78333333333333,22.95,21.98333333333333,-6.766666666666667,-8.800000000000001,28.85,11.93333333333333,15.33333333333333,18.15,13.15,17.38333333333333,21.06666666666667,19.58333333333333,23.63333333333333,21.95],10,null,null,{"interactive":true,"className":"","stroke":true,"color":"red","weight":5,"opacity":0.5,"fill":true,"fillColor":"red","fillOpacity":0.2},["AT02","BA06","BE01","BY04","CH01","CH02","CZ01","CZ03","DE01","DE02","DE03","DE04","DE05","DE06","DE07","DE12","DE14","DE15","DE17","DE18","DE19","DE20","DK03","DK05","DK07","EE09","ES01","ES02","ES03","ES04","FI04","FI09","FI17","FI22","FR03","FR08","FR10","FR11","FR12","GB02","GB04","GB06","GB07","GB13","GB14","GB15","GB16","GR01","HU02","IE01","IT04","IT05","LV10","MD12","MK07","NL02","NL08","NL09","NL10","NO01","NO08","NO15","NO30","NO39","NO41","PL01","PL02","PT01","PT04","RU01","SE02","SE05","SE08","SE11","SE12","SE13","SK02","UA06","YU05"],null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null,null]}],"limits":{"lat":[37.2,69.40000000000001],"lng":[-10.24444444444444,29.40166666666667]}},"evals":[],"jsHooks":[]}</script>
<p>The <code>mapview</code> package offers another means of creating interactive maps and it can use <code>leaflet</code> as its ‘engine’.</p>
</div>
<div id="ggplot-and-ggmap" class="section level3 hasAnchor" number="17.1.3">
<h3><span class="header-section-number">17.1.3</span> <code>ggplot</code> and <code>ggmap</code><a href="visualising-spatial-data.html#ggplot-and-ggmap" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!-- ```{r child = 'chapters/spatial/qmap_SO2.Rmd'} -->
<!-- ``` -->
<p>The <code>ggplot2</code> visualisation system, part of the <code>tidyverse</code> can handle ‘sf’ information through a <code>geom_sf</code> geometry. An example of this is given in the section on areal data below.</p>
</div>
<div id="tmap" class="section level3 hasAnchor" number="17.1.4">
<h3><span class="header-section-number">17.1.4</span> <code>tmap</code><a href="visualising-spatial-data.html#tmap" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is a popular package which fits well with the <code>tidyverse</code> format of coding, but it will not be covered here.</p>
</div>
<div id="spatstat-for-spatial-point-patterns" class="section level3 hasAnchor" number="17.1.5">
<h3><span class="header-section-number">17.1.5</span> <code>spatstat</code> for spatial point patterns<a href="visualising-spatial-data.html#spatstat-for-spatial-point-patterns" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This package has a variety of useful tools for plotting spatial point patterns.</p>
</div>
<div id="areal-data" class="section level3 hasAnchor" number="17.1.6">
<h3><span class="header-section-number">17.1.6</span> Areal data<a href="visualising-spatial-data.html#areal-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There is a often a wish to investigate regional differences in a map, using well defined boundaries to define the regions of interest. This is a good way to visualise the Scottish Referendum data. A <em>shape file</em>, which provides the co-ordinates of the boundary of each region, has been downloaded from the <em>ONS Open Geography Portal</em>. This has been read into R as an object, using the ‘sf’ package, and then <code>save</code>d to the file <code>UKLA.Rda</code>. <code>load</code>ing this file placess the object <code>councils</code> into the workspace.</p>
<p>The <code>councils</code> object contains details of all the local authorities in the UK so the <code>filter</code> function from the <code>dplyr</code> package is used to select out those identifiers which begin with ‘S’ for Scotland.</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="visualising-spatial-data.html#cb294-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb294-2"><a href="visualising-spatial-data.html#cb294-2" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb294-3"><a href="visualising-spatial-data.html#cb294-3" tabindex="-1"></a></span>
<span id="cb294-4"><a href="visualising-spatial-data.html#cb294-4" tabindex="-1"></a>path     <span class="ot">&lt;-</span> <span class="fu">rp.datalink</span>(<span class="st">&quot;scottish_referendum&quot;</span>)</span>
<span id="cb294-5"><a href="visualising-spatial-data.html#cb294-5" tabindex="-1"></a>ref      <span class="ot">&lt;-</span> <span class="fu">read.table</span>(path, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb294-6"><a href="visualising-spatial-data.html#cb294-6" tabindex="-1"></a></span>
<span id="cb294-7"><a href="visualising-spatial-data.html#cb294-7" tabindex="-1"></a><span class="co"># path     &lt;- &quot;~/iCloud/teaching/book/data_more/UKLA.Rda&quot;</span></span>
<span id="cb294-8"><a href="visualising-spatial-data.html#cb294-8" tabindex="-1"></a><span class="co"># load(path)</span></span>
<span id="cb294-9"><a href="visualising-spatial-data.html#cb294-9" tabindex="-1"></a>path     <span class="ot">&lt;-</span> <span class="st">&quot;~/iCloud/teaching/book/data_more/Local_Authority_Districts_December_2023_Boundaries_UK_BUC_-1729940581044841319/LAD_DEC_2023_UK_BUC.shp&quot;</span></span>
<span id="cb294-10"><a href="visualising-spatial-data.html#cb294-10" tabindex="-1"></a><span class="co"># dest &lt;- tempfile()</span></span>
<span id="cb294-11"><a href="visualising-spatial-data.html#cb294-11" tabindex="-1"></a><span class="co"># download.file(path, dest)</span></span>
<span id="cb294-12"><a href="visualising-spatial-data.html#cb294-12" tabindex="-1"></a><span class="co"># dest1 &lt;- tempfile()</span></span>
<span id="cb294-13"><a href="visualising-spatial-data.html#cb294-13" tabindex="-1"></a><span class="co"># unzip(dest, exdir = dest1)</span></span>
<span id="cb294-14"><a href="visualising-spatial-data.html#cb294-14" tabindex="-1"></a><span class="co"># councils &lt;- read_sf(dest1)</span></span>
<span id="cb294-15"><a href="visualising-spatial-data.html#cb294-15" tabindex="-1"></a>councils <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(path)</span>
<span id="cb294-16"><a href="visualising-spatial-data.html#cb294-16" tabindex="-1"></a>councils <span class="ot">&lt;-</span> councils[<span class="fu">substr</span>(councils<span class="sc">$</span>LAD23CD, <span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">==</span> <span class="st">&quot;S&quot;</span>, ]</span></code></pre></div>
<p>We then need to merge these two dataframes, <code>councils</code> and <code>ref</code>. The Council name is the obvious way to link the two but we need to check that the same names have been used. The code below checks whether each name in <code>ref</code> can be found in <code>councils.  This throws up some exceptions, so the</code>mutate<code>function from</code>dplyr<code>is used to recode these names in</code>councils<code>to match.  The</code>left_join<code>function from</code>dplyr<code>can then be used to merge the</code>ref<code>dataframe into</code>councils`.</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="visualising-spatial-data.html#cb295-1" tabindex="-1"></a>ind <span class="ot">&lt;-</span> ref<span class="sc">$</span>Scottish.Council <span class="sc">%in%</span> councils<span class="sc">$</span>LAD23NM</span>
<span id="cb295-2"><a href="visualising-spatial-data.html#cb295-2" tabindex="-1"></a>ref<span class="sc">$</span>Scottish.Council[<span class="sc">!</span>ind]</span></code></pre></div>
<pre><code>## [1] &quot;Aberdeen&quot;    &quot;Dundee&quot;      &quot;Edinburgh&quot;   &quot;Eilean Siar&quot; &quot;Glasgow&quot;</code></pre>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="visualising-spatial-data.html#cb297-1" tabindex="-1"></a>councils <span class="ot">&lt;-</span> <span class="fu">mutate</span>(councils,</span>
<span id="cb297-2"><a href="visualising-spatial-data.html#cb297-2" tabindex="-1"></a>                   <span class="at">Scottish.Council =</span> <span class="fu">recode</span>(LAD23NM,</span>
<span id="cb297-3"><a href="visualising-spatial-data.html#cb297-3" tabindex="-1"></a>                            <span class="st">`</span><span class="at">Na h-Eileanan Siar</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;Eilean Siar&quot;</span>,</span>
<span id="cb297-4"><a href="visualising-spatial-data.html#cb297-4" tabindex="-1"></a>                            <span class="st">`</span><span class="at">Aberdeen City</span><span class="st">`</span>      <span class="ot">=</span> <span class="st">&quot;Aberdeen&quot;</span>,</span>
<span id="cb297-5"><a href="visualising-spatial-data.html#cb297-5" tabindex="-1"></a>                            <span class="st">`</span><span class="at">Glasgow City</span><span class="st">`</span>       <span class="ot">=</span> <span class="st">&quot;Glasgow&quot;</span>,</span>
<span id="cb297-6"><a href="visualising-spatial-data.html#cb297-6" tabindex="-1"></a>                            <span class="st">`</span><span class="at">Dundee City</span><span class="st">`</span>        <span class="ot">=</span> <span class="st">&quot;Dundee&quot;</span>,</span>
<span id="cb297-7"><a href="visualising-spatial-data.html#cb297-7" tabindex="-1"></a>                            <span class="st">`</span><span class="at">City of Edinburgh</span><span class="st">`</span>  <span class="ot">=</span> <span class="st">&quot;Edinburgh&quot;</span>))</span>
<span id="cb297-8"><a href="visualising-spatial-data.html#cb297-8" tabindex="-1"></a>councils <span class="ot">&lt;-</span> <span class="fu">left_join</span>(councils, ref, <span class="at">by =</span> <span class="st">&quot;Scottish.Council&quot;</span>)</span></code></pre></div>
<p>Now we can plot the council regions as a map, using the <code>geom_sf</code> function in <code>ggplot2</code> to handle all the drawing for us, and using a variable of interest to define the fill colour. Here we plot the proportion in each region voting ‘no’, plus a rescaling to show which regions have a majority for ‘yes’ or no’, and the level of turnout.</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="visualising-spatial-data.html#cb298-1" tabindex="-1"></a><span class="fu">ggplot</span>(councils, <span class="fu">aes</span>(<span class="at">fill =</span> Voted.no)) <span class="sc">+</span> <span class="fu">geom_sf</span>()</span></code></pre></div>
<p><img src="book_files/figure-html/referendum_data_merged_plot_again-1.png" alt="" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="image-data" class="section level3 hasAnchor" number="17.1.7">
<h3><span class="header-section-number">17.1.7</span> Image data<a href="visualising-spatial-data.html#image-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Not all datasets can be structured easily into simple row and column format. Even for those which can, the dataset may be so large that more efficient and compact forms of storage are required. For example, the <code>netCDF</code> (network Common Data Form) is commonly used to store data which has an array structure, often corresponding to dense spatial and temporal measurements, but involving multiple variables. These datasets may be large in size. Satellite data is one example. The <code>netCDF</code> standard is widely used to achieve efficient storage. The <code>ncdf4</code> package in R provides tools for reading, handling and plotting this form of data.</p>
<p>An <a href="https://theconversation.com/an-extreme-heatwave-has-hit-the-seas-around-the-uk-and-ireland-heres-whats-going-on-208052?utm_medium=email&amp;utm_campaign=Latest%20from%20The%20Conversation%20for%20June%2021%202023%20-%202658726822&amp;utm_content=Latest%20from%20The%20Conversation%20for%20June%2021%202023%20-%202658726822+CID_d5ca938fc0c6a44b82fe010eac547815&amp;utm_source=campaign_monitor_uk&amp;utm_term=An%20extreme%20heatwave%20has%20hit%20the%20seas%20around%20the%20UK%20and%20Ireland%20%20heres%20whats%20going%20on">article</a> on a heatwave in the sea around the UK in 2023 used satellite data from the National Oceanic and Atmospheric Administration (NOAA) in the USA. Sea surface temperature is one of the key climate change indicators.</p>
<p>The data for June 18, 2023 can be read from the NOAA repository using the file download mechanism discussed above. The <code>ncdf4</code> package can then be used to extract the data we need. Use of the functions within the package require careful study of the help files and other documentation. The code below illustrates what can be done.</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="visualising-spatial-data.html#cb299-1" tabindex="-1"></a><span class="fu">library</span>(rpanel)</span>
<span id="cb299-2"><a href="visualising-spatial-data.html#cb299-2" tabindex="-1"></a><span class="fu">library</span>(ncdf4)</span>
<span id="cb299-3"><a href="visualising-spatial-data.html#cb299-3" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="fu">rp.datalink</span>(<span class="st">&quot;sea_surface_temperature&quot;</span>)</span>
<span id="cb299-4"><a href="visualising-spatial-data.html#cb299-4" tabindex="-1"></a>nc_data   <span class="ot">&lt;-</span> <span class="fu">nc_open</span>(path)</span>
<span id="cb299-5"><a href="visualising-spatial-data.html#cb299-5" tabindex="-1"></a><span class="co"># print(nc_data)</span></span>
<span id="cb299-6"><a href="visualising-spatial-data.html#cb299-6" tabindex="-1"></a>lon       <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(nc_data, <span class="st">&quot;lon&quot;</span>)</span>
<span id="cb299-7"><a href="visualising-spatial-data.html#cb299-7" tabindex="-1"></a>lat       <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(nc_data, <span class="st">&quot;lat&quot;</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb299-8"><a href="visualising-spatial-data.html#cb299-8" tabindex="-1"></a>anom      <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(nc_data, <span class="st">&quot;anom&quot;</span>)</span>
<span id="cb299-9"><a href="visualising-spatial-data.html#cb299-9" tabindex="-1"></a>fillvalue <span class="ot">&lt;-</span> <span class="fu">ncatt_get</span>(nc_data, <span class="st">&quot;anom&quot;</span>, <span class="st">&quot;_FillValue&quot;</span>)</span>
<span id="cb299-10"><a href="visualising-spatial-data.html#cb299-10" tabindex="-1"></a>anom[anom <span class="sc">==</span> fillvalue<span class="sc">$</span>value] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb299-11"><a href="visualising-spatial-data.html#cb299-11" tabindex="-1"></a><span class="fu">nc_close</span>(nc_data)</span></code></pre></div>
<p>This opens the datafile and extracts the latitude and longitude information as vectors which index the rows and columns of the matrix of anomaly (deviations from a long term average) measurements. The <code>print(nc_data)</code> instruction displays a lot of information on the content and source of the dataset but has been commented out above to save space. Missing data are also given the usual R representation.</p>
<p>To plot the data efficiently, the <code>raster</code> package is first used to put the data in <em>raster</em> format.</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="visualising-spatial-data.html#cb300-1" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb300-2"><a href="visualising-spatial-data.html#cb300-2" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="fu">t</span>(anom), <span class="at">xmn =</span> <span class="fu">min</span>(lon), <span class="at">xmx =</span> <span class="fu">max</span>(lon), <span class="at">ymn =</span> <span class="fu">min</span>(lat), <span class="at">ymx =</span> <span class="fu">max</span>(lat), <span class="at">crs =</span> <span class="fu">CRS</span>(<span class="st">&quot;+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs+ towgs84=0,0,0&quot;</span>))</span>
<span id="cb300-3"><a href="visualising-spatial-data.html#cb300-3" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">flip</span>(r, <span class="at">direction =</span> <span class="st">&#39;y&#39;</span>)</span>
<span id="cb300-4"><a href="visualising-spatial-data.html#cb300-4" tabindex="-1"></a><span class="fu">plot</span>(r)</span></code></pre></div>
<p><img src="book_files/figure-html/sst_plot-1.png" alt="" width="70%" style="display: block; margin: auto;" /></p>
<p>To explore the high temperatures near the UK in more detail, indicators are used to create a smaller array which focusses on the appropriate latitude and longitudes.</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="visualising-spatial-data.html#cb301-1" tabindex="-1"></a>ind.lon <span class="ot">&lt;-</span> <span class="fu">which</span>(lon <span class="sc">&gt;</span> <span class="dv">345</span> <span class="sc">&amp;</span> lon <span class="sc">&lt;</span> <span class="dv">360</span>)</span>
<span id="cb301-2"><a href="visualising-spatial-data.html#cb301-2" tabindex="-1"></a>ind.lat <span class="ot">&lt;-</span> <span class="fu">which</span>(lat <span class="sc">&gt;</span>  <span class="dv">48</span> <span class="sc">&amp;</span> lat <span class="sc">&lt;</span>  <span class="dv">60</span>)</span>
<span id="cb301-3"><a href="visualising-spatial-data.html#cb301-3" tabindex="-1"></a>anom_UK <span class="ot">&lt;-</span> anom[ind.lon, ind.lat]</span>
<span id="cb301-4"><a href="visualising-spatial-data.html#cb301-4" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="fu">t</span>(anom_UK), <span class="at">xmn=</span><span class="fu">min</span>(lon[ind.lon]), <span class="at">xmx=</span><span class="fu">max</span>(lon[ind.lon]),</span>
<span id="cb301-5"><a href="visualising-spatial-data.html#cb301-5" tabindex="-1"></a>            <span class="at">ymn=</span><span class="fu">min</span>(lat[ind.lat]), <span class="at">ymx=</span><span class="fu">max</span>(lat[ind.lat]),</span>
<span id="cb301-6"><a href="visualising-spatial-data.html#cb301-6" tabindex="-1"></a>            <span class="at">crs=</span><span class="fu">CRS</span>(<span class="st">&quot;+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs+ towgs84=0,0,0&quot;</span>))</span>
<span id="cb301-7"><a href="visualising-spatial-data.html#cb301-7" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">flip</span>(r, <span class="at">direction=</span><span class="st">&#39;y&#39;</span>)</span>
<span id="cb301-8"><a href="visualising-spatial-data.html#cb301-8" tabindex="-1"></a><span class="fu">plot</span>(r)</span></code></pre></div>
<p><img src="book_files/figure-html/sst_plot_UK-1.png" alt="" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="spatiotemporal-animation" class="section level3 hasAnchor" number="17.1.8">
<h3><span class="header-section-number">17.1.8</span> Spatiotemporal animation<a href="visualising-spatial-data.html#spatiotemporal-animation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>rpanel</code> package includes an <code>rp.plot4d</code> function which uses animation to provide an extra dimension to displays. The <code>rp.spacetime</code> version of this function is intended particularly for data over space and time.</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="visualising-spatial-data.html#cb302-1" tabindex="-1"></a><span class="fu">library</span>(rpanel)</span>
<span id="cb302-2"><a href="visualising-spatial-data.html#cb302-2" tabindex="-1"></a></span>
<span id="cb302-3"><a href="visualising-spatial-data.html#cb302-3" tabindex="-1"></a>Month     <span class="ot">&lt;-</span> SO2<span class="sc">$</span>month <span class="sc">+</span> (SO2<span class="sc">$</span>year <span class="sc">-</span> <span class="dv">1990</span>) <span class="sc">*</span> <span class="dv">12</span></span>
<span id="cb302-4"><a href="visualising-spatial-data.html#cb302-4" tabindex="-1"></a>Year      <span class="ot">&lt;-</span> SO2<span class="sc">$</span>year <span class="sc">+</span> (SO2<span class="sc">$</span>month <span class="sc">-</span> <span class="fl">0.5</span>) <span class="sc">/</span> <span class="dv">12</span></span>
<span id="cb302-5"><a href="visualising-spatial-data.html#cb302-5" tabindex="-1"></a>location  <span class="ot">&lt;-</span> <span class="fu">cbind</span>(SO2<span class="sc">$</span>longitude, SO2<span class="sc">$</span>latitude)</span>
<span id="cb302-6"><a href="visualising-spatial-data.html#cb302-6" tabindex="-1"></a>mapxy     <span class="ot">&lt;-</span> maps<span class="sc">::</span><span class="fu">map</span>(<span class="st">&#39;world&#39;</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>,</span>
<span id="cb302-7"><a href="visualising-spatial-data.html#cb302-7" tabindex="-1"></a>                 <span class="at">xlim =</span> <span class="fu">range</span>(SO2<span class="sc">$</span>longitude), <span class="at">ylim =</span> <span class="fu">range</span>(SO2<span class="sc">$</span>latitude))</span>
<span id="cb302-8"><a href="visualising-spatial-data.html#cb302-8" tabindex="-1"></a>back      <span class="ot">&lt;-</span> <span class="cf">function</span>() maps<span class="sc">::</span><span class="fu">map</span>(mapxy, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb302-9"><a href="visualising-spatial-data.html#cb302-9" tabindex="-1"></a><span class="fu">rp.spacetime</span>(location, Year, SO2<span class="sc">$</span>logSO2, <span class="at">col.palette =</span> <span class="fu">rev</span>(<span class="fu">heat.colors</span>(<span class="dv">12</span>)),</span>
<span id="cb302-10"><a href="visualising-spatial-data.html#cb302-10" tabindex="-1"></a>              <span class="at">background.plot =</span> back)</span></code></pre></div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="models-for-space.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="models-for-point-pattern-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["book.pdf", "book.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
