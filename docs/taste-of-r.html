<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.2 A taste of R | Statistical Modelling</title>
  <meta name="description" content="A conceptual, visual and practical introduction to statistical modelling" />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="2.2 A taste of R | Statistical Modelling" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A conceptual, visual and practical introduction to statistical modelling" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.2 A taste of R | Statistical Modelling" />
  
  <meta name="twitter:description" content="A conceptual, visual and practical introduction to statistical modelling" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="r-fuss.html"/>
<link rel="next" href="a-summary-of-key-concepts-in-r.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/rglWebGL-binding-1.3.17/rglWebGL.js"></script>
<link href="libs/rglwidgetClass-1.3.17/rgl.css" rel="stylesheet" />
<script src="libs/rglwidgetClass-1.3.17/rglClass.min.js"></script>
<script src="libs/CanvasMatrix4-1.3.17/CanvasMatrix.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A visual and conceptual introduction to statistical modelling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface: what’s the problem?</a></li>
<li class="chapter" data-level="" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html"><i class="fa fa-check"></i>Getting started with R</a></li>
<li class="part"><span><b>I Introduction</b></span></li>
<li class="chapter" data-level="1" data-path="where-data.html"><a href="where-data.html"><i class="fa fa-check"></i><b>1</b> Where do data come from?</a>
<ul>
<li class="chapter" data-level="1.1" data-path="examples-data.html"><a href="examples-data.html"><i class="fa fa-check"></i><b>1.1</b> Some examples of data</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="examples-data.html"><a href="examples-data.html#co2-and-global-warming"><i class="fa fa-check"></i><b>1.1.1</b> CO2 and global warming</a></li>
<li class="chapter" data-level="1.1.2" data-path="examples-data.html"><a href="examples-data.html#the-first-tuberculosis-trial"><i class="fa fa-check"></i><b>1.1.2</b> The first tuberculosis trial</a></li>
<li class="chapter" data-level="1.1.3" data-path="examples-data.html"><a href="examples-data.html#the-birds-and-the-bees-how-to-tell-the-sex-of-a-herring-gull"><i class="fa fa-check"></i><b>1.1.3</b> The birds and the bees: how to tell the sex of a herring gull</a></li>
<li class="chapter" data-level="1.1.4" data-path="examples-data.html"><a href="examples-data.html#tracking-the-covid-pandemic"><i class="fa fa-check"></i><b>1.1.4</b> Tracking the covid pandemic</a></li>
<li class="chapter" data-level="1.1.5" data-path="examples-data.html"><a href="examples-data.html#more-complex-data-objects"><i class="fa fa-check"></i><b>1.1.5</b> More complex data objects</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="some-broad-issues.html"><a href="some-broad-issues.html"><i class="fa fa-check"></i><b>1.2</b> Some broad issues</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="some-broad-issues.html"><a href="some-broad-issues.html#whats-the-problem"><i class="fa fa-check"></i><b>1.2.1</b> What’s the problem?</a></li>
<li class="chapter" data-level="1.2.2" data-path="some-broad-issues.html"><a href="some-broad-issues.html#whats-the-plan"><i class="fa fa-check"></i><b>1.2.2</b> What’s the plan?</a></li>
<li class="chapter" data-level="1.2.3" data-path="some-broad-issues.html"><a href="some-broad-issues.html#where-data-subsection"><i class="fa fa-check"></i><b>1.2.3</b> Where do the data come from?</a></li>
<li class="chapter" data-level="1.2.4" data-path="some-broad-issues.html"><a href="some-broad-issues.html#who-do-you-trust"><i class="fa fa-check"></i><b>1.2.4</b> Who do you trust?</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="what-could-possibly-go-wrong.html"><a href="what-could-possibly-go-wrong.html"><i class="fa fa-check"></i><b>1.3</b> What could possibly go wrong?</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="what-could-possibly-go-wrong.html"><a href="what-could-possibly-go-wrong.html#us-presidential-elections-1936-and-1948"><i class="fa fa-check"></i><b>1.3.1</b> US presidential elections, 1936 and 1948</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="further-reading.html"><a href="further-reading.html"><i class="fa fa-check"></i><b>1.4</b> Further reading</a></li>
<li class="chapter" data-level="1.5" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>1.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="exercises.html"><a href="exercises.html#an-investigation-of-short-term-memory"><i class="fa fa-check"></i><b>1.5.1</b> An investigation of short-term memory</a></li>
<li class="chapter" data-level="1.5.2" data-path="exercises.html"><a href="exercises.html#a-survey-of-dental-health"><i class="fa fa-check"></i><b>1.5.2</b> A survey of dental health</a></li>
<li class="chapter" data-level="1.5.3" data-path="exercises.html"><a href="exercises.html#hearings-aid-and-dementia"><i class="fa fa-check"></i><b>1.5.3</b> Hearings aid and dementia</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="R-introduction.html"><a href="R-introduction.html"><i class="fa fa-check"></i><b>2</b> A gentle introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="r-fuss.html"><a href="r-fuss.html"><i class="fa fa-check"></i><b>2.1</b> R: what’s all the fuss about?</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="r-fuss.html"><a href="r-fuss.html#history"><i class="fa fa-check"></i><b>2.1.1</b> History</a></li>
<li class="chapter" data-level="2.1.2" data-path="r-fuss.html"><a href="r-fuss.html#why-should-i-be-interested"><i class="fa fa-check"></i><b>2.1.2</b> Why should I be interested?</a></li>
<li class="chapter" data-level="2.1.3" data-path="r-fuss.html"><a href="r-fuss.html#whats-the-down-side"><i class="fa fa-check"></i><b>2.1.3</b> What’s the down side?</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="taste-of-r.html"><a href="taste-of-r.html"><i class="fa fa-check"></i><b>2.2</b> A taste of R</a></li>
<li class="chapter" data-level="2.3" data-path="a-summary-of-key-concepts-in-r.html"><a href="a-summary-of-key-concepts-in-r.html"><i class="fa fa-check"></i><b>2.3</b> A summary of key concepts in R</a></li>
<li class="chapter" data-level="2.4" data-path="reading-data.html"><a href="reading-data.html"><i class="fa fa-check"></i><b>2.4</b> Reading data into R</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="reading-data.html"><a href="reading-data.html#accessing-the-data-used-in-this-book"><i class="fa fa-check"></i><b>2.4.1</b> Accessing the data used in this book</a></li>
<li class="chapter" data-level="2.4.2" data-path="reading-data.html"><a href="reading-data.html#functions-for-reading-data"><i class="fa fa-check"></i><b>2.4.2</b> Functions for reading data</a></li>
<li class="chapter" data-level="2.4.3" data-path="reading-data.html"><a href="reading-data.html#reading-data-example"><i class="fa fa-check"></i><b>2.4.3</b> An example: reading an <em>Excel</em> spreadsheet</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="a-further-example-the-scottish-independence-referendum.html"><a href="a-further-example-the-scottish-independence-referendum.html"><i class="fa fa-check"></i><b>2.5</b> A further example: the Scottish independence referendum</a></li>
<li class="chapter" data-level="2.6" data-path="further-reading-1.html"><a href="further-reading-1.html"><i class="fa fa-check"></i><b>2.6</b> Further reading</a></li>
<li class="chapter" data-level="2.7" data-path="exercises-1.html"><a href="exercises-1.html"><i class="fa fa-check"></i><b>2.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="exercises-1.html"><a href="exercises-1.html#scottish-referendum-data"><i class="fa fa-check"></i><b>2.7.1</b> Scottish Referendum data</a></li>
<li class="chapter" data-level="2.7.2" data-path="exercises-1.html"><a href="exercises-1.html#aircraft-designs"><i class="fa fa-check"></i><b>2.7.2</b> Aircraft designs</a></li>
<li class="chapter" data-level="2.7.3" data-path="exercises-1.html"><a href="exercises-1.html#centenarians"><i class="fa fa-check"></i><b>2.7.3</b> Centenarians</a></li>
<li class="chapter" data-level="2.7.4" data-path="exercises-1.html"><a href="exercises-1.html#justification-of-the-log-transformation-for-the-rodent-data"><i class="fa fa-check"></i><b>2.7.4</b> Justification of the log transformation for the rodent data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Modelling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="taste-of-r" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> A taste of R<a href="taste-of-r.html#taste-of-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<hr />
<p><strong>Example: Mass and speed in quadrupedal rodents</strong><br />
In an investigation of the relationship between mass (kg) and speed (km/hr) in mammals, Garland (1983) collected information from published articles on these two variables for a large number of different species. These measurements were recorded for a variety of four-footed rodents. (The common names of the species are taken from Corbet &amp; Hill, 1986.) Notice that the measurements are not all recorded to the same level of accuracy since the results have been collated from the work of a number of different scientists.</p>
<p>Is it true that the bigger you are the faster you can run?</p>
<hr />
</blockquote>
<p>We will use this simple example to explore how R operates. This will include the idea of a <em>script</em> where ‘R’ instructions can be typed and, when required, copied into the <em>Console</em> window for ‘R’ to execute.</p>
<!-- Before we get going, we will set up access to some additional tools which will be useful. This is done through the instructions below. -->
<!-- ```{r rpanel_install, eval = FALSE} -->
<!-- install.packages("devtools") -->
<!-- library(devtools) -->
<!-- install_github("adrian-bowman/rpanel/rpanel") -->
<!-- ``` -->
<!-- The first instruction uses the *function* `install.packages`. It is helpful to think of R as a collection of functions. A function is something which accepts input of some kind and creates an output or action of some kind. The inputs are specified through the *arguments* of the function. Here the single argument is the name of the package we wish to install. When the instruction is executed, the console window should show information which monitors the progress of the installation of the package. On successful completion, the package should now be available to us in any future R session. The second instruction uses the `library` function with the argument `"devtools"`. This asks R to retrieve `the installed package`devtools` from the local library of installed packages. The final instruction uses the function `install_github` to install the `rpanel` package from the Github repository. This ensures that we are using the most up-to-date version. -->
<p>The majority of datasets in this book are read directly from external sources and Section <a href="reading-data.html#reading-data">2.4</a> below shows how this can be done conveniently. Some datasets, such as the rodent one described above, are not available externally and these are provided within the add-on package <code>rpanel</code>. If you haven’t yet installed this package, follow the instructions in the <em>Getting started with R</em> page which immediately precedes Chapter <a href="where-data.html#where-data">1</a>.</p>
<p>The first thing to do is to set up a new <em>script</em>. If you are using RStudio, this can be done from the menu: <em>File &gt; New file &gt; R Script</em>. (The detailed wording of the menu items may change with the particular computing system you are using.) Now type the following text into this script window.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="taste-of-r.html#cb3-1" tabindex="-1"></a><span class="fu">data</span>(rodent, <span class="at">package =</span> <span class="st">&#39;rpanel&#39;</span>)</span></code></pre></div>
<p>It is strongly recommended that all R instructions are placed in a script, to build up a record of your analysis which can be edited and re-executed as needed. As discussed in Section <a href="r-fuss.html#r-fuss">2.1</a>, this provides a very convenient and reproducible workflow. Instructions can easily be copied and pasted from the script window into the console window. (This can be done efficiently by placing the cursor on the line of interest, or highlighting a block of code, and then using a keystroke combination such as <em>Ctrl + Enter</em> or <em>command + Enter</em>, although this may depend on your particular computer system.) Copy and paste the <code>data</code> instruction now.</p>
<p>In R, <code>data</code> is a <em>function</em> designed to make a dataset available, in this case the <code>rodent</code> dataset from the <code>rpanel</code> package. It is helpful to think of R as a collection of functions. A function is something which accepts input of some kind and creates an output or action of some kind. The inputs are specified through the <em>arguments</em> of the function. Here the first argument is the name of the dataset. Functions often have many arguments. In this case, the second argument has been ‘named’ to identify that it refers to the ‘package’ argument, out of all the other arguments available. (If the <code>package</code> argument had been the second one in the definition of the function, we could have omitted naming it.)</p>
<p>There is no automatic response from R but the rodent dataset is now available in the <em>object</em> <code>rodent</code>. This has rows for each rodent and columns for each variable. It is referred to as a <em>dataframe</em>. We can see what is inside any object by typing its name in the console. (Alternatively, the object can be inspected by clicking on its name in the RStudio <em>Environment</em> window.)</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="taste-of-r.html#cb4-1" tabindex="-1"></a>rodent</span></code></pre></div>
<pre><code>##                                             Mass Speed
## North American Porcupine                   9.000   3.2
## Woodchuck                                  4.000  16.0
## Long-clawed ground squirrel                0.600  36.0
## Long-tailed souslik                        0.600  20.0
## Eastern grey squirrel                      0.550  27.0
## European souslik                           0.500  18.0
## European red squirrel and Persian squirrel 0.400  20.0
## Belding&#39;s ground squirrel                  0.300  13.0
## Rat                                        0.250   9.7
## American red squirrel                      0.220  15.0
## Golden hamster                             0.110   9.0
## Eastern American chipmunk                  0.100  17.0
## Chisel-toothed kangaroo rat                0.056  21.0
## Meadow vole                                0.050  11.0
## Least chipmunk                             0.045  16.0
## Merriman&#39;s kangaroo rat                    0.035  32.0
## Fawn hopping mouse                         0.035  14.0
## Pine mouse                                 0.030   6.8
## Deer mouse                                 0.030   9.1
## White footed mouse                         0.025  11.0
## Woodland jumping mouse                     0.025   8.6
## North American meadow jumping mouse        0.018   8.9
## House mouse                                0.016  13.0</code></pre>
<p>To explore the data, plots always provide a good starting point. The <code>plot</code> function is very powerful and adaptable. Here we give it two variables and a scatterplot is produced. Notice that we refer to variables inside the dataset by <code>&lt;dataframe name&gt;$&lt;variable name&gt;</code>. What does this plot tell us?</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="taste-of-r.html#cb6-1" tabindex="-1"></a><span class="fu">plot</span>(rodent<span class="sc">$</span>Mass, rodent<span class="sc">$</span>Speed)</span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-65-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p>A noticeable feature is that the data are ‘bunched up’ at one end and stretched out at the other, making any underlying pattern difficult to see. It would be worthwhile considering a change of scale by applying the log transformation to both axes. The log transformation is often effective in dealing with data which are <em>skewed</em> in this manner but there is also a more reasoned justification in this example. Mass is proportional to volume, which is the product of three dimensions - length, breadth and height (when adopting a rather drastic simplification of rodent shape!). On the other hand speed refers to the distance travelled in unit time and so it is one-dimensional. When the log transformation is applied to a product it creates quantities which add together on the log scale. With some further thought on the mathematical relationships involved, there is a strong aregument for the appropritaeness of the log transformation. (You are invited to consider this further in one of the Exercises at the end of the chapter.)</p>
<p>The plot below shows this to be very effective at putting the data onto scales where the variation is more consistent. Notice that we do not need to create new variables containing the log transformed data. We can simply apply the <code>log</code> function inside our instruction. Note that this refers to logarithm to the base <span class="math inline">\(e\)</span>, the mathematical constant with value 2.7182…, and not to the base 10 (for which the function is <code>log10</code>).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="taste-of-r.html#cb7-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(rodent<span class="sc">$</span>Mass), <span class="fu">log</span>(rodent<span class="sc">$</span>Speed))</span>
<span id="cb7-2"><a href="taste-of-r.html#cb7-2" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Speed) <span class="sc">~</span> <span class="fu">log</span>(Mass), <span class="at">data =</span> rodent)</span>
<span id="cb7-3"><a href="taste-of-r.html#cb7-3" tabindex="-1"></a><span class="fu">abline</span>(model1, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-66-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p>The instructions also fit a simple linear trend to the data. This is an example of a <em>linear model</em> which we will discuss in detail in Chapter <a href="#linear-models"><strong>??</strong></a>. The <code>lm</code> function accepts a formula of the form <code>&lt;response variable&gt; ~ &lt;explanatory variable&gt;</code>. We can also conveniently specify the dataframe we are working with in the <code>data</code> argument.</p>
<p>The syntax of this instruction also makes an <em>assignment</em> by placing the result of the <code>lm</code> function into a new object with a name of our own choosing. The backwards arrow <code>&lt;-</code> is how we make assignments in R. Objects can contain numbers, text, vectors of data, matrices, dataframes and many other things, some of them rather sophisticated. This is one of the more sophisticated cases as <code>model1</code> now contains a fitted linear model.</p>
<p>The fitted model has been passed to the <code>abline</code> which is designed to draw straight lines. What should it do? This illustrates that R is an <em>object-oriented</em> system. The <code>abline</code> function recognises that the object which has been passed to it is a linear model with a single ‘explanatory’ variable. There is a <em>method</em> for that kind of object which locates the slope and intercept of the fitted line and draws that on the plot, with the colour set by the <code>col</code> argument.</p>
<p>The red line shows the effect of fitting a simple linear model. This is almost entirely flat and so provides no evidence of any relationship between <code>Mass</code> and <code>Speed</code>.</p>
<p>Are you content that this model provides a good description of the data? Inspection of the plot raises concern about the observation in the lower right corner. This has the largest mass but the slowest speed. What is this rodent? It is the porcupine, whose spines provide an excellent defence mechanism as an alternative to running fast to escape a predator.</p>
<p>We should not throw away data because they appear to be inconvenient. However, where there is a good biological motivation, as here, we can investigate the effect of fitting models without particular observations. The <code>subset</code> argument of the <code>lm</code> function allows us to do that easily. The porcupine is the first observation in the dataframe and the minus sign indicates that it should omitted. The green line shows the effect of omitting the procupine and this does suggest an underlying relationship between mass and speed for the other rodents.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="taste-of-r.html#cb8-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(rodent<span class="sc">$</span>Mass), <span class="fu">log</span>(rodent<span class="sc">$</span>Speed))</span>
<span id="cb8-2"><a href="taste-of-r.html#cb8-2" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Speed) <span class="sc">~</span> <span class="fu">log</span>(Mass), <span class="at">data =</span> rodent, <span class="at">subset =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb8-3"><a href="taste-of-r.html#cb8-3" tabindex="-1"></a><span class="fu">abline</span>(model2, <span class="at">col =</span> <span class="st">&#39;green&#39;</span>)</span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-67-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p>This simple example has proceeded slowly to enable detailed comments on the syntax and construction of the R code. The sequence of steps we have taken also illustate that building a suitable model involves careful thought, critical inspection, and the use of our understanding of the context.</p>
<p>At this stage, we should save our script in a file. This defines our analysis. It allows us to reload the script when we need to revisit or refine the analysis. It is also easy to send the file to others to show precisely what we have done. This provides an excellent basis for <em>reproducible research</em>. It is worthwhile spending a few moments to add comments so that we can remind ourselves about the thought process we have gone through. Lines whose first non-space character is <code>#</code> will be ognored when the R code is executed.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="taste-of-r.html#cb9-1" tabindex="-1"></a><span class="co"># Make the rodent data available from the rpanel package</span></span>
<span id="cb9-2"><a href="taste-of-r.html#cb9-2" tabindex="-1"></a><span class="fu">data</span>(rodent, <span class="at">package =</span> <span class="st">&#39;rpanel&#39;</span>)</span>
<span id="cb9-3"><a href="taste-of-r.html#cb9-3" tabindex="-1"></a></span>
<span id="cb9-4"><a href="taste-of-r.html#cb9-4" tabindex="-1"></a><span class="co"># Plot Speed against Mass</span></span>
<span id="cb9-5"><a href="taste-of-r.html#cb9-5" tabindex="-1"></a><span class="fu">plot</span>(rodent<span class="sc">$</span>Mass, rodent<span class="sc">$</span>Speed)</span>
<span id="cb9-6"><a href="taste-of-r.html#cb9-6" tabindex="-1"></a></span>
<span id="cb9-7"><a href="taste-of-r.html#cb9-7" tabindex="-1"></a><span class="co"># Use the log transformation to provide more effective scales</span></span>
<span id="cb9-8"><a href="taste-of-r.html#cb9-8" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(rodent<span class="sc">$</span>Mass), <span class="fu">log</span>(rodent<span class="sc">$</span>Speed))</span>
<span id="cb9-9"><a href="taste-of-r.html#cb9-9" tabindex="-1"></a></span>
<span id="cb9-10"><a href="taste-of-r.html#cb9-10" tabindex="-1"></a><span class="co"># Fit a simple straight line model and display this on the plot.</span></span>
<span id="cb9-11"><a href="taste-of-r.html#cb9-11" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Speed) <span class="sc">~</span> <span class="fu">log</span>(Mass), <span class="at">data =</span> rodent)</span>
<span id="cb9-12"><a href="taste-of-r.html#cb9-12" tabindex="-1"></a><span class="fu">abline</span>(model1, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>)</span>
<span id="cb9-13"><a href="taste-of-r.html#cb9-13" tabindex="-1"></a></span>
<span id="cb9-14"><a href="taste-of-r.html#cb9-14" tabindex="-1"></a><span class="co"># Fit the model without the porcupine which is biologically different</span></span>
<span id="cb9-15"><a href="taste-of-r.html#cb9-15" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(rodent<span class="sc">$</span>Mass), <span class="fu">log</span>(rodent<span class="sc">$</span>Speed))</span>
<span id="cb9-16"><a href="taste-of-r.html#cb9-16" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Speed) <span class="sc">~</span> <span class="fu">log</span>(Mass), <span class="at">data =</span> rodent, <span class="at">subset =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb9-17"><a href="taste-of-r.html#cb9-17" tabindex="-1"></a><span class="fu">abline</span>(model2, <span class="at">col =</span> <span class="st">&#39;green&#39;</span>)</span></code></pre></div>
<p>This can be taken further with <em>R markdown</em> which is a very powerful system for combining text and R code in a single document. When this document is compiled the R code runs to perform the analysis and generate graphs and other forms of output.</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="r-fuss.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="a-summary-of-key-concepts-in-r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["book.pdf", "book.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
